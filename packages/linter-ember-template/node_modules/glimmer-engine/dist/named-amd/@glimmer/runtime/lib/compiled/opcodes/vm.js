enifed('@glimmer/runtime/lib/compiled/opcodes/vm', ['exports', '@glimmer/runtime/lib/opcodes', '@glimmer/reference', '@glimmer/util'], function (exports, _glimmerRuntimeLibOpcodes, _glimmerReference, _glimmerUtil) {
    'use strict';

    function _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }

    function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }

    function _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }

    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.PushChildScope, function (vm) {
        return vm.pushChildScope();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.PopScope, function (vm) {
        return vm.popScope();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.PushDynamicScope, function (vm) {
        return vm.pushDynamicScope();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.PopDynamicScope, function (vm) {
        return vm.popDynamicScope();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Put, function (vm, _ref) {
        var reference = _ref.op1;

        vm.frame.setOperand(vm.constants.getReference(reference));
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.EvaluatePut, function (vm, _ref2) {
        var expression = _ref2.op1;

        var expr = vm.constants.getExpression(expression);
        vm.evaluateOperand(expr);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.PutArgs, function (vm, _ref3) {
        var args = _ref3.op1;

        vm.evaluateArgs(vm.constants.getExpression(args));
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindPositionalArgs, function (vm, _ref4) {
        var _symbols = _ref4.op1;

        var symbols = vm.constants.getArray(_symbols);
        vm.bindPositionalArgs(symbols);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindNamedArgs, function (vm, _ref5) {
        var _names = _ref5.op1;
        var _symbols = _ref5.op2;

        var names = vm.constants.getArray(_names);
        var symbols = vm.constants.getArray(_symbols);
        vm.bindNamedArgs(names, symbols);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindBlocks, function (vm, _ref6) {
        var _names = _ref6.op1;
        var _symbols = _ref6.op2;

        var names = vm.constants.getArray(_names);
        var symbols = vm.constants.getArray(_symbols);
        vm.bindBlocks(names, symbols);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindPartialArgs, function (vm, _ref7) {
        var symbol = _ref7.op1;

        vm.bindPartialArgs(symbol);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindCallerScope, function (vm) {
        return vm.bindCallerScope();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.BindDynamicScope, function (vm, _ref8) {
        var _names = _ref8.op1;

        var names = vm.constants.getArray(_names);
        vm.bindDynamicScope(names);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Enter, function (vm, _ref9) {
        var slice = _ref9.op1;
        return vm.enter(slice);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Exit, function (vm) {
        return vm.exit();
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Evaluate, function (vm, _ref10) {
        var _block = _ref10.op1;

        var block = vm.constants.getBlock(_block);
        var args = vm.frame.getArgs();
        vm.invokeBlock(block, args);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Jump, function (vm, _ref11) {
        var target = _ref11.op1;
        return vm.goto(target);
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.JumpIf, function (vm, _ref12) {
        var target = _ref12.op1;

        var reference = vm.frame.getCondition();
        if (_glimmerReference.isConst(reference)) {
            if (reference.value()) {
                vm.goto(target);
            }
        } else {
            var cache = new _glimmerReference.ReferenceCache(reference);
            if (cache.peek()) {
                vm.goto(target);
            }
            vm.updateWith(new Assert(cache));
        }
    });
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.JumpUnless, function (vm, _ref13) {
        var target = _ref13.op1;

        var reference = vm.frame.getCondition();
        if (_glimmerReference.isConst(reference)) {
            if (!reference.value()) {
                vm.goto(target);
            }
        } else {
            var cache = new _glimmerReference.ReferenceCache(reference);
            if (!cache.peek()) {
                vm.goto(target);
            }
            vm.updateWith(new Assert(cache));
        }
    });
    var ConstTest = function (ref, _env) {
        return new _glimmerReference.ConstReference(!!ref.value());
    };
    exports.ConstTest = ConstTest;
    var SimpleTest = function (ref, _env) {
        return ref;
    };
    exports.SimpleTest = SimpleTest;
    var EnvironmentTest = function (ref, env) {
        return env.toConditionalReference(ref);
    };
    exports.EnvironmentTest = EnvironmentTest;
    _glimmerRuntimeLibOpcodes.APPEND_OPCODES.add(_glimmerRuntimeLibOpcodes.OpcodeName.Test, function (vm, _ref14) {
        var _func = _ref14.op1;

        var operand = vm.frame.getOperand();
        var func = vm.constants.getFunction(_func);
        vm.frame.setCondition(func(operand, vm.env));
    });

    var Assert = (function (_UpdatingOpcode) {
        _inherits(Assert, _UpdatingOpcode);

        function Assert(cache) {
            _classCallCheck(this, Assert);

            _UpdatingOpcode.call(this);
            this.type = "assert";
            this.tag = cache.tag;
            this.cache = cache;
        }

        Assert.prototype.evaluate = function evaluate(vm) {
            var cache = this.cache;

            if (_glimmerReference.isModified(cache.revalidate())) {
                vm.throw();
            }
        };

        Assert.prototype.toJSON = function toJSON() {
            var type = this.type;
            var _guid = this._guid;
            var cache = this.cache;

            var expected = undefined;
            try {
                expected = JSON.stringify(cache.peek());
            } catch (e) {
                expected = String(cache.peek());
            }
            return {
                guid: _guid,
                type: type,
                args: [],
                details: { expected: expected }
            };
        };

        return Assert;
    })(_glimmerRuntimeLibOpcodes.UpdatingOpcode);

    exports.Assert = Assert;

    var JumpIfNotModifiedOpcode = (function (_UpdatingOpcode2) {
        _inherits(JumpIfNotModifiedOpcode, _UpdatingOpcode2);

        function JumpIfNotModifiedOpcode(tag, target) {
            _classCallCheck(this, JumpIfNotModifiedOpcode);

            _UpdatingOpcode2.call(this);
            this.target = target;
            this.type = "jump-if-not-modified";
            this.tag = tag;
            this.lastRevision = tag.value();
        }

        JumpIfNotModifiedOpcode.prototype.evaluate = function evaluate(vm) {
            var tag = this.tag;
            var target = this.target;
            var lastRevision = this.lastRevision;

            if (!vm.alwaysRevalidate && tag.validate(lastRevision)) {
                vm.goto(target);
            }
        };

        JumpIfNotModifiedOpcode.prototype.didModify = function didModify() {
            this.lastRevision = this.tag.value();
        };

        JumpIfNotModifiedOpcode.prototype.toJSON = function toJSON() {
            return {
                guid: this._guid,
                type: this.type,
                args: [JSON.stringify(this.target.inspect())]
            };
        };

        return JumpIfNotModifiedOpcode;
    })(_glimmerRuntimeLibOpcodes.UpdatingOpcode);

    exports.JumpIfNotModifiedOpcode = JumpIfNotModifiedOpcode;

    var DidModifyOpcode = (function (_UpdatingOpcode3) {
        _inherits(DidModifyOpcode, _UpdatingOpcode3);

        function DidModifyOpcode(target) {
            _classCallCheck(this, DidModifyOpcode);

            _UpdatingOpcode3.call(this);
            this.target = target;
            this.type = "did-modify";
            this.tag = _glimmerReference.CONSTANT_TAG;
        }

        DidModifyOpcode.prototype.evaluate = function evaluate() {
            this.target.didModify();
        };

        return DidModifyOpcode;
    })(_glimmerRuntimeLibOpcodes.UpdatingOpcode);

    exports.DidModifyOpcode = DidModifyOpcode;

    var LabelOpcode = (function () {
        function LabelOpcode(label) {
            _classCallCheck(this, LabelOpcode);

            this.tag = _glimmerReference.CONSTANT_TAG;
            this.type = "label";
            this.label = null;
            this.prev = null;
            this.next = null;
            _glimmerUtil.initializeGuid(this);
            if (label) this.label = label;
        }

        LabelOpcode.prototype.evaluate = function evaluate() {};

        LabelOpcode.prototype.inspect = function inspect() {
            return this.label + ' [' + this._guid + ']';
        };

        LabelOpcode.prototype.toJSON = function toJSON() {
            return {
                guid: this._guid,
                type: this.type,
                args: [JSON.stringify(this.inspect())]
            };
        };

        return LabelOpcode;
    })();

    exports.LabelOpcode = LabelOpcode;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBnbGltbWVyL3J1bnRpbWUvbGliL2NvbXBpbGVkL29wY29kZXMvdm0udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBVUEsOEJBRlMsY0FBYyxDQUVSLEdBQUcsQ0FBQywwQkFGTSxVQUFVLENBRWIsY0FBYyxFQUFFLFVBQUEsRUFBRTtlQUFJLEVBQUUsQ0FBQyxjQUFjLEVBQUU7S0FBQSxDQUFDLENBQUM7QUFFakUsOEJBSlMsY0FBYyxDQUlSLEdBQUcsQ0FBQywwQkFKTSxVQUFVLENBSWIsUUFBUSxFQUFFLFVBQUEsRUFBRTtlQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUU7S0FBQSxDQUFDLENBQUM7QUFFckQsOEJBTlMsY0FBYyxDQU1SLEdBQUcsQ0FBQywwQkFOTSxVQUFVLENBTWIsZ0JBQWdCLEVBQUUsVUFBQSxFQUFFO2VBQUksRUFBRSxDQUFDLGdCQUFnQixFQUFFO0tBQUEsQ0FBQyxDQUFDO0FBRXJFLDhCQVJTLGNBQWMsQ0FRUixHQUFHLENBQUMsMEJBUk0sVUFBVSxDQVFiLGVBQWUsRUFBRSxVQUFBLEVBQUU7ZUFBSSxFQUFFLENBQUMsZUFBZSxFQUFFO0tBQUEsQ0FBQyxDQUFDO0FBRW5FLDhCQVZTLGNBQWMsQ0FVUixHQUFHLENBQUMsMEJBVk0sVUFBVSxDQVViLEdBQUcsRUFBRSxVQUFDLEVBQUUsRUFBRSxJQUFrQixFQUFBO1lBQVgsU0FBUyxHQUFoQixJQUFrQixDQUFoQixHQUFHOztBQUNuQyxVQUFFLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxFQUFFLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDO0tBQzNELENBQUMsQ0FBQztBQUVILDhCQWRTLGNBQWMsQ0FjUixHQUFHLENBQUMsMEJBZE0sVUFBVSxDQWNiLFdBQVcsRUFBRSxVQUFDLEVBQUUsRUFBRSxLQUFtQixFQUFBO1lBQVosVUFBVSxHQUFqQixLQUFtQixDQUFqQixHQUFHOztBQUMzQyxZQUFJLElBQUksR0FBRyxFQUFF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QUFNLENBQUMsU0FBUyxFQUFFLENBQUM7U0FDekI7O2VBVkcsZUFBdUI7aUNBdE1SLGNBQWM7Ozs7UUFtTjdCLFdBQUE7QUFTSixpQkFUSSxXQUFBLENBU1EsS0FBYSxFQUFBO2tDQVRyQixXQUFBOztBQUNHLGdCQUFBLENBQUEsR0FBRyxxQkE5TUgsWUFBWSxBQThNTSxDQUFDO0FBQ25CLGdCQUFBLENBQUEsSUFBSSxHQUFHLE9BQU8sQ0FBQztBQUNmLGdCQUFBLENBQUEsS0FBSyxHQUFtQixJQUFJLENBQUM7QUFHcEMsZ0JBQUEsQ0FBQSxJQUFJLEdBQVEsSUFBSSxDQUFDO0FBQ2pCLGdCQUFBLENBQUEsSUFBSSxHQUFRLElBQUksQ0FBQztBQUdmLHlCQXhOcUIsY0FBYyxDQXdOcEIsSUFBSSxDQUFDLENBQUM7QUFDckIsZ0JBQUksS0FBSyxFQUFFLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1NBQy9COztBQVpHLG1CQUFBLFdBY0osUUFBUSxHQUFBLG9CQUFBLEVBQUs7O0FBZFQsbUJBQUEsV0FnQkosT0FBTyxHQUFBLG1CQUFBO0FBQ0wsbUJBQVUsSUFBSSxDQUFDLEtBQUssVUFBSyxJQUFJLENBQUMsS0FBSyxPQUFJO1NBQ3hDOztBQWxCRyxtQkFBQSxXQW9CSixNQUFNLEdBQUEsa0JBQUE7QUFDSixtQkFBTztBQUNMLG9CQUFJLEVBQUUsSUFBSSxDQUFDLEtBQUs7QUFDaEIsb0JBQUksRUFBRSxJQUFJLENBQUMsSUFBSTtBQUNmLG9CQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsQ0FBQyxDQUFDO2FBQ3ZDLENBQUM7U0FDSDs7ZUExQkcsV0FBQSIsImZpbGUiOiJ2bS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9wY29kZUpTT04sIFVwZGF0aW5nT3Bjb2RlIH0gZnJvbSAnLi4vLi4vb3Bjb2Rlcyc7XG5pbXBvcnQgeyBDb21waWxlZEV4cHJlc3Npb24gfSBmcm9tICcuLi9leHByZXNzaW9ucyc7XG5pbXBvcnQgeyBDb21waWxlZEFyZ3MgfSBmcm9tICcuLi9leHByZXNzaW9ucy9hcmdzJztcbmltcG9ydCB7IFVwZGF0aW5nVk0gfSBmcm9tICcuLi8uLi92bSc7XG5pbXBvcnQgeyBSZWZlcmVuY2UsIENvbnN0UmVmZXJlbmNlIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCB7IE9wdGlvbiwgT3BhcXVlLCBpbml0aWFsaXplR3VpZCB9IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuaW1wb3J0IHsgQ09OU1RBTlRfVEFHLCBSZWZlcmVuY2VDYWNoZSwgUmV2aXNpb24sIFJldmlzaW9uVGFnLCBpc0NvbnN0LCBpc01vZGlmaWVkIH0gZnJvbSAnQGdsaW1tZXIvcmVmZXJlbmNlJztcbmltcG9ydCBFbnZpcm9ubWVudCBmcm9tICcuLi8uLi9lbnZpcm9ubWVudCc7XG5pbXBvcnQgeyBBUFBFTkRfT1BDT0RFUywgT3Bjb2RlTmFtZSBhcyBPcCB9IGZyb20gJy4uLy4uL29wY29kZXMnO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaENoaWxkU2NvcGUsIHZtID0+IHZtLnB1c2hDaGlsZFNjb3BlKCkpO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUG9wU2NvcGUsIHZtID0+IHZtLnBvcFNjb3BlKCkpO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHVzaER5bmFtaWNTY29wZSwgdm0gPT4gdm0ucHVzaER5bmFtaWNTY29wZSgpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLlBvcER5bmFtaWNTY29wZSwgdm0gPT4gdm0ucG9wRHluYW1pY1Njb3BlKCkpO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHV0LCAodm0sIHsgb3AxOiByZWZlcmVuY2UgfSkgPT4ge1xuICB2bS5mcmFtZS5zZXRPcGVyYW5kKHZtLmNvbnN0YW50cy5nZXRSZWZlcmVuY2UocmVmZXJlbmNlKSk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkV2YWx1YXRlUHV0LCAodm0sIHsgb3AxOiBleHByZXNzaW9uIH0pID0+IHtcbiAgbGV0IGV4cHIgPSB2bS5jb25zdGFudHMuZ2V0RXhwcmVzc2lvbjxDb21waWxlZEV4cHJlc3Npb248T3BhcXVlPj4oZXhwcmVzc2lvbik7XG4gIHZtLmV2YWx1YXRlT3BlcmFuZChleHByKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuUHV0QXJncywgKHZtLCB7IG9wMTogYXJncyB9KSA9PiB7XG4gIHZtLmV2YWx1YXRlQXJncyh2bS5jb25zdGFudHMuZ2V0RXhwcmVzc2lvbjxDb21waWxlZEFyZ3M+KGFyZ3MpKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmluZFBvc2l0aW9uYWxBcmdzLCAodm0sIHsgb3AxOiBfc3ltYm9scyB9KSA9PiB7XG4gIGxldCBzeW1ib2xzID0gdm0uY29uc3RhbnRzLmdldEFycmF5KF9zeW1ib2xzKTtcbiAgdm0uYmluZFBvc2l0aW9uYWxBcmdzKHN5bWJvbHMpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5CaW5kTmFtZWRBcmdzLCAodm0sIHsgb3AxOiBfbmFtZXMsIG9wMjogX3N5bWJvbHMgfSkgPT4ge1xuICBsZXQgbmFtZXMgPSB2bS5jb25zdGFudHMuZ2V0QXJyYXkoX25hbWVzKTtcbiAgbGV0IHN5bWJvbHMgPSB2bS5jb25zdGFudHMuZ2V0QXJyYXkoX3N5bWJvbHMpO1xuICB2bS5iaW5kTmFtZWRBcmdzKG5hbWVzLCBzeW1ib2xzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmluZEJsb2NrcywgKHZtLCB7IG9wMTogX25hbWVzLCBvcDI6IF9zeW1ib2xzIH0pID0+IHtcbiAgbGV0IG5hbWVzID0gdm0uY29uc3RhbnRzLmdldEFycmF5KF9uYW1lcyk7XG4gIGxldCBzeW1ib2xzID0gdm0uY29uc3RhbnRzLmdldEFycmF5KF9zeW1ib2xzKTtcbiAgdm0uYmluZEJsb2NrcyhuYW1lcywgc3ltYm9scyk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkJpbmRQYXJ0aWFsQXJncywgKHZtLCB7IG9wMTogc3ltYm9sIH0pID0+IHtcbiAgdm0uYmluZFBhcnRpYWxBcmdzKHN5bWJvbCk7XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkJpbmRDYWxsZXJTY29wZSwgdm0gPT4gdm0uYmluZENhbGxlclNjb3BlKCkpO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuQmluZER5bmFtaWNTY29wZSwgKHZtLCB7IG9wMTogX25hbWVzIH0pID0+IHtcbiAgbGV0IG5hbWVzID0gdm0uY29uc3RhbnRzLmdldEFycmF5KF9uYW1lcyk7XG4gIHZtLmJpbmREeW5hbWljU2NvcGUobmFtZXMpO1xufSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5FbnRlciwgKHZtLCB7IG9wMTogc2xpY2UgfSkgPT4gdm0uZW50ZXIoc2xpY2UpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkV4aXQsICh2bSkgPT4gdm0uZXhpdCgpKTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkV2YWx1YXRlLCAodm0sIHsgb3AxOiBfYmxvY2sgfSkgPT4ge1xuICBsZXQgYmxvY2sgPSB2bS5jb25zdGFudHMuZ2V0QmxvY2soX2Jsb2NrKTtcbiAgbGV0IGFyZ3MgPSB2bS5mcmFtZS5nZXRBcmdzKCk7XG4gIHZtLmludm9rZUJsb2NrKGJsb2NrLCBhcmdzKTtcbn0pO1xuXG5BUFBFTkRfT1BDT0RFUy5hZGQoT3AuSnVtcCwgKHZtLCB7IG9wMTogdGFyZ2V0IH0pID0+IHZtLmdvdG8odGFyZ2V0KSk7XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5KdW1wSWYsICh2bSwgeyBvcDE6IHRhcmdldCB9KSA9PiB7XG4gIGxldCByZWZlcmVuY2UgPSB2bS5mcmFtZS5nZXRDb25kaXRpb24oKTtcblxuICBpZiAoaXNDb25zdChyZWZlcmVuY2UpKSB7XG4gICAgaWYgKHJlZmVyZW5jZS52YWx1ZSgpKSB7XG4gICAgICB2bS5nb3RvKHRhcmdldCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGxldCBjYWNoZSA9IG5ldyBSZWZlcmVuY2VDYWNoZShyZWZlcmVuY2UpO1xuXG4gICAgaWYgKGNhY2hlLnBlZWsoKSkge1xuICAgICAgdm0uZ290byh0YXJnZXQpO1xuICAgIH1cblxuICAgIHZtLnVwZGF0ZVdpdGgobmV3IEFzc2VydChjYWNoZSkpO1xuICB9XG59KTtcblxuQVBQRU5EX09QQ09ERVMuYWRkKE9wLkp1bXBVbmxlc3MsICh2bSwgeyBvcDE6IHRhcmdldCB9KSA9PiB7XG4gIGxldCByZWZlcmVuY2UgPSB2bS5mcmFtZS5nZXRDb25kaXRpb24oKTtcblxuICBpZiAoaXNDb25zdChyZWZlcmVuY2UpKSB7XG4gICAgaWYgKCFyZWZlcmVuY2UudmFsdWUoKSkge1xuICAgICAgdm0uZ290byh0YXJnZXQpO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBsZXQgY2FjaGUgPSBuZXcgUmVmZXJlbmNlQ2FjaGUocmVmZXJlbmNlKTtcblxuICAgIGlmICghY2FjaGUucGVlaygpKSB7XG4gICAgICB2bS5nb3RvKHRhcmdldCk7XG4gICAgfVxuXG4gICAgdm0udXBkYXRlV2l0aChuZXcgQXNzZXJ0KGNhY2hlKSk7XG4gIH1cbn0pO1xuXG5leHBvcnQgdHlwZSBUZXN0RnVuY3Rpb24gPSAocmVmOiBSZWZlcmVuY2U8T3BhcXVlPiwgZW52OiBFbnZpcm9ubWVudCkgPT4gUmVmZXJlbmNlPGJvb2xlYW4+O1xuXG5leHBvcnQgY29uc3QgQ29uc3RUZXN0OiBUZXN0RnVuY3Rpb24gPSBmdW5jdGlvbihyZWY6IFJlZmVyZW5jZTxPcGFxdWU+LCBfZW52OiBFbnZpcm9ubWVudCk6IFJlZmVyZW5jZTxib29sZWFuPiB7XG4gIHJldHVybiBuZXcgQ29uc3RSZWZlcmVuY2UoISFyZWYudmFsdWUoKSk7XG59O1xuXG5leHBvcnQgY29uc3QgU2ltcGxlVGVzdDogVGVzdEZ1bmN0aW9uID0gZnVuY3Rpb24ocmVmOiBSZWZlcmVuY2U8T3BhcXVlPiwgX2VudjogRW52aXJvbm1lbnQpOiBSZWZlcmVuY2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gcmVmIGFzIFJlZmVyZW5jZTxib29sZWFuPjtcbn07XG5cbmV4cG9ydCBjb25zdCBFbnZpcm9ubWVudFRlc3Q6IFRlc3RGdW5jdGlvbiA9IGZ1bmN0aW9uKHJlZjogUmVmZXJlbmNlPE9wYXF1ZT4sIGVudjogRW52aXJvbm1lbnQpOiBSZWZlcmVuY2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gZW52LnRvQ29uZGl0aW9uYWxSZWZlcmVuY2UocmVmKTtcbn07XG5cbkFQUEVORF9PUENPREVTLmFkZChPcC5UZXN0LCAodm0sIHsgb3AxOiBfZnVuYyB9KSA9PiB7XG4gIGxldCBvcGVyYW5kID0gdm0uZnJhbWUuZ2V0T3BlcmFuZCgpO1xuICBsZXQgZnVuYyA9IHZtLmNvbnN0YW50cy5nZXRGdW5jdGlvbihfZnVuYyk7XG4gIHZtLmZyYW1lLnNldENvbmRpdGlvbihmdW5jKG9wZXJhbmQsIHZtLmVudikpO1xufSk7XG5cbmV4cG9ydCBjbGFzcyBBc3NlcnQgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gXCJhc3NlcnRcIjtcblxuICBwcml2YXRlIGNhY2hlOiBSZWZlcmVuY2VDYWNoZTxPcGFxdWU+O1xuXG4gIGNvbnN0cnVjdG9yKGNhY2hlOiBSZWZlcmVuY2VDYWNoZTxPcGFxdWU+KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnRhZyA9IGNhY2hlLnRhZztcbiAgICB0aGlzLmNhY2hlID0gY2FjaGU7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IGNhY2hlIH0gPSB0aGlzO1xuXG4gICAgaWYgKGlzTW9kaWZpZWQoY2FjaGUucmV2YWxpZGF0ZSgpKSkge1xuICAgICAgdm0udGhyb3coKTtcbiAgICB9XG4gIH1cblxuICB0b0pTT04oKTogT3Bjb2RlSlNPTiB7XG4gICAgbGV0IHsgdHlwZSwgX2d1aWQsIGNhY2hlIH0gPSB0aGlzO1xuXG4gICAgbGV0IGV4cGVjdGVkO1xuXG4gICAgdHJ5IHtcbiAgICAgIGV4cGVjdGVkID0gSlNPTi5zdHJpbmdpZnkoY2FjaGUucGVlaygpKTtcbiAgICB9IGNhdGNoKGUpIHtcbiAgICAgIGV4cGVjdGVkID0gU3RyaW5nKGNhY2hlLnBlZWsoKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIGd1aWQ6IF9ndWlkLFxuICAgICAgdHlwZSxcbiAgICAgIGFyZ3M6IFtdLFxuICAgICAgZGV0YWlsczogeyBleHBlY3RlZCB9XG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgSnVtcElmTm90TW9kaWZpZWRPcGNvZGUgZXh0ZW5kcyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0eXBlID0gXCJqdW1wLWlmLW5vdC1tb2RpZmllZFwiO1xuXG4gIHByaXZhdGUgbGFzdFJldmlzaW9uOiBSZXZpc2lvbjtcblxuICBjb25zdHJ1Y3Rvcih0YWc6IFJldmlzaW9uVGFnLCBwcml2YXRlIHRhcmdldDogTGFiZWxPcGNvZGUpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudGFnID0gdGFnO1xuICAgIHRoaXMubGFzdFJldmlzaW9uID0gdGFnLnZhbHVlKCk7XG4gIH1cblxuICBldmFsdWF0ZSh2bTogVXBkYXRpbmdWTSkge1xuICAgIGxldCB7IHRhZywgdGFyZ2V0LCBsYXN0UmV2aXNpb24gfSA9IHRoaXM7XG5cbiAgICBpZiAoIXZtLmFsd2F5c1JldmFsaWRhdGUgJiYgdGFnLnZhbGlkYXRlKGxhc3RSZXZpc2lvbikpIHtcbiAgICAgIHZtLmdvdG8odGFyZ2V0KTtcbiAgICB9XG4gIH1cblxuICBkaWRNb2RpZnkoKSB7XG4gICAgdGhpcy5sYXN0UmV2aXNpb24gPSB0aGlzLnRhZy52YWx1ZSgpO1xuICB9XG5cbiAgdG9KU09OKCk6IE9wY29kZUpTT04ge1xuICAgIHJldHVybiB7XG4gICAgICBndWlkOiB0aGlzLl9ndWlkLFxuICAgICAgdHlwZTogdGhpcy50eXBlLFxuICAgICAgYXJnczogW0pTT04uc3RyaW5naWZ5KHRoaXMudGFyZ2V0Lmluc3BlY3QoKSldXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgRGlkTW9kaWZ5T3Bjb2RlIGV4dGVuZHMgVXBkYXRpbmdPcGNvZGUge1xuICBwdWJsaWMgdHlwZSA9IFwiZGlkLW1vZGlmeVwiO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgdGFyZ2V0OiBKdW1wSWZOb3RNb2RpZmllZE9wY29kZSkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy50YWcgPSBDT05TVEFOVF9UQUc7XG4gIH1cblxuICBldmFsdWF0ZSgpIHtcbiAgICB0aGlzLnRhcmdldC5kaWRNb2RpZnkoKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTGFiZWxPcGNvZGUgaW1wbGVtZW50cyBVcGRhdGluZ09wY29kZSB7XG4gIHB1YmxpYyB0YWcgPSBDT05TVEFOVF9UQUc7XG4gIHB1YmxpYyB0eXBlID0gXCJsYWJlbFwiO1xuICBwdWJsaWMgbGFiZWw6IE9wdGlvbjxzdHJpbmc+ID0gbnVsbDtcbiAgcHVibGljIF9ndWlkOiBudW1iZXI7XG5cbiAgcHJldjogYW55ID0gbnVsbDtcbiAgbmV4dDogYW55ID0gbnVsbDtcblxuICBjb25zdHJ1Y3RvcihsYWJlbDogc3RyaW5nKSB7XG4gICAgaW5pdGlhbGl6ZUd1aWQodGhpcyk7XG4gICAgaWYgKGxhYmVsKSB0aGlzLmxhYmVsID0gbGFiZWw7XG4gIH1cblxuICBldmFsdWF0ZSgpIHt9XG5cbiAgaW5zcGVjdCgpOiBzdHJpbmcge1xuICAgIHJldHVybiBgJHt0aGlzLmxhYmVsfSBbJHt0aGlzLl9ndWlkfV1gO1xuICB9XG5cbiAgdG9KU09OKCk6IE9wY29kZUpTT04ge1xuICAgIHJldHVybiB7XG4gICAgICBndWlkOiB0aGlzLl9ndWlkLFxuICAgICAgdHlwZTogdGhpcy50eXBlLFxuICAgICAgYXJnczogW0pTT04uc3RyaW5naWZ5KHRoaXMuaW5zcGVjdCgpKV1cbiAgICB9O1xuICB9XG59XG4iXX0=