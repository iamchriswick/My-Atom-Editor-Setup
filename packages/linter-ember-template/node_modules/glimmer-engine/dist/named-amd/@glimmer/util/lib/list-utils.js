enifed("@glimmer/util/lib/list-utils", ["exports"], function (exports) {
    "use strict";

    function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

    var ListNode = function ListNode(value) {
        _classCallCheck(this, ListNode);

        this.next = null;
        this.prev = null;
        this.value = value;
    };

    exports.ListNode = ListNode;

    var LinkedList = (function () {
        function LinkedList() {
            _classCallCheck(this, LinkedList);

            this.clear();
        }

        LinkedList.fromSlice = function fromSlice(slice) {
            var list = new LinkedList();
            slice.forEachNode(function (n) {
                return list.append(n.clone());
            });
            return list;
        };

        LinkedList.prototype.head = function head() {
            return this._head;
        };

        LinkedList.prototype.tail = function tail() {
            return this._tail;
        };

        LinkedList.prototype.clear = function clear() {
            this._head = this._tail = null;
        };

        LinkedList.prototype.isEmpty = function isEmpty() {
            return this._head === null;
        };

        LinkedList.prototype.toArray = function toArray() {
            var out = [];
            this.forEachNode(function (n) {
                return out.push(n);
            });
            return out;
        };

        LinkedList.prototype.splice = function splice(start, end, reference) {
            var before = undefined;
            if (reference === null) {
                before = this._tail;
                this._tail = end;
            } else {
                before = reference.prev;
                end.next = reference;
                reference.prev = end;
            }
            if (before) {
                before.next = start;
                start.prev = before;
            }
        };

        LinkedList.prototype.nextNode = function nextNode(node) {
            return node.next;
        };

        LinkedList.prototype.prevNode = function prevNode(node) {
            return node.prev;
        };

        LinkedList.prototype.forEachNode = function forEachNode(callback) {
            var node = this._head;
            while (node !== null) {
                callback(node);
                node = node.next;
            }
        };

        LinkedList.prototype.contains = function contains(needle) {
            var node = this._head;
            while (node !== null) {
                if (node === needle) return true;
                node = node.next;
            }
            return false;
        };

        LinkedList.prototype.insertBefore = function insertBefore(node) {
            var reference = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];

            if (reference === null) return this.append(node);
            if (reference.prev) reference.prev.next = node;else this._head = node;
            node.prev = reference.prev;
            node.next = reference;
            reference.prev = node;
            return node;
        };

        LinkedList.prototype.append = function append(node) {
            var tail = this._tail;
            if (tail) {
                tail.next = node;
                node.prev = tail;
                node.next = null;
            } else {
                this._head = node;
            }
            return this._tail = node;
        };

        LinkedList.prototype.pop = function pop() {
            if (this._tail) return this.remove(this._tail);
            return null;
        };

        LinkedList.prototype.prepend = function prepend(node) {
            if (this._head) return this.insertBefore(node, this._head);
            return this._head = this._tail = node;
        };

        LinkedList.prototype.remove = function remove(node) {
            if (node.prev) node.prev.next = node.next;else this._head = node.next;
            if (node.next) node.next.prev = node.prev;else this._tail = node.prev;
            return node;
        };

        return LinkedList;
    })();

    exports.LinkedList = LinkedList;

    var ListSlice = (function () {
        function ListSlice(head, tail) {
            _classCallCheck(this, ListSlice);

            this._head = head;
            this._tail = tail;
        }

        ListSlice.toList = function toList(slice) {
            var list = new LinkedList();
            slice.forEachNode(function (n) {
                return list.append(n.clone());
            });
            return list;
        };

        ListSlice.prototype.forEachNode = function forEachNode(callback) {
            var node = this._head;
            while (node !== null) {
                callback(node);
                node = this.nextNode(node);
            }
        };

        ListSlice.prototype.contains = function contains(needle) {
            var node = this._head;
            while (node !== null) {
                if (node === needle) return true;
                node = node.next;
            }
            return false;
        };

        ListSlice.prototype.head = function head() {
            return this._head;
        };

        ListSlice.prototype.tail = function tail() {
            return this._tail;
        };

        ListSlice.prototype.toArray = function toArray() {
            var out = [];
            this.forEachNode(function (n) {
                return out.push(n);
            });
            return out;
        };

        ListSlice.prototype.nextNode = function nextNode(node) {
            if (node === this._tail) return null;
            return node.next;
        };

        ListSlice.prototype.prevNode = function prevNode(node) {
            if (node === this._head) return null;
            return node.prev;
        };

        ListSlice.prototype.isEmpty = function isEmpty() {
            return false;
        };

        return ListSlice;
    })();

    exports.ListSlice = ListSlice;
    var EMPTY_SLICE = new ListSlice(null, null);
    exports.EMPTY_SLICE = EMPTY_SLICE;
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkBnbGltbWVyL3V0aWwvbGliL2xpc3QtdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7UUFXTSxRQUFBLEdBS0osU0FMSSxRQUFBLENBS1EsS0FBUSxFQUFBOzhCQUxoQixRQUFBOztBQUNHLFlBQUEsQ0FBQSxJQUFJLEdBQXdCLElBQUksQ0FBQztBQUNqQyxZQUFBLENBQUEsSUFBSSxHQUF3QixJQUFJLENBQUM7QUFJdEMsWUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7S0FDcEI7Ozs7UUFPRyxVQUFBO0FBVUosaUJBVkksVUFBQSxHQVVKO2tDQVZJLFVBQUE7O0FBV0YsZ0JBQUksQ0FBQyxLQUFLLEVBQUUsQ0FBQztTQUNkOztBQVpHLGtCQUFBLENBQ0csU0FBUyxHQUFBLG1CQUE4QixLQUFlLEVBQUE7QUFDM0QsZ0JBQUksSUFBSSxHQUFHLElBQUksVUFBVSxFQUFLLENBQUM7QUFDL0IsaUJBQUssQ0FBQyxXQUFXLENBQUMsVUFBQSxDQUFDO3VCQUFJLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLEtBQUssRUFBRSxDQUFDO2FBQUEsQ0FBQyxDQUFDO0FBQy9DLG1CQUFPLElBQUksQ0FBQztTQUNiOztBQUxHLGtCQUFBLFdBY0osSUFBSSxHQUFBLGdCQUFBO0FBQ0YsbUJBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNuQjs7QUFoQkcsa0JBQUEsV0FrQkosSUFBSSxHQUFBLGdCQUFBO0FBQ0YsbUJBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNuQjs7QUFwQkcsa0JBQUEsV0FzQkosS0FBSyxHQUFBLGlCQUFBO0FBQ0gsZ0JBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUM7U0FDaEM7O0FBeEJHLGtCQUFBLFdBMEJKLE9BQU8sR0FBQSxtQkFBQTtBQUNMLG1CQUFPLElBQUksQ0FBQyxLQUFLLEtBQUssSUFBSSxDQUFDO1NBQzVCOztBQTVCRyxrQkFBQSxXQThCSixPQUFPLEdBQUEsbUJBQUE7QUFDTCxnQkFBSSxHQUFHLEdBQVEsRUFBRSxDQUFDO0FBQ2xCLGdCQUFJLENBQUMsV0FBVyxDQUFDLFVBQUEsQ0FBQzt1QkFBSSxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQzthQUFBLENBQUMsQ0FBQztBQUNuQyxtQkFBTyxHQUFHLENBQUM7U0FDWjs7QUFsQ0csa0JBQUEsV0FvQ0osTUFBTSxHQUFBLGdCQUFDLEtBQVEsRUFBRSxHQUFNLEVBQUUsU0FBWSxFQUFBO0FBQ25DLGdCQUFJLE1BQWlCLFlBQUEsQ0FBQztBQUV0QixnQkFBSSxTQUFTLEtBQUssSUFBSSxFQUFFO0FBQ3RCLHNCQUFNLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztBQUNwQixvQkFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUM7YUFDbEIsTUFBTTtBQUNMLHNCQUFNLEdBQU0sU0FBUyxDQUFDLElBQUksQ0FBQztBQUMzQixtQkFBRyxDQUFDLElBQUksR0FBRyxTQUFTLENBQUM7QUFDckIseUJBQVMsQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDO2FBQ3RCO0FBRUQsZ0JBQUksTUFBTSxFQUFFO0FBQ1Ysc0JBQU0sQ0FBQyxJQUFJLEdBQUcsS0FBSyxDQUFDO0FBQ3BCLHFCQUFLLENBQUMsSUFBSSxHQUFHLE1BQU0sQ0FBQzthQUNyQjtTQUNGOztBQXBERyxrQkFBQSxXQXNESixRQUFRLEdBQUEsa0JBQUMsSUFBTyxFQUFBO0FBQ2QsbUJBQWMsSUFBSSxDQUFDLElBQUksQ0FBQztTQUN6Qjs7QUF4REcsa0JBQUEsV0EwREosUUFBUSxHQUFBLGtCQUFDLElBQU8sRUFBQTtBQUNkLG1CQUFjLElBQUksQ0FBQyxJQUFJLENBQUM7U0FDekI7O0FBNURHLGtCQUFBLFdBOERKLFdBQVcsR0FBQSxxQkFBQyxRQUEyQixFQUFBO0FBQ3JDLGdCQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBRXRCLG1CQUFPLElBQUksS0FBSyxJQUFJLEVBQUU7QUFDcEIsd0JBQVEsQ0FBUSxJQUFJLENBQUMsQ0FBQztBQUN0QixvQkFBSSxHQUFVLElBQUksQ0FBQyxJQUFJLENBQUM7YUFDekI7U0FDRjs7QUFyRUcsa0JBQUEsV0F1RUosUUFBUSxHQUFBLGtCQUFDLE1BQVMsRUFBQTtBQUNoQixnQkFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztBQUV0QixtQkFBTyxJQUFJLEtBQUssSUFBSSxFQUFFO0FBQ3BCLG9CQUFJLElBQUksS0FBSyxNQUFNLEVBQUUsT0FBTyxJQUFJLENBQUM7QUFDakMsb0JBQUksR0FBVSxJQUFJLENBQUMsSUFBSSxDQUFDO2FBQ3pCO0FBRUQsbUJBQU8sS0FBSyxDQUFDO1NBQ2Q7O0FBaEZHLGtCQUFBLFdBa0ZKLFlBQVksR0FBQSxzQkFBQyxJQUFPLEVBQTZCO2dCQUEzQixTQUFBLHlEQUF1QixJQUFJOztBQUMvQyxnQkFBSSxTQUFTLEtBQUssSUFBSSxFQUFFLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUVqRCxnQkFBSSxTQUFTLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxLQUMxQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztBQUV2QixnQkFBSSxDQUFDLElBQUksR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDO0FBQzNCLGdCQUFJLENBQUMsSUFBSSxHQUFHLFNBQVMsQ0FBQztBQUN0QixxQkFBUyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFFdEIsbUJBQU8sSUFBSSxDQUFDO1NBQ2I7O0FBN0ZHLGtCQUFBLFdBK0ZKLE1BQU0sR0FBQSxnQkFBQyxJQUFPLEVBQUE7QUFDWixnQkFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztBQUV0QixnQkFBSSxJQUFJLEVBQUU7QUFDUixvQkFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUM7QUFDakIsb0JBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0FBQ2pCLG9CQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQzthQUNsQixNQUFNO0FBQ0wsb0JBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO2FBQ25CO0FBRUQsbUJBQVEsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLENBQUU7U0FDNUI7O0FBM0dHLGtCQUFBLFdBNkdKLEdBQUcsR0FBQSxlQUFBO0FBQ0QsZ0JBQUksSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQy9DLG1CQUFPLElBQUksQ0FBQztTQUNiOztBQWhIRyxrQkFBQSxXQWtISixPQUFPLEdBQUEsaUJBQUMsSUFBTyxFQUFBO0FBQ2IsZ0JBQUksSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztBQUMzRCxtQkFBUSxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFFO1NBQ3pDOztBQXJIRyxrQkFBQSxXQXVISixNQUFNLEdBQUEsZ0JBQUMsSUFBTyxFQUFBO0FBQ1osZ0JBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQ3JDLElBQUksQ0FBQyxLQUFLLEdBQVUsSUFBSSxDQUFDLElBQUksQ0FBQztBQUVuQyxnQkFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsS0FDckMsSUFBSSxDQUFDLEtBQUssR0FBVSxJQUFJLENBQUMsSUFBSSxDQUFDO0FBRW5DLG1CQUFPLElBQUksQ0FBQztTQUNiOztlQS9IRyxVQUFBOzs7OztRQWlKQSxTQUFBO0FBVUosaUJBVkksU0FBQSxDQVVRLElBQWUsRUFBRSxJQUFlLEVBQUE7a0NBVnhDLFNBQUE7O0FBV0YsZ0JBQUksQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0FBQ2xCLGdCQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztTQUNuQjs7QUFiRyxpQkFBQSxDQUNHLE1BQU0sR0FBQSxnQkFBOEIsS0FBZSxFQUFBO0FBQ3hELGdCQUFJLElBQUksR0FBRyxJQUFJLFVBQVUsRUFBSyxDQUFDO0FBQy9CLGlCQUFLLENBQUMsV0FBVyxDQUFDLFVBQUEsQ0FBQzt1QkFBSSxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxLQUFLLEVBQUUsQ0FBQzthQUFBLENBQUMsQ0FBQztBQUMvQyxtQkFBTyxJQUFJLENBQUM7U0FDYjs7QUFMRyxpQkFBQSxXQWVKLFdBQVcsR0FBQSxxQkFBQyxRQUEyQixFQUFBO0FBQ3JDLGdCQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBRXRCLG1CQUFPLElBQUksS0FBSyxJQUFJLEVBQUU7QUFDcEIsd0JBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUNmLG9CQUFJLEdBQUcsSUFBSSxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQzthQUM1QjtTQUNGOztBQXRCRyxpQkFBQSxXQXdCSixRQUFRLEdBQUEsa0JBQUMsTUFBUyxFQUFBO0FBQ2hCLGdCQUFJLElBQUksR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO0FBRXRCLG1CQUFPLElBQUksS0FBSyxJQUFJLEVBQUU7QUFDcEIsb0JBQUksSUFBSSxLQUFLLE1BQU0sRUFBRSxPQUFPLElBQUksQ0FBQztBQUNqQyxvQkFBSSxHQUFVLElBQUksQ0FBQyxJQUFJLENBQUM7YUFDekI7QUFFRCxtQkFBTyxLQUFLLENBQUM7U0FDZDs7QUFqQ0csaUJBQUEsV0FtQ0osSUFBSSxHQUFBLGdCQUFBO0FBQ0YsbUJBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNuQjs7QUFyQ0csaUJBQUEsV0F1Q0osSUFBSSxHQUFBLGdCQUFBO0FBQ0YsbUJBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQztTQUNuQjs7QUF6Q0csaUJBQUEsV0EyQ0osT0FBTyxHQUFBLG1CQUFBO0FBQ0wsZ0JBQUksR0FBRyxHQUFRLEVBQUUsQ0FBQztBQUNsQixnQkFBSSxDQUFDLFdBQVcsQ0FBQyxVQUFBLENBQUM7dUJBQUksR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7YUFBQSxDQUFDLENBQUM7QUFDbkMsbUJBQU8sR0FBRyxDQUFDO1NBQ1o7O0FBL0NHLGlCQUFBLFdBaURKLFFBQVEsR0FBQSxrQkFBQyxJQUFPLEVBQUE7QUFDZCxnQkFBSSxJQUFJLEtBQUssSUFBSSxDQUFDLEtBQUssRUFBRSxPQUFPLElBQUksQ0FBQztBQUNyQyxtQkFBTyxJQUFJLENBQUMsSUFBUyxDQUFDO1NBQ3ZCOztBQXBERyxpQkFBQSxXQXNESixRQUFRLEdBQUEsa0JBQUMsSUFBTyxFQUFBO0FBQ2QsZ0JBQUksSUFBSSxLQUFLLElBQUksQ0FBQyxLQUFLLEVBQUUsT0FBTyxJQUFJLENBQUM7QUFDckMsbUJBQU8sSUFBSSxDQUFDLElBQVMsQ0FBQztTQUN2Qjs7QUF6REcsaUJBQUEsV0EyREosT0FBTyxHQUFBLG1CQUFBO0FBQ0wsbUJBQU8sS0FBSyxDQUFDO1NBQ2Q7O2VBN0RHLFNBQUE7Ozs7QUFnRUMsUUFBTSxXQUFXLEdBQUcsSUFBSSxTQUFTLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDIiwiZmlsZSI6Imxpc3QtdXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBPcHRpb24gfSBmcm9tICcuL3BsYXRmb3JtLXV0aWxzJztcblxuZXhwb3J0IGludGVyZmFjZSBEZXN0cm95YWJsZSB7XG4gIGRlc3Ryb3koKTogdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMaW5rZWRMaXN0Tm9kZSB7XG4gIG5leHQ6IE9wdGlvbjxMaW5rZWRMaXN0Tm9kZT47XG4gIHByZXY6IE9wdGlvbjxMaW5rZWRMaXN0Tm9kZT47XG59XG5cbmV4cG9ydCBjbGFzcyBMaXN0Tm9kZTxUPiBpbXBsZW1lbnRzIExpbmtlZExpc3ROb2RlIHtcbiAgcHVibGljIG5leHQ6IE9wdGlvbjxMaXN0Tm9kZTxUPj4gPSBudWxsO1xuICBwdWJsaWMgcHJldjogT3B0aW9uPExpc3ROb2RlPFQ+PiA9IG51bGw7XG4gIHB1YmxpYyB2YWx1ZTogVDtcblxuICBjb25zdHJ1Y3Rvcih2YWx1ZTogVCkge1xuICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgfVxufVxuXG4vLyB3ZSBhcmUgdW5hYmxlIHRvIGV4cHJlc3MgdGhlIGNvbnN0cmFpbnQgdGhhdCBUJ3MgLnByZXYgYW5kIC5uZXh0IGFyZVxuLy8gdGhlbXNlbHZlcyBULiBIb3dldmVyLCBpdCB3aWxsIGFsd2F5cyBiZSB0cnVlLCBzbyB0cnVzdCB1cy5cbnR5cGUgdHJ1c3QgPSBhbnk7XG5cbmV4cG9ydCBjbGFzcyBMaW5rZWRMaXN0PFQgZXh0ZW5kcyBMaW5rZWRMaXN0Tm9kZT4gaW1wbGVtZW50cyBTbGljZTxUPiB7XG4gIHN0YXRpYyBmcm9tU2xpY2U8VSBleHRlbmRzIENsb25lYWJsZUxpc3ROb2RlPihzbGljZTogU2xpY2U8VT4pOiBMaW5rZWRMaXN0PFU+IHtcbiAgICBsZXQgbGlzdCA9IG5ldyBMaW5rZWRMaXN0PFU+KCk7XG4gICAgc2xpY2UuZm9yRWFjaE5vZGUobiA9PiBsaXN0LmFwcGVuZChuLmNsb25lKCkpKTtcbiAgICByZXR1cm4gbGlzdDtcbiAgfVxuXG4gIHByaXZhdGUgX2hlYWQ6IE9wdGlvbjxUPjtcbiAgcHJpdmF0ZSBfdGFpbDogT3B0aW9uPFQ+O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY2xlYXIoKTtcbiAgfVxuXG4gIGhlYWQoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5faGVhZDtcbiAgfVxuXG4gIHRhaWwoKTogT3B0aW9uPFQ+IHtcbiAgICByZXR1cm4gdGhpcy5fdGFpbDtcbiAgfVxuXG4gIGNsZWFyKCkge1xuICAgIHRoaXMuX2hlYWQgPSB0aGlzLl90YWlsID0gbnVsbDtcbiAgfVxuXG4gIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX2hlYWQgPT09IG51bGw7XG4gIH1cblxuICB0b0FycmF5KCk6IFRbXSB7XG4gICAgbGV0IG91dDogVFtdID0gW107XG4gICAgdGhpcy5mb3JFYWNoTm9kZShuID0+IG91dC5wdXNoKG4pKTtcbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgc3BsaWNlKHN0YXJ0OiBULCBlbmQ6IFQsIHJlZmVyZW5jZTogVCkge1xuICAgIGxldCBiZWZvcmU6IE9wdGlvbjxUPjtcblxuICAgIGlmIChyZWZlcmVuY2UgPT09IG51bGwpIHtcbiAgICAgIGJlZm9yZSA9IHRoaXMuX3RhaWw7XG4gICAgICB0aGlzLl90YWlsID0gZW5kO1xuICAgIH0gZWxzZSB7XG4gICAgICBiZWZvcmUgPSA8VD5yZWZlcmVuY2UucHJldjtcbiAgICAgIGVuZC5uZXh0ID0gcmVmZXJlbmNlO1xuICAgICAgcmVmZXJlbmNlLnByZXYgPSBlbmQ7XG4gICAgfVxuXG4gICAgaWYgKGJlZm9yZSkge1xuICAgICAgYmVmb3JlLm5leHQgPSBzdGFydDtcbiAgICAgIHN0YXJ0LnByZXYgPSBiZWZvcmU7XG4gICAgfVxuICB9XG5cbiAgbmV4dE5vZGUobm9kZTogVCk6IFQge1xuICAgIHJldHVybiA8dHJ1c3Q+bm9kZS5uZXh0O1xuICB9XG5cbiAgcHJldk5vZGUobm9kZTogVCk6IFQge1xuICAgIHJldHVybiA8dHJ1c3Q+bm9kZS5wcmV2O1xuICB9XG5cbiAgZm9yRWFjaE5vZGUoY2FsbGJhY2s6IChub2RlOiBUKSA9PiB2b2lkKSB7XG4gICAgbGV0IG5vZGUgPSB0aGlzLl9oZWFkO1xuXG4gICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgIGNhbGxiYWNrKDx0cnVzdD5ub2RlKTtcbiAgICAgIG5vZGUgPSA8dHJ1c3Q+bm9kZS5uZXh0O1xuICAgIH1cbiAgfVxuXG4gIGNvbnRhaW5zKG5lZWRsZTogVCk6IGJvb2xlYW4ge1xuICAgIGxldCBub2RlID0gdGhpcy5faGVhZDtcblxuICAgIHdoaWxlIChub2RlICE9PSBudWxsKSB7XG4gICAgICBpZiAobm9kZSA9PT0gbmVlZGxlKSByZXR1cm4gdHJ1ZTtcbiAgICAgIG5vZGUgPSA8dHJ1c3Q+bm9kZS5uZXh0O1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGluc2VydEJlZm9yZShub2RlOiBULCByZWZlcmVuY2U6IE9wdGlvbjxUPiA9IG51bGwpOiBUIHtcbiAgICBpZiAocmVmZXJlbmNlID09PSBudWxsKSByZXR1cm4gdGhpcy5hcHBlbmQobm9kZSk7XG5cbiAgICBpZiAocmVmZXJlbmNlLnByZXYpIHJlZmVyZW5jZS5wcmV2Lm5leHQgPSBub2RlO1xuICAgIGVsc2UgdGhpcy5faGVhZCA9IG5vZGU7XG5cbiAgICBub2RlLnByZXYgPSByZWZlcmVuY2UucHJldjtcbiAgICBub2RlLm5leHQgPSByZWZlcmVuY2U7XG4gICAgcmVmZXJlbmNlLnByZXYgPSBub2RlO1xuXG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICBhcHBlbmQobm9kZTogVCk6IFQge1xuICAgIGxldCB0YWlsID0gdGhpcy5fdGFpbDtcblxuICAgIGlmICh0YWlsKSB7XG4gICAgICB0YWlsLm5leHQgPSBub2RlO1xuICAgICAgbm9kZS5wcmV2ID0gdGFpbDtcbiAgICAgIG5vZGUubmV4dCA9IG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hlYWQgPSBub2RlO1xuICAgIH1cblxuICAgIHJldHVybiAodGhpcy5fdGFpbCA9IG5vZGUpO1xuICB9XG5cbiAgcG9wKCk6IE9wdGlvbjxUPiB7XG4gICAgaWYgKHRoaXMuX3RhaWwpIHJldHVybiB0aGlzLnJlbW92ZSh0aGlzLl90YWlsKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHByZXBlbmQobm9kZTogVCk6IFQge1xuICAgIGlmICh0aGlzLl9oZWFkKSByZXR1cm4gdGhpcy5pbnNlcnRCZWZvcmUobm9kZSwgdGhpcy5faGVhZCk7XG4gICAgcmV0dXJuICh0aGlzLl9oZWFkID0gdGhpcy5fdGFpbCA9IG5vZGUpO1xuICB9XG5cbiAgcmVtb3ZlKG5vZGU6IFQpOiBUIHtcbiAgICBpZiAobm9kZS5wcmV2KSBub2RlLnByZXYubmV4dCA9IG5vZGUubmV4dDtcbiAgICBlbHNlIHRoaXMuX2hlYWQgPSA8dHJ1c3Q+bm9kZS5uZXh0O1xuXG4gICAgaWYgKG5vZGUubmV4dCkgbm9kZS5uZXh0LnByZXYgPSBub2RlLnByZXY7XG4gICAgZWxzZSB0aGlzLl90YWlsID0gPHRydXN0Pm5vZGUucHJldjtcblxuICAgIHJldHVybiBub2RlO1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgU2xpY2U8VCBleHRlbmRzIExpbmtlZExpc3ROb2RlPiB7XG4gIGhlYWQoKTogT3B0aW9uPFQ+O1xuICB0YWlsKCk6IE9wdGlvbjxUPjtcbiAgbmV4dE5vZGUobm9kZTogVCk6IE9wdGlvbjxUPjtcbiAgcHJldk5vZGUobm9kZTogVCk6IE9wdGlvbjxUPjtcbiAgZm9yRWFjaE5vZGUoY2FsbGJhY2s6IChub2RlOiBUKSA9PiB2b2lkKTogdm9pZDtcbiAgdG9BcnJheSgpOiBUW107XG4gIGlzRW1wdHkoKTogYm9vbGVhbjtcbiAgY29udGFpbnMobmVlZGxlOiBUKTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDbG9uZWFibGVMaXN0Tm9kZSBleHRlbmRzIExpbmtlZExpc3ROb2RlIHtcbiAgY2xvbmUoKTogdGhpcztcbn1cblxuZXhwb3J0IGNsYXNzIExpc3RTbGljZTxUIGV4dGVuZHMgTGlua2VkTGlzdE5vZGU+IGltcGxlbWVudHMgU2xpY2U8VD4ge1xuICBzdGF0aWMgdG9MaXN0PFUgZXh0ZW5kcyBDbG9uZWFibGVMaXN0Tm9kZT4oc2xpY2U6IFNsaWNlPFU+KTogTGlua2VkTGlzdDxVPiB7XG4gICAgbGV0IGxpc3QgPSBuZXcgTGlua2VkTGlzdDxVPigpO1xuICAgIHNsaWNlLmZvckVhY2hOb2RlKG4gPT4gbGlzdC5hcHBlbmQobi5jbG9uZSgpKSk7XG4gICAgcmV0dXJuIGxpc3Q7XG4gIH1cblxuICBwcml2YXRlIF9oZWFkOiBPcHRpb248VD47XG4gIHByaXZhdGUgX3RhaWw6IE9wdGlvbjxUPjtcblxuICBjb25zdHJ1Y3RvcihoZWFkOiBPcHRpb248VD4sIHRhaWw6IE9wdGlvbjxUPikge1xuICAgIHRoaXMuX2hlYWQgPSBoZWFkO1xuICAgIHRoaXMuX3RhaWwgPSB0YWlsO1xuICB9XG5cbiAgZm9yRWFjaE5vZGUoY2FsbGJhY2s6IChub2RlOiBUKSA9PiB2b2lkKSB7XG4gICAgbGV0IG5vZGUgPSB0aGlzLl9oZWFkO1xuXG4gICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgIGNhbGxiYWNrKG5vZGUpO1xuICAgICAgbm9kZSA9IHRoaXMubmV4dE5vZGUobm9kZSk7XG4gICAgfVxuICB9XG5cbiAgY29udGFpbnMobmVlZGxlOiBUKTogYm9vbGVhbiB7XG4gICAgbGV0IG5vZGUgPSB0aGlzLl9oZWFkO1xuXG4gICAgd2hpbGUgKG5vZGUgIT09IG51bGwpIHtcbiAgICAgIGlmIChub2RlID09PSBuZWVkbGUpIHJldHVybiB0cnVlO1xuICAgICAgbm9kZSA9IDx0cnVzdD5ub2RlLm5leHQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaGVhZCgpOiBPcHRpb248VD4ge1xuICAgIHJldHVybiB0aGlzLl9oZWFkO1xuICB9XG5cbiAgdGFpbCgpOiBPcHRpb248VD4ge1xuICAgIHJldHVybiB0aGlzLl90YWlsO1xuICB9XG5cbiAgdG9BcnJheSgpOiBUW10ge1xuICAgIGxldCBvdXQ6IFRbXSA9IFtdO1xuICAgIHRoaXMuZm9yRWFjaE5vZGUobiA9PiBvdXQucHVzaChuKSk7XG4gICAgcmV0dXJuIG91dDtcbiAgfVxuXG4gIG5leHROb2RlKG5vZGU6IFQpOiBPcHRpb248VD4ge1xuICAgIGlmIChub2RlID09PSB0aGlzLl90YWlsKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gbm9kZS5uZXh0IGFzIFQ7XG4gIH1cblxuICBwcmV2Tm9kZShub2RlOiBUKTogT3B0aW9uPFQ+IHtcbiAgICBpZiAobm9kZSA9PT0gdGhpcy5faGVhZCkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIG5vZGUucHJldiBhcyBUO1xuICB9XG5cbiAgaXNFbXB0eSgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IEVNUFRZX1NMSUNFID0gbmV3IExpc3RTbGljZShudWxsLCBudWxsKTtcbiJdfQ==