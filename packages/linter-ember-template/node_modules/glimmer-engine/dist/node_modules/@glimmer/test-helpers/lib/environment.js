"use strict";
var __extends = (this && this.__extends) || function (d, b) {
    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
};
var runtime_1 = require("@glimmer/runtime");
var helpers_1 = require("./helpers");
var util_1 = require("@glimmer/util");
var object_1 = require("@glimmer/object");
var reference_1 = require("@glimmer/reference");
var object_reference_1 = require("@glimmer/object-reference");
var ArrayIterator = (function () {
    function ArrayIterator(array, keyFor) {
        this.position = 0;
        this.array = array;
        this.keyFor = keyFor;
    }
    ArrayIterator.prototype.isEmpty = function () {
        return this.array.length === 0;
    };
    ArrayIterator.prototype.next = function () {
        var _a = this, position = _a.position, array = _a.array, keyFor = _a.keyFor;
        if (position >= array.length)
            return null;
        var value = array[position];
        var key = keyFor(value, position);
        var memo = position;
        this.position++;
        return { key: key, value: value, memo: memo };
    };
    return ArrayIterator;
}());
var ObjectKeysIterator = (function () {
    function ObjectKeysIterator(keys, values, keyFor) {
        this.position = 0;
        this.keys = keys;
        this.values = values;
        this.keyFor = keyFor;
    }
    ObjectKeysIterator.prototype.isEmpty = function () {
        return this.keys.length === 0;
    };
    ObjectKeysIterator.prototype.next = function () {
        var _a = this, position = _a.position, keys = _a.keys, values = _a.values, keyFor = _a.keyFor;
        if (position >= keys.length)
            return null;
        var value = values[position];
        var memo = keys[position];
        var key = keyFor(value, memo);
        this.position++;
        return { key: key, value: value, memo: memo };
    };
    return ObjectKeysIterator;
}());
var EmptyIterator = (function () {
    function EmptyIterator() {
    }
    EmptyIterator.prototype.isEmpty = function () {
        return true;
    };
    EmptyIterator.prototype.next = function () {
        throw new Error("Cannot call next() on an empty iterator");
    };
    return EmptyIterator;
}());
var EMPTY_ITERATOR = new EmptyIterator();
var Iterable = (function () {
    function Iterable(ref, keyFor) {
        this.tag = ref.tag;
        this.ref = ref;
        this.keyFor = keyFor;
    }
    Iterable.prototype.iterate = function () {
        var _a = this, ref = _a.ref, keyFor = _a.keyFor;
        var iterable = ref.value();
        if (Array.isArray(iterable)) {
            return iterable.length > 0 ? new ArrayIterator(iterable, keyFor) : EMPTY_ITERATOR;
        }
        else if (iterable === undefined || iterable === null) {
            return EMPTY_ITERATOR;
        }
        else if (iterable.forEach !== undefined) {
            var array_1 = [];
            iterable.forEach(function (item) {
                array_1.push(item);
            });
            return array_1.length > 0 ? new ArrayIterator(array_1, keyFor) : EMPTY_ITERATOR;
        }
        else if (typeof iterable === 'object') {
            var keys = Object.keys(iterable);
            return keys.length > 0 ? new ObjectKeysIterator(keys, keys.map(function (key) { return iterable[key]; }), keyFor) : EMPTY_ITERATOR;
        }
        else {
            throw new Error("Don't know how to {{#each " + iterable + "}}");
        }
    };
    Iterable.prototype.valueReferenceFor = function (item) {
        return new object_reference_1.UpdatableReference(item.value);
    };
    Iterable.prototype.updateValueReference = function (reference, item) {
        reference.update(item.value);
    };
    Iterable.prototype.memoReferenceFor = function (item) {
        return new object_reference_1.UpdatableReference(item.memo);
    };
    Iterable.prototype.updateMemoReference = function (reference, item) {
        reference.update(item.memo);
    };
    return Iterable;
}());
var BasicComponent = (function () {
    function BasicComponent(attrs) {
        this.attrs = attrs;
    }
    return BasicComponent;
}());
exports.BasicComponent = BasicComponent;
var EmberishCurlyComponent = (function (_super) {
    __extends(EmberishCurlyComponent, _super);
    function EmberishCurlyComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.dirtinessTag = new reference_1.DirtyableTag();
        _this.tagName = null;
        _this.attributeBindings = null;
        _this.parentView = null;
        return _this;
    }
    EmberishCurlyComponent.create = function (args) {
        return _super.create.call(this, args);
    };
    EmberishCurlyComponent.prototype.recompute = function () {
        this.dirtinessTag.dirty();
    };
    EmberishCurlyComponent.prototype.didInitAttrs = function (options) { };
    EmberishCurlyComponent.prototype.didUpdateAttrs = function (diff) { };
    EmberishCurlyComponent.prototype.didReceiveAttrs = function (diff) { };
    EmberishCurlyComponent.prototype.willInsertElement = function () { };
    EmberishCurlyComponent.prototype.willUpdate = function () { };
    EmberishCurlyComponent.prototype.willRender = function () { };
    EmberishCurlyComponent.prototype.didInsertElement = function () { };
    EmberishCurlyComponent.prototype.didUpdate = function () { };
    EmberishCurlyComponent.prototype.didRender = function () { };
    return EmberishCurlyComponent;
}(object_1.default));
exports.EmberishCurlyComponent = EmberishCurlyComponent;
var EmberishGlimmerComponent = (function (_super) {
    __extends(EmberishGlimmerComponent, _super);
    function EmberishGlimmerComponent() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.dirtinessTag = new reference_1.DirtyableTag();
        _this.parentView = null;
        return _this;
    }
    EmberishGlimmerComponent.create = function (args) {
        return _super.create.call(this, args);
    };
    EmberishGlimmerComponent.prototype.recompute = function () {
        this.dirtinessTag.dirty();
    };
    EmberishGlimmerComponent.prototype.didInitAttrs = function (options) { };
    EmberishGlimmerComponent.prototype.didUpdateAttrs = function (diff) { };
    EmberishGlimmerComponent.prototype.didReceiveAttrs = function (diff) { };
    EmberishGlimmerComponent.prototype.willInsertElement = function () { };
    EmberishGlimmerComponent.prototype.willUpdate = function () { };
    EmberishGlimmerComponent.prototype.willRender = function () { };
    EmberishGlimmerComponent.prototype.didInsertElement = function () { };
    EmberishGlimmerComponent.prototype.didUpdate = function () { };
    EmberishGlimmerComponent.prototype.didRender = function () { };
    return EmberishGlimmerComponent;
}(object_1.default));
exports.EmberishGlimmerComponent = EmberishGlimmerComponent;
var BasicComponentManager = (function () {
    function BasicComponentManager() {
    }
    BasicComponentManager.prototype.prepareArgs = function (definition, args) {
        return args;
    };
    BasicComponentManager.prototype.create = function (environment, definition, args) {
        var klass = definition.ComponentClass || BasicComponent;
        return new klass(args.named.value());
    };
    BasicComponentManager.prototype.layoutFor = function (definition, component, env) {
        var layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        return env.compiledLayouts[definition.name] = runtime_1.compileLayout(new BasicComponentLayoutCompiler(definition.layoutString), env);
    };
    BasicComponentManager.prototype.getSelf = function (component) {
        return new object_reference_1.UpdatableReference(component);
    };
    BasicComponentManager.prototype.didCreateElement = function (component, element) {
        component.element = element;
    };
    BasicComponentManager.prototype.didRenderLayout = function (component, bounds) {
        component.bounds = bounds;
    };
    BasicComponentManager.prototype.didCreate = function () { };
    BasicComponentManager.prototype.getTag = function () {
        return null;
    };
    BasicComponentManager.prototype.update = function (component, attrs) {
        component.attrs = attrs.named.value();
    };
    BasicComponentManager.prototype.didUpdateLayout = function () { };
    BasicComponentManager.prototype.didUpdate = function () { };
    BasicComponentManager.prototype.getDestructor = function () {
        return null;
    };
    return BasicComponentManager;
}());
var BASIC_COMPONENT_MANAGER = new BasicComponentManager();
var StaticTaglessComponentManager = (function (_super) {
    __extends(StaticTaglessComponentManager, _super);
    function StaticTaglessComponentManager() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StaticTaglessComponentManager.prototype.layoutFor = function (definition, component, env) {
        var layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        return env.compiledLayouts[definition.name] = runtime_1.compileLayout(new StaticTaglessComponentLayoutCompiler(definition.layoutString), env);
    };
    return StaticTaglessComponentManager;
}(BasicComponentManager));
var STATIC_TAGLESS_COMPONENT_MANAGER = new StaticTaglessComponentManager();
var BaseEmberishGlimmerComponent = EmberishGlimmerComponent.extend();
var EmberishGlimmerComponentManager = (function () {
    function EmberishGlimmerComponentManager() {
    }
    EmberishGlimmerComponentManager.prototype.prepareArgs = function (definition, args) {
        return args;
    };
    EmberishGlimmerComponentManager.prototype.create = function (environment, definition, args, dynamicScope, callerSelf, hasDefaultBlock) {
        var klass = definition.ComponentClass || BaseEmberishGlimmerComponent;
        var attrs = args.named.value();
        var component = klass.create({ attrs: attrs });
        component.didInitAttrs({ attrs: attrs });
        component.didReceiveAttrs({ oldAttrs: null, newAttrs: attrs });
        component.willInsertElement();
        component.willRender();
        return component;
    };
    EmberishGlimmerComponentManager.prototype.layoutFor = function (definition, component, env) {
        if (env.compiledLayouts[definition.name]) {
            return env.compiledLayouts[definition.name];
        }
        return env.compiledLayouts[definition.name] = runtime_1.compileLayout(new EmberishGlimmerComponentLayoutCompiler(definition.layoutString), env);
    };
    EmberishGlimmerComponentManager.prototype.getSelf = function (component) {
        return new object_reference_1.UpdatableReference(component);
    };
    EmberishGlimmerComponentManager.prototype.didCreateElement = function (component, element) {
        component.element = element;
    };
    EmberishGlimmerComponentManager.prototype.didRenderLayout = function (component, bounds) {
        component.bounds = bounds;
    };
    EmberishGlimmerComponentManager.prototype.didCreate = function (component) {
        component.didInsertElement();
        component.didRender();
    };
    EmberishGlimmerComponentManager.prototype.getTag = function (component) {
        return component.dirtinessTag;
    };
    EmberishGlimmerComponentManager.prototype.update = function (component, args) {
        var oldAttrs = component.attrs;
        var newAttrs = args.named.value();
        component.set('attrs', newAttrs);
        component.didUpdateAttrs({ oldAttrs: oldAttrs, newAttrs: newAttrs });
        component.didReceiveAttrs({ oldAttrs: oldAttrs, newAttrs: newAttrs });
        component.willUpdate();
        component.willRender();
    };
    EmberishGlimmerComponentManager.prototype.didUpdateLayout = function () { };
    EmberishGlimmerComponentManager.prototype.didUpdate = function (component) {
        component.didUpdate();
        component.didRender();
    };
    EmberishGlimmerComponentManager.prototype.getDestructor = function (component) {
        return {
            destroy: function () {
                component.destroy();
            }
        };
    };
    return EmberishGlimmerComponentManager;
}());
var ProcessedArgs = (function () {
    function ProcessedArgs(args, positionalParamsDefinition) {
        this.tag = args.tag;
        this.named = args.named;
        this.positional = args.positional;
        this.positionalParamNames = positionalParamsDefinition;
    }
    ProcessedArgs.prototype.value = function () {
        var _a = this, named = _a.named, positional = _a.positional, positionalParamNames = _a.positionalParamNames;
        var merged = Object.assign({}, named.value());
        if (positionalParamNames && positionalParamNames.length) {
            for (var i = 0; i < positionalParamNames.length; i++) {
                var name = positionalParamNames[i];
                var reference = positional.at(i);
                merged[name] = reference.value();
            }
        }
        return {
            attrs: merged,
            props: merged
        };
    };
    return ProcessedArgs;
}());
exports.ProcessedArgs = ProcessedArgs;
function processArgs(args, positionalParamsDefinition) {
    return new ProcessedArgs(args, positionalParamsDefinition);
}
var EMBERISH_GLIMMER_COMPONENT_MANAGER = new EmberishGlimmerComponentManager();
var BaseEmberishCurlyComponent = EmberishCurlyComponent.extend();
var EmberishCurlyComponentManager = (function () {
    function EmberishCurlyComponentManager() {
    }
    EmberishCurlyComponentManager.prototype.prepareArgs = function (definition, args, dynamicScope) {
        var dyn = definition.ComponentClass ? definition.ComponentClass['fromDynamicScope'] : null;
        if (dyn) {
            var map_1 = util_1.assign({}, args.named.map);
            dyn.forEach(function (name) { return map_1[name] = dynamicScope.get(name); });
            args = runtime_1.EvaluatedArgs.create(args.positional, runtime_1.EvaluatedNamedArgs.create(map_1), args.blocks);
        }
        return args;
    };
    EmberishCurlyComponentManager.prototype.create = function (environment, definition, args, dynamicScope, callerSelf) {
        var klass = definition.ComponentClass || BaseEmberishCurlyComponent;
        var processedArgs = processArgs(args, klass['positionalParams']);
        var attrs = processedArgs.value().attrs;
        var self = callerSelf.value();
        var merged = util_1.assign({}, attrs, { attrs: attrs }, { args: processedArgs }, { targetObject: self });
        var component = klass.create(merged);
        component.didInitAttrs({ attrs: attrs });
        component.didReceiveAttrs({ oldAttrs: null, newAttrs: attrs });
        component.willInsertElement();
        component.willRender();
        return component;
    };
    EmberishCurlyComponentManager.prototype.layoutFor = function (definition, component, env) {
        var layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        var layoutString = definition.layoutString;
        var lateBound = !layoutString;
        if (!layoutString && layoutString !== '') {
            layoutString = component['layout'];
        }
        layout = runtime_1.compileLayout(new EmberishCurlyComponentLayoutCompiler(layoutString), env);
        return lateBound ? layout : (env.compiledLayouts[definition.name] = layout);
    };
    EmberishCurlyComponentManager.prototype.getSelf = function (component) {
        return new object_reference_1.UpdatableReference(component);
    };
    EmberishCurlyComponentManager.prototype.didCreateElement = function (component, element, operations) {
        component.element = element;
        var bindings = component.attributeBindings;
        var rootRef = new object_reference_1.UpdatableReference(component);
        if (bindings) {
            for (var i = 0; i < bindings.length; i++) {
                var attribute = bindings[i];
                var reference = rootRef.get(attribute);
                operations.addDynamicAttribute(element, attribute, reference, false);
            }
        }
    };
    EmberishCurlyComponentManager.prototype.didRenderLayout = function (component, bounds) {
        component.bounds = bounds;
    };
    EmberishCurlyComponentManager.prototype.didCreate = function (component) {
        component.didInsertElement();
        component.didRender();
    };
    EmberishCurlyComponentManager.prototype.getTag = function (component) {
        return component.dirtinessTag;
    };
    EmberishCurlyComponentManager.prototype.update = function (component, args) {
        var oldAttrs = component.attrs;
        var newAttrs = component.args.value().attrs;
        var merged = util_1.assign({}, newAttrs, { attrs: newAttrs });
        component.setProperties(merged);
        component.didUpdateAttrs({ oldAttrs: oldAttrs, newAttrs: newAttrs });
        component.didReceiveAttrs({ oldAttrs: oldAttrs, newAttrs: newAttrs });
        component.willUpdate();
        component.willRender();
    };
    EmberishCurlyComponentManager.prototype.didUpdateLayout = function () { };
    EmberishCurlyComponentManager.prototype.didUpdate = function (component) {
        component.didUpdate();
        component.didRender();
    };
    EmberishCurlyComponentManager.prototype.getDestructor = function (component) {
        return {
            destroy: function () {
                component.destroy();
            }
        };
    };
    return EmberishCurlyComponentManager;
}());
var EMBERISH_CURLY_COMPONENT_MANAGER = new EmberishCurlyComponentManager();
function emberToBool(value) {
    if (Array.isArray(value)) {
        return value.length > 0;
    }
    else {
        return !!value;
    }
}
var EmberishConditionalReference = (function (_super) {
    __extends(EmberishConditionalReference, _super);
    function EmberishConditionalReference() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EmberishConditionalReference.prototype.toBool = function (value) {
        return emberToBool(value);
    };
    return EmberishConditionalReference;
}(runtime_1.ConditionalReference));
var SimplePathReference = (function () {
    function SimplePathReference(parent, property) {
        this.tag = reference_1.VOLATILE_TAG;
        this.parent = parent;
        this.property = property;
    }
    SimplePathReference.prototype.value = function () {
        return this.parent.value()[this.property];
    };
    SimplePathReference.prototype.get = function (prop) {
        return new SimplePathReference(this, prop);
    };
    return SimplePathReference;
}());
exports.SimplePathReference = SimplePathReference;
var HelperReference = (function () {
    function HelperReference(helper, args) {
        this.tag = reference_1.VOLATILE_TAG;
        this.helper = helper;
        this.args = args;
    }
    HelperReference.prototype.value = function () {
        var _a = this, helper = _a.helper, _b = _a.args, positional = _b.positional, named = _b.named;
        return helper(positional.value(), named.value());
    };
    HelperReference.prototype.get = function (prop) {
        return new SimplePathReference(this, prop);
    };
    return HelperReference;
}());
var InertModifierManager = (function () {
    function InertModifierManager() {
    }
    InertModifierManager.prototype.create = function () { };
    InertModifierManager.prototype.install = function (modifier) { };
    InertModifierManager.prototype.update = function (modifier) { };
    InertModifierManager.prototype.getDestructor = function (modifier) {
        return null;
    };
    return InertModifierManager;
}());
var TestModifier = (function () {
    function TestModifier(element, args, dom) {
        this.element = element;
        this.args = args;
        this.dom = dom;
    }
    return TestModifier;
}());
exports.TestModifier = TestModifier;
var TestModifierManager = (function () {
    function TestModifierManager() {
        this.installedElements = [];
        this.updatedElements = [];
        this.destroyedModifiers = [];
    }
    TestModifierManager.prototype.create = function (element, args, dynamicScope, dom) {
        return new TestModifier(element, args, dom);
    };
    TestModifierManager.prototype.install = function (_a) {
        var element = _a.element, args = _a.args, dom = _a.dom;
        this.installedElements.push(element);
        var param = args.positional.at(0).value();
        dom.setAttribute(element, 'data-modifier', "installed - " + param);
        return;
    };
    TestModifierManager.prototype.update = function (_a) {
        var element = _a.element, args = _a.args, dom = _a.dom;
        this.updatedElements.push(element);
        var param = args.positional.at(0).value();
        dom.setAttribute(element, 'data-modifier', "updated - " + param);
        return;
    };
    TestModifierManager.prototype.getDestructor = function (modifier) {
        var _this = this;
        return {
            destroy: function () {
                _this.destroyedModifiers.push(modifier);
                var element = modifier.element, dom = modifier.dom;
                dom.removeAttribute(element, 'data-modifier');
            }
        };
    };
    return TestModifierManager;
}());
exports.TestModifierManager = TestModifierManager;
var TestEnvironment = (function (_super) {
    __extends(TestEnvironment, _super);
    function TestEnvironment(options) {
        if (options === void 0) { options = {
            document: document,
            appendOperations: new runtime_1.DOMTreeConstruction(document)
        }; }
        var _this = _super.call(this, { appendOperations: options.appendOperations, updateOperations: new runtime_1.DOMChanges(options.document) }) || this;
        _this.helpers = util_1.dict();
        _this.modifiers = util_1.dict();
        _this.partials = util_1.dict();
        _this.components = util_1.dict();
        _this.compiledLayouts = util_1.dict();
        _this.uselessAnchor = options.document.createElement('a');
        _this.registerHelper("if", function (_a) {
            var cond = _a[0], yes = _a[1], no = _a[2];
            return cond ? yes : no;
        });
        _this.registerHelper("unless", function (_a) {
            var cond = _a[0], yes = _a[1], no = _a[2];
            return cond ? no : yes;
        });
        _this.registerInternalHelper("-get-dynamic-var", runtime_1.getDynamicVar);
        _this.registerModifier("action", new InertModifierManager());
        _this.registerInternalHelper("component", function (vm, args, symbolTable) {
            return new DynamicComponentReference(args.positional.at(0), vm.env, symbolTable);
        });
        _this.registerInternalHelper("hash", function (vm, args) { return args.named; });
        return _this;
    }
    TestEnvironment.prototype.protocolForURL = function (url) {
        this.uselessAnchor.href = url;
        return this.uselessAnchor.protocol;
    };
    TestEnvironment.prototype.registerHelper = function (name, helper) {
        this.helpers[name] = function (vm, args) { return new HelperReference(helper, args); };
    };
    TestEnvironment.prototype.registerInternalHelper = function (name, helper) {
        this.helpers[name] = helper;
    };
    TestEnvironment.prototype.registerModifier = function (name, modifier) {
        this.modifiers[name] = modifier;
    };
    TestEnvironment.prototype.registerPartial = function (name, source) {
        this.partials[name] = new runtime_1.PartialDefinition(name, helpers_1.compile(source, { env: this }));
    };
    TestEnvironment.prototype.registerComponent = function (name, definition) {
        this.components[name] = definition;
        return definition;
    };
    TestEnvironment.prototype.registerBasicComponent = function (name, Component, layout) {
        var definition = new BasicComponentDefinition(name, BASIC_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    };
    TestEnvironment.prototype.registerStaticTaglessComponent = function (name, Component, layout) {
        var definition = new StaticTaglessComponentDefinition(name, STATIC_TAGLESS_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    };
    TestEnvironment.prototype.registerEmberishCurlyComponent = function (name, Component, layout) {
        var definition = new EmberishCurlyComponentDefinition(name, EMBERISH_CURLY_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    };
    TestEnvironment.prototype.registerEmberishGlimmerComponent = function (name, Component, layout) {
        var definition = new EmberishGlimmerComponentDefinition(name, EMBERISH_GLIMMER_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    };
    TestEnvironment.prototype.toConditionalReference = function (reference) {
        if (reference_1.isConst(reference)) {
            return runtime_1.PrimitiveReference.create(emberToBool(reference.value()));
        }
        return new EmberishConditionalReference(reference);
    };
    TestEnvironment.prototype.macros = function () {
        var macros = _super.prototype.macros.call(this);
        populateBlocks(macros.blocks, macros.inlines);
        return macros;
    };
    TestEnvironment.prototype.hasHelper = function (helperName) {
        return helperName.length === 1 && (helperName[0] in this.helpers);
    };
    TestEnvironment.prototype.lookupHelper = function (helperParts) {
        var helperName = helperParts[0];
        var helper = this.helpers[helperName];
        if (!helper)
            throw new Error("Helper for " + helperParts.join('.') + " not found.");
        return helper;
    };
    TestEnvironment.prototype.hasPartial = function (partialName) {
        return partialName in this.partials;
    };
    TestEnvironment.prototype.lookupPartial = function (partialName) {
        var partial = this.partials[partialName];
        return partial;
    };
    TestEnvironment.prototype.hasComponentDefinition = function (name) {
        return !!this.components[name[0]];
    };
    TestEnvironment.prototype.getComponentDefinition = function (name, blockMeta) {
        return this.components[name[0]];
    };
    TestEnvironment.prototype.hasModifier = function (modifierName) {
        return modifierName.length === 1 && (modifierName[0] in this.modifiers);
    };
    TestEnvironment.prototype.lookupModifier = function (modifierName) {
        var name = modifierName[0];
        var modifier = this.modifiers[name];
        if (!modifier)
            throw new Error("Modifier for " + modifierName.join('.') + " not found.");
        return modifier;
    };
    TestEnvironment.prototype.compile = function (template) {
        return helpers_1.compile(template, { env: this });
    };
    TestEnvironment.prototype.compileLayout = function (template) {
        return helpers_1.compileLayout(template, { env: this });
    };
    TestEnvironment.prototype.iterableFor = function (ref, args) {
        var keyPath = args.named.get("key").value();
        var keyFor;
        if (!keyPath) {
            throw new Error('Must specify a key for #each');
        }
        switch (keyPath) {
            case '@index':
                keyFor = function (_, index) { return String(index); };
                break;
            case '@primitive':
                keyFor = function (item) { return String(item); };
                break;
            default:
                keyFor = function (item) { return item[keyPath]; };
                break;
        }
        return new Iterable(ref, keyFor);
    };
    return TestEnvironment;
}(runtime_1.Environment));
exports.TestEnvironment = TestEnvironment;
var TestDynamicScope = (function () {
    function TestDynamicScope(bucket) {
        if (bucket === void 0) { bucket = null; }
        if (bucket) {
            this.bucket = util_1.assign({}, bucket);
        }
        else {
            this.bucket = {};
        }
    }
    TestDynamicScope.prototype.get = function (key) {
        return this.bucket[key];
    };
    TestDynamicScope.prototype.set = function (key, reference) {
        return this.bucket[key] = reference;
    };
    TestDynamicScope.prototype.child = function () {
        return new TestDynamicScope(this.bucket);
    };
    return TestDynamicScope;
}());
exports.TestDynamicScope = TestDynamicScope;
var DynamicComponentReference = (function () {
    function DynamicComponentReference(nameRef, env, symbolTable) {
        this.nameRef = nameRef;
        this.env = env;
        this.symbolTable = symbolTable;
        this.tag = nameRef.tag;
    }
    DynamicComponentReference.prototype.value = function () {
        var _a = this, env = _a.env, nameRef = _a.nameRef;
        var nameOrDef = nameRef.value();
        if (typeof nameOrDef === 'string') {
            return env.getComponentDefinition([nameOrDef], this.symbolTable);
        }
        else if (runtime_1.isComponentDefinition(nameOrDef)) {
            return nameOrDef;
        }
        return null;
    };
    DynamicComponentReference.prototype.get = function () {
        return null;
    };
    return DynamicComponentReference;
}());
function dynamicComponentFor(vm, symbolTable) {
    var args = vm.getArgs();
    var nameRef = args.positional.at(0);
    var env = vm.env;
    return new DynamicComponentReference(nameRef, env, symbolTable);
}
;
var GenericComponentDefinition = (function (_super) {
    __extends(GenericComponentDefinition, _super);
    function GenericComponentDefinition(name, manager, ComponentClass, layout) {
        var _this = _super.call(this, name, manager, ComponentClass) || this;
        _this.layoutString = layout;
        return _this;
    }
    return GenericComponentDefinition;
}(runtime_1.ComponentDefinition));
exports.GenericComponentDefinition = GenericComponentDefinition;
var BasicComponentDefinition = (function (_super) {
    __extends(BasicComponentDefinition, _super);
    function BasicComponentDefinition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return BasicComponentDefinition;
}(GenericComponentDefinition));
exports.BasicComponentDefinition = BasicComponentDefinition;
var StaticTaglessComponentDefinition = (function (_super) {
    __extends(StaticTaglessComponentDefinition, _super);
    function StaticTaglessComponentDefinition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return StaticTaglessComponentDefinition;
}(GenericComponentDefinition));
var EmberishCurlyComponentDefinition = (function (_super) {
    __extends(EmberishCurlyComponentDefinition, _super);
    function EmberishCurlyComponentDefinition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return EmberishCurlyComponentDefinition;
}(GenericComponentDefinition));
exports.EmberishCurlyComponentDefinition = EmberishCurlyComponentDefinition;
var EmberishGlimmerComponentDefinition = (function (_super) {
    __extends(EmberishGlimmerComponentDefinition, _super);
    function EmberishGlimmerComponentDefinition() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return EmberishGlimmerComponentDefinition;
}(GenericComponentDefinition));
exports.EmberishGlimmerComponentDefinition = EmberishGlimmerComponentDefinition;
var GenericComponentLayoutCompiler = (function () {
    function GenericComponentLayoutCompiler(layoutString) {
        this.layoutString = layoutString;
    }
    GenericComponentLayoutCompiler.prototype.compileLayout = function (env) {
        return helpers_1.compileLayout(this.layoutString, { env: env });
    };
    return GenericComponentLayoutCompiler;
}());
var BasicComponentLayoutCompiler = (function (_super) {
    __extends(BasicComponentLayoutCompiler, _super);
    function BasicComponentLayoutCompiler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    BasicComponentLayoutCompiler.prototype.compile = function (builder) {
        builder.fromLayout(this.compileLayout(builder.env));
    };
    return BasicComponentLayoutCompiler;
}(GenericComponentLayoutCompiler));
var StaticTaglessComponentLayoutCompiler = (function (_super) {
    __extends(StaticTaglessComponentLayoutCompiler, _super);
    function StaticTaglessComponentLayoutCompiler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    StaticTaglessComponentLayoutCompiler.prototype.compile = function (builder) {
        builder.wrapLayout(this.compileLayout(builder.env));
    };
    return StaticTaglessComponentLayoutCompiler;
}(GenericComponentLayoutCompiler));
function EmberTagName(vm) {
    var self = vm.getSelf().value();
    var tagName = self['tagName'];
    tagName = tagName === '' ? null : self['tagName'] || 'div';
    return runtime_1.PrimitiveReference.create(tagName);
}
function EmberID(vm) {
    var self = vm.getSelf().value();
    return runtime_1.PrimitiveReference.create("ember" + self._guid);
}
var EmberishCurlyComponentLayoutCompiler = (function (_super) {
    __extends(EmberishCurlyComponentLayoutCompiler, _super);
    function EmberishCurlyComponentLayoutCompiler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EmberishCurlyComponentLayoutCompiler.prototype.compile = function (builder) {
        builder.wrapLayout(this.compileLayout(builder.env));
        builder.tag.dynamic(EmberTagName);
        builder.attrs.static('class', 'ember-view');
        builder.attrs.dynamic('id', EmberID);
    };
    return EmberishCurlyComponentLayoutCompiler;
}(GenericComponentLayoutCompiler));
var EmberishGlimmerComponentLayoutCompiler = (function (_super) {
    __extends(EmberishGlimmerComponentLayoutCompiler, _super);
    function EmberishGlimmerComponentLayoutCompiler() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    EmberishGlimmerComponentLayoutCompiler.prototype.compile = function (builder) {
        builder.fromLayout(this.compileLayout(builder.env));
        builder.attrs.static('class', 'ember-view');
        builder.attrs.dynamic('id', EmberID);
    };
    return EmberishGlimmerComponentLayoutCompiler;
}(GenericComponentLayoutCompiler));
function inspectHooks(ComponentClass) {
    return ComponentClass.extend({
        init: function () {
            this._super.apply(this, arguments);
            this.hooks = {
                didInitAttrs: 0,
                didUpdateAttrs: 0,
                didReceiveAttrs: 0,
                willInsertElement: 0,
                willUpdate: 0,
                willRender: 0,
                didInsertElement: 0,
                didUpdate: 0,
                didRender: 0
            };
        },
        didInitAttrs: function () {
            this._super.apply(this, arguments);
            this.hooks['didInitAttrs']++;
        },
        didUpdateAttrs: function () {
            this._super.apply(this, arguments);
            this.hooks['didUpdateAttrs']++;
        },
        didReceiveAttrs: function () {
            this._super.apply(this, arguments);
            this.hooks['didReceiveAttrs']++;
        },
        willInsertElement: function () {
            this._super.apply(this, arguments);
            this.hooks['willInsertElement']++;
        },
        willUpdate: function () {
            this._super.apply(this, arguments);
            this.hooks['willUpdate']++;
        },
        willRender: function () {
            this._super.apply(this, arguments);
            this.hooks['willRender']++;
        },
        didInsertElement: function () {
            this._super.apply(this, arguments);
            this.hooks['didInsertElement']++;
        },
        didUpdate: function () {
            this._super.apply(this, arguments);
            this.hooks['didUpdate']++;
        },
        didRender: function () {
            this._super.apply(this, arguments);
            this.hooks['didRender']++;
        }
    });
}
exports.inspectHooks = inspectHooks;
var _a = runtime_1.BaselineSyntax.NestedBlock, defaultBlock = _a.defaultBlock, inverseBlock = _a.inverseBlock, params = _a.params, hash = _a.hash;
function populateBlocks(blocks, inlines) {
    blocks.add('identity', function (sexp, builder) {
        builder.evaluate(sexp[4]);
    });
    blocks.add('render-inverse', function (sexp, builder) {
        builder.evaluate(sexp[5]);
    });
    blocks.add('-with-dynamic-vars', function (sexp, builder) {
        var block = defaultBlock(sexp);
        var args = runtime_1.compileArgs(params(sexp), hash(sexp), builder);
        builder.unit(function (b) {
            b.putArgs(args);
            b.pushDynamicScope();
            b.bindDynamicScope(args.named.keys);
            b.evaluate(util_1.unwrap(block));
            b.popDynamicScope();
        });
    });
    blocks.add('-in-element', function (sexp, builder) {
        var block = defaultBlock(sexp);
        var args = runtime_1.compileArgs(params(sexp), hash(sexp), builder);
        builder.putArgs(args);
        builder.test('simple');
        builder.labelled(null, function (b) {
            b.jumpUnless('END');
            b.pushRemoteElement();
            b.evaluate(util_1.unwrap(block));
            b.popRemoteElement();
        });
    });
    blocks.add('component', function (sexp, builder) {
        var path = sexp[1], params = sexp[2], hash = sexp[3], _default = sexp[4], inverse = sexp[5];
        var definitionArgs = [params.slice(0, 1), null, null, null];
        var args = [params.slice(1), hash, _default, inverse];
        builder.component.dynamic(definitionArgs, dynamicComponentFor, args, builder.symbolTable);
        return true;
    });
    blocks.addMissing(function (sexp, builder) {
        var path = sexp[1], params = sexp[2], hash = sexp[3], _default = sexp[4], inverse = sexp[5];
        var table = builder.symbolTable;
        if (!params) {
            params = [];
        }
        if (path.length > 1) {
            var definitionArgs = [[['get', path]], hash, _default, inverse];
            var args = [params, hash, _default, inverse];
            builder.component.dynamic(definitionArgs, dynamicComponentFor, args, table);
            return true;
        }
        var definition = builder.env.getComponentDefinition(path, builder.symbolTable);
        if (definition) {
            builder.component.static(definition, [params, hash, _default, inverse], table);
            return true;
        }
        return false;
    });
    inlines.add('component', function (path, params, hash, builder) {
        var definitionArgs = [params.slice(0, 1), null, null, null];
        var args = [params.slice(1), hash, null, null];
        builder.component.dynamic(definitionArgs, dynamicComponentFor, args, builder.symbolTable);
        return true;
    });
    inlines.addMissing(function (path, params, hash, builder) {
        var table = builder.symbolTable;
        var definition = builder.env.getComponentDefinition(path, builder.symbolTable);
        if (path.length > 1) {
            var definitionArgs = [[['get', path]], hash, null, null];
            var args = [params, hash, null, null];
            builder.component.dynamic(definitionArgs, dynamicComponentFor, args, table);
            return true;
        }
        if (definition) {
            builder.component.static(definition, [params, hash, null, null], table);
            return true;
        }
        return false;
    });
    return { blocks: blocks, inlines: inlines };
}
function equalsElement(element, tagName, attributes, content) {
    QUnit.push(element.tagName === tagName.toUpperCase(), element.tagName.toLowerCase(), tagName, "expect tagName to be " + tagName);
    var expectedAttrs = util_1.dict();
    var expectedCount = 0;
    for (var prop in attributes) {
        expectedCount++;
        var expected = attributes[prop];
        var matcher = typeof expected === 'object' && exports.MATCHER in expected ? expected : equalsAttr(expected);
        expectedAttrs[prop] = matcher;
        QUnit.push(expectedAttrs[prop].match(element.getAttribute(prop)), matcher.fail(element.getAttribute(prop)), matcher.fail(element.getAttribute(prop)), "Expected element's " + prop + " attribute " + matcher.expected());
    }
    var actualAttributes = {};
    for (var i = 0, l = element.attributes.length; i < l; i++) {
        actualAttributes[element.attributes[i].name] = element.attributes[i].value;
    }
    if (!(element instanceof HTMLElement)) {
        QUnit.push(element instanceof HTMLElement, null, null, "Element must be an HTML Element, not an SVG Element");
    }
    else {
        QUnit.push(element.attributes.length === expectedCount, element.attributes.length, expectedCount, "Expected " + expectedCount + " attributes; got " + element.outerHTML);
        if (content !== null) {
            QUnit.push(element.innerHTML === content, element.innerHTML, content, "The element had '" + content + "' as its content");
        }
    }
}
exports.equalsElement = equalsElement;
exports.MATCHER = "3d4ef194-13be-4ccf-8dc7-862eea02c93e";
function equalsAttr(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match: function (actual) {
            return expected === actual;
        },
        expected: function () {
            return "to equal " + expected;
        },
        fail: function (actual) {
            return actual + " did not equal " + expected;
        }
    };
}
exports.equalsAttr = equalsAttr;
function equals(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match: function (actual) {
            return expected === actual;
        },
        expected: function () {
            return "to equal " + expected;
        },
        fail: function (actual) {
            return actual + " did not equal " + expected;
        }
    };
}
exports.equals = equals;
function regex(r) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match: function (v) {
            return r.test(v);
        },
        expected: function () {
            return "to match " + r;
        },
        fail: function (actual) {
            return actual + " did not match " + r;
        }
    };
}
exports.regex = regex;
function classes(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match: function (actual) {
            return actual && (expected.split(' ').sort().join(' ') === actual.split(' ').sort().join(' '));
        },
        expected: function () {
            return "to include '" + expected + "'";
        },
        fail: function (actual) {
            return "'" + actual + "'' did not match '" + expected + "'";
        }
    };
}
exports.classes = classes;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW52aXJvbm1lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJAZ2xpbW1lci90ZXN0LWhlbHBlcnMvbGliL2Vudmlyb25tZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLDRDQXdEMEI7QUFFMUIscUNBR21CO0FBRW5CLHNDQVF1QjtBQUV2QiwwQ0FBc0U7QUFFdEUsZ0RBVzRCO0FBRTVCLDhEQUVtQztBQWNuQztJQUtFLHVCQUFZLEtBQWUsRUFBRSxNQUFzQjtRQUYzQyxhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBR25CLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ25CLElBQUksQ0FBQyxNQUFNLEdBQUcsTUFBTSxDQUFDO0lBQ3ZCLENBQUM7SUFFRCwrQkFBTyxHQUFQO1FBQ0UsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsQ0FBQztJQUNqQyxDQUFDO0lBRUQsNEJBQUksR0FBSjtRQUNNLElBQUEsU0FBa0MsRUFBaEMsc0JBQVEsRUFBRSxnQkFBSyxFQUFFLGtCQUFNLENBQVU7UUFFdkMsRUFBRSxDQUFDLENBQUMsUUFBUSxJQUFJLEtBQUssQ0FBQyxNQUFNLENBQUM7WUFBQyxNQUFNLENBQUMsSUFBSSxDQUFDO1FBRTFDLElBQUksS0FBSyxHQUFHLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUM1QixJQUFJLEdBQUcsR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO1FBQ2xDLElBQUksSUFBSSxHQUFHLFFBQVEsQ0FBQztRQUVwQixJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7UUFFaEIsTUFBTSxDQUFDLEVBQUUsR0FBRyxLQUFBLEVBQUUsS0FBSyxPQUFBLEVBQUUsSUFBSSxNQUFBLEVBQUUsQ0FBQztJQUM5QixDQUFDO0lBQ0gsb0JBQUM7QUFBRCxDQUFDLEFBM0JELElBMkJDO0FBRUQ7SUFNRSw0QkFBWSxJQUFjLEVBQUUsTUFBZ0IsRUFB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LENBQUM7UUFDakcsQ0FBQztRQUNELFFBQVE7WUFDTixNQUFNLENBQUMsaUJBQWUsUUFBUSxNQUFHLENBQUM7UUFDcEMsQ0FBQztRQUNELElBQUksWUFBQyxNQUFNO1lBQ1QsTUFBTSxDQUFDLE1BQUksTUFBTSwwQkFBcUIsUUFBUSxNQUFHLENBQUM7UUFDcEQsQ0FBQztLQUNGLENBQUM7QUFDSixDQUFDO0FBYkQsMEJBYUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAvLyBWTVxuICBWTSxcbiAgRHluYW1pY1Njb3BlLFxuXG4gIC8vIENvbXBpbGVyXG4gIENvbXBpbGVkUHJvZ3JhbSxcbiAgQ29tcGlsYWJsZUxheW91dCxcbiAgY29tcGlsZUxheW91dCxcbiAgY29tcGlsZUFyZ3MsXG5cbiAgLy8gRW52aXJvbm1lbnRcbiAgRW52aXJvbm1lbnQsXG4gIEhlbHBlciBhcyBHbGltbWVySGVscGVyLFxuICBNb2RpZmllck1hbmFnZXIsXG4gIERPTVRyZWVDb25zdHJ1Y3Rpb24sXG4gIERPTUNoYW5nZXMsXG4gIElET01DaGFuZ2VzLFxuXG4gIC8vIFBhcnRpYWxzXG4gIFBhcnRpYWxEZWZpbml0aW9uLFxuXG4gIC8vIENvbXBvbmVudHNcbiAgQ29tcG9uZW50LFxuICBDb21wb25lbnRNYW5hZ2VyLFxuICBDb21wb25lbnREZWZpbml0aW9uLFxuICBDb21wb25lbnRMYXlvdXRCdWlsZGVyLFxuICBDb21wb25lbnRCdWlsZGVyLFxuXG4gIC8vIFZhbHVlc1xuICBFdmFsdWF0ZWRBcmdzLFxuICBFdmFsdWF0ZWROYW1lZEFyZ3MsXG4gIEV2YWx1YXRlZFBvc2l0aW9uYWxBcmdzLFxuXG4gIC8vIFN5bnRheCBDbGFzc2VzXG4gIEJsb2NrTWFjcm9zLFxuICBJbmxpbmVNYWNyb3MsXG4gIE5lc3RlZEJsb2NrU3ludGF4LFxuICBDb21waWxlQmxvY2tNYWNybyxcbiAgQmFzZWxpbmVTeW50YXgsXG5cbiAgLy8gUmVmZXJlbmNlc1xuICBQcmltaXRpdmVSZWZlcmVuY2UsXG4gIENvbmRpdGlvbmFsUmVmZXJlbmNlLFxuXG4gIC8vIE1pc2NcbiAgQm91bmRzLFxuICBFbGVtZW50T3BlcmF0aW9ucyxcbiAgRnVuY3Rpb25FeHByZXNzaW9uLFxuICBPcGNvZGVCdWlsZGVyRFNMLFxuICBTaW1wbGUsXG4gIGdldER5bmFtaWNWYXIsXG5cbiAgVGVtcGxhdGUsXG4gIExheW91dCxcbiAgaXNDb21wb25lbnREZWZpbml0aW9uXG59IGZyb20gXCJAZ2xpbW1lci9ydW50aW1lXCI7XG5cbmltcG9ydCB7XG4gIGNvbXBpbGUgYXMgcmF3Q29tcGlsZSxcbiAgY29tcGlsZUxheW91dCBhcyByYXdDb21waWxlTGF5b3V0XG59IGZyb20gXCIuL2hlbHBlcnNcIjtcblxuaW1wb3J0IHtcbiAgRGVzdHJveWFibGUsXG4gIERpY3QsXG4gIE9wYXF1ZSxcbiAgRklYTUUsXG4gIGFzc2lnbixcbiAgZGljdCxcbiAgdW53cmFwXG59IGZyb20gJ0BnbGltbWVyL3V0aWwnO1xuXG5pbXBvcnQgR2xpbW1lck9iamVjdCwgeyBHbGltbWVyT2JqZWN0RmFjdG9yeSB9IGZyb20gXCJAZ2xpbW1lci9vYmplY3RcIjtcblxuaW1wb3J0IHtcbiAgVk9MQVRJTEVfVEFHLFxuICBEaXJ0eWFibGVUYWcsXG4gIFJldmlzaW9uVGFnLFxuICBSZWZlcmVuY2UsXG4gIFBhdGhSZWZlcmVuY2UsXG4gIE9wYXF1ZUl0ZXJhdG9yLFxuICBPcGFxdWVJdGVyYWJsZSxcbiAgQWJzdHJhY3RJdGVyYWJsZSxcbiAgSXRlcmF0aW9uSXRlbSxcbiAgaXNDb25zdFxufSBmcm9tIFwiQGdsaW1tZXIvcmVmZXJlbmNlXCI7XG5cbmltcG9ydCB7XG4gIFVwZGF0YWJsZVJlZmVyZW5jZVxufSBmcm9tIFwiQGdsaW1tZXIvb2JqZWN0LXJlZmVyZW5jZVwiO1xuXG5pbXBvcnQge1xuICBTeW1ib2xUYWJsZVxufSBmcm9tICdAZ2xpbW1lci9pbnRlcmZhY2VzJztcblxuaW1wb3J0ICogYXMgV2lyZUZvcm1hdCBmcm9tICdAZ2xpbW1lci93aXJlLWZvcm1hdCc7XG5cbmltcG9ydCB7XG4gIFRlbXBsYXRlTWV0YSxcbn0gZnJvbSBcIkBnbGltbWVyL3dpcmUtZm9ybWF0XCI7XG5cbnR5cGUgS2V5Rm9yPFQ+ID0gKGl0ZW06IE9wYXF1ZSwgaW5kZXg6IFQpID0+IHN0cmluZztcblxuY2xhc3MgQXJyYXlJdGVyYXRvciBpbXBsZW1lbnRzIE9wYXF1ZUl0ZXJhdG9yIHtcbiAgcHJpdmF0ZSBhcnJheTogT3BhcXVlW107XG4gIHByaXZhdGUga2V5Rm9yOiBLZXlGb3I8bnVtYmVyPjtcbiAgcHJpdmF0ZSBwb3NpdGlvbiA9IDA7XG5cbiAgY29uc3RydWN0b3IoYXJyYXk6IE9wYXF1ZVtdLCBrZXlGb3I6IEtleUZvcjxudW1iZXI+KSB7XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xuICAgIHRoaXMua2V5Rm9yID0ga2V5Rm9yO1xuICB9XG5cbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5hcnJheS5sZW5ndGggPT09IDA7XG4gIH1cblxuICBuZXh0KCk6IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBudW1iZXI+IHtcbiAgICBsZXQgeyBwb3NpdGlvbiwgYXJyYXksIGtleUZvciB9ID0gdGhpcztcblxuICAgIGlmIChwb3NpdGlvbiA+PSBhcnJheS5sZW5ndGgpIHJldHVybiBudWxsO1xuXG4gICAgbGV0IHZhbHVlID0gYXJyYXlbcG9zaXRpb25dO1xuICAgIGxldCBrZXkgPSBrZXlGb3IodmFsdWUsIHBvc2l0aW9uKTtcbiAgICBsZXQgbWVtbyA9IHBvc2l0aW9uO1xuXG4gICAgdGhpcy5wb3NpdGlvbisrO1xuXG4gICAgcmV0dXJuIHsga2V5LCB2YWx1ZSwgbWVtbyB9O1xuICB9XG59XG5cbmNsYXNzIE9iamVjdEtleXNJdGVyYXRvciBpbXBsZW1lbnRzIE9wYXF1ZUl0ZXJhdG9yIHtcbiAgcHJpdmF0ZSBrZXlzOiBzdHJpbmdbXTtcbiAgcHJpdmF0ZSB2YWx1ZXM6IE9wYXF1ZVtdO1xuICBwcml2YXRlIGtleUZvcjogS2V5Rm9yPHN0cmluZz47XG4gIHByaXZhdGUgcG9zaXRpb24gPSAwO1xuXG4gIGNvbnN0cnVjdG9yKGtleXM6IHN0cmluZ1tdLCB2YWx1ZXM6IE9wYXF1ZVtdLCBrZXlGb3I6IEtleUZvcjxzdHJpbmc+KSB7XG4gICAgdGhpcy5rZXlzID0ga2V5cztcbiAgICB0aGlzLnZhbHVlcyA9IHZhbHVlcztcbiAgICB0aGlzLmtleUZvciA9IGtleUZvcjtcbiAgfVxuXG4gIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMua2V5cy5sZW5ndGggPT09IDA7XG4gIH1cblxuICBuZXh0KCk6IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBzdHJpbmc+IHtcbiAgICBsZXQgeyBwb3NpdGlvbiwga2V5cywgdmFsdWVzLCBrZXlGb3IgfSA9IHRoaXM7XG5cbiAgICBpZiAocG9zaXRpb24gPj0ga2V5cy5sZW5ndGgpIHJldHVybiBudWxsO1xuXG4gICAgbGV0IHZhbHVlID0gdmFsdWVzW3Bvc2l0aW9uXTtcbiAgICBsZXQgbWVtbyA9IGtleXNbcG9zaXRpb25dO1xuICAgIGxldCBrZXkgPSBrZXlGb3IodmFsdWUsIG1lbW8pO1xuXG4gICAgdGhpcy5wb3NpdGlvbisrO1xuXG4gICAgcmV0dXJuIHsga2V5LCB2YWx1ZSwgbWVtbyB9O1xuICB9XG59XG5cbmNsYXNzIEVtcHR5SXRlcmF0b3IgaW1wbGVtZW50cyBPcGFxdWVJdGVyYXRvciB7XG4gIGlzRW1wdHkoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxuICBuZXh0KCk6IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBPcGFxdWU+IHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBjYWxsIG5leHQoKSBvbiBhbiBlbXB0eSBpdGVyYXRvcmApO1xuICB9XG59XG5cbmNvbnN0IEVNUFRZX0lURVJBVE9SID0gbmV3IEVtcHR5SXRlcmF0b3IoKTtcblxuY2xhc3MgSXRlcmFibGUgaW1wbGVtZW50cyBBYnN0cmFjdEl0ZXJhYmxlPE9wYXF1ZSwgT3BhcXVlLCBJdGVyYXRpb25JdGVtPE9wYXF1ZSwgT3BhcXVlPiwgVXBkYXRhYmxlUmVmZXJlbmNlPE9wYXF1ZT4sIFVwZGF0YWJsZVJlZmVyZW5jZTxPcGFxdWU+PiB7XG4gIHB1YmxpYyB0YWc6IFJldmlzaW9uVGFnO1xuICBwcml2YXRlIHJlZjogUmVmZXJlbmNlPE9wYXF1ZT47XG4gIHByaXZhdGUga2V5Rm9yOiBLZXlGb3I8T3BhcXVlPjtcblxuICBjb25zdHJ1Y3RvcihyZWY6IFJlZmVyZW5jZTxPcGFxdWU+LCBrZXlGb3I6IEtleUZvcjxPcGFxdWU+KSB7XG4gICAgdGhpcy50YWcgPSByZWYudGFnO1xuICAgIHRoaXMucmVmID0gcmVmO1xuICAgIHRoaXMua2V5Rm9yID0ga2V5Rm9yO1xuICB9XG5cbiAgaXRlcmF0ZSgpOiBPcGFxdWVJdGVyYXRvciB7XG4gICAgbGV0IHsgcmVmLCBrZXlGb3IgfSA9IHRoaXM7XG5cbiAgICBsZXQgaXRlcmFibGUgPSByZWYudmFsdWUoKSBhcyBhbnk7XG5cbiAgICBpZiAoQXJyYXkuaXNBcnJheShpdGVyYWJsZSkpIHtcbiAgICAgIHJldHVybiBpdGVyYWJsZS5sZW5ndGggPiAwID8gbmV3IEFycmF5SXRlcmF0b3IoaXRlcmFibGUsIGtleUZvcikgOiBFTVBUWV9JVEVSQVRPUjtcbiAgICB9IGVsc2UgaWYgKGl0ZXJhYmxlID09PSB1bmRlZmluZWQgfHwgaXRlcmFibGUgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBFTVBUWV9JVEVSQVRPUjtcbiAgICB9IGVsc2UgaWYgKGl0ZXJhYmxlLmZvckVhY2ggIT09IHVuZGVmaW5lZCkge1xuICAgICAgbGV0IGFycmF5ID0gW107XG4gICAgICBpdGVyYWJsZS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgICAgYXJyYXkucHVzaChpdGVtKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFycmF5Lmxlbmd0aCA+IDAgPyBuZXcgQXJyYXlJdGVyYXRvcihhcnJheSwga2V5Rm9yKSA6IEVNUFRZX0lURVJBVE9SO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGl0ZXJhYmxlID09PSAnb2JqZWN0Jykge1xuICAgICAgIGxldCBrZXlzID0gT2JqZWN0LmtleXMoaXRlcmFibGUpO1xuICAgICAgIHJldHVybiBrZXlzLmxlbmd0aCA+IDAgPyBuZXcgT2JqZWN0S2V5c0l0ZXJhdG9yKGtleXMsIGtleXMubWFwKGtleSA9PiBpdGVyYWJsZVtrZXldKSwga2V5Rm9yKSA6IEVNUFRZX0lURVJBVE9SO1xuICAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBEb24ndCBrbm93IGhvdyB0byB7eyNlYWNoICR7aXRlcmFibGV9fX1gKTtcbiAgICB9XG4gIH1cblxuICB2YWx1ZVJlZmVyZW5jZUZvcihpdGVtOiBJdGVyYXRpb25JdGVtPE9wYXF1ZSwgT3BhcXVlPik6IFVwZGF0YWJsZVJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShpdGVtLnZhbHVlKTtcbiAgfVxuXG4gIHVwZGF0ZVZhbHVlUmVmZXJlbmNlKHJlZmVyZW5jZTogVXBkYXRhYmxlUmVmZXJlbmNlPE9wYXF1ZT4sIGl0ZW06IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBPcGFxdWU+KSB7XG4gICAgcmVmZXJlbmNlLnVwZGF0ZShpdGVtLnZhbHVlKTtcbiAgfVxuXG4gIG1lbW9SZWZlcmVuY2VGb3IoaXRlbTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIE9wYXF1ZT4pOiBVcGRhdGFibGVSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgcmV0dXJuIG5ldyBVcGRhdGFibGVSZWZlcmVuY2UoaXRlbS5tZW1vKTtcbiAgfVxuXG4gIHVwZGF0ZU1lbW9SZWZlcmVuY2UocmVmZXJlbmNlOiBVcGRhdGFibGVSZWZlcmVuY2U8T3BhcXVlPiwgaXRlbTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIE9wYXF1ZT4pIHtcbiAgICByZWZlcmVuY2UudXBkYXRlKGl0ZW0ubWVtbyk7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgQXR0cnMgPSBEaWN0PGFueT47XG5leHBvcnQgdHlwZSBBdHRyc0RpZmYgPSB7IG9sZEF0dHJzOiBBdHRycywgbmV3QXR0cnM6IEF0dHJzIH07XG5cbmV4cG9ydCBjbGFzcyBCYXNpY0NvbXBvbmVudCB7XG4gIHB1YmxpYyBhdHRyczogQXR0cnM7XG4gIHB1YmxpYyBlbGVtZW50OiBFbGVtZW50O1xuICBwdWJsaWMgYm91bmRzOiBCb3VuZHM7XG5cbiAgY29uc3RydWN0b3IoYXR0cnM6IEF0dHJzKSB7XG4gICAgdGhpcy5hdHRycyA9IGF0dHJzO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50IGV4dGVuZHMgR2xpbW1lck9iamVjdCB7XG4gIHB1YmxpYyBkaXJ0aW5lc3NUYWcgPSBuZXcgRGlydHlhYmxlVGFnKCk7XG4gIHB1YmxpYyB0YWdOYW1lOiBzdHJpbmcgPSBudWxsO1xuICBwdWJsaWMgYXR0cmlidXRlQmluZGluZ3M6IHN0cmluZ1tdID0gbnVsbDtcbiAgcHVibGljIGF0dHJzOiBBdHRycztcbiAgcHVibGljIGVsZW1lbnQ6IEVsZW1lbnQ7XG4gIHB1YmxpYyBib3VuZHM6IEJvdW5kcztcbiAgcHVibGljIHBhcmVudFZpZXc6IENvbXBvbmVudCA9IG51bGw7XG4gIHB1YmxpYyBhcmdzOiBQcm9jZXNzZWRBcmdzO1xuXG4gIHN0YXRpYyBjcmVhdGUoYXJnczogeyBhdHRyczogQXR0cnMgfSk6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQge1xuICAgIHJldHVybiBzdXBlci5jcmVhdGUoYXJncykgYXMgRW1iZXJpc2hDdXJseUNvbXBvbmVudDtcbiAgfVxuXG4gIHJlY29tcHV0ZSgpIHtcbiAgICB0aGlzLmRpcnRpbmVzc1RhZy5kaXJ0eSgpO1xuICB9XG5cbiAgZGlkSW5pdEF0dHJzKG9wdGlvbnMgOiB7IGF0dHJzIDogQXR0cnMgfSkge31cbiAgZGlkVXBkYXRlQXR0cnMoZGlmZiA6IEF0dHJzRGlmZikge31cbiAgZGlkUmVjZWl2ZUF0dHJzKGRpZmYgOiBBdHRyc0RpZmYpIHt9XG4gIHdpbGxJbnNlcnRFbGVtZW50KCkge31cbiAgd2lsbFVwZGF0ZSgpIHt9XG4gIHdpbGxSZW5kZXIoKSB7fVxuICBkaWRJbnNlcnRFbGVtZW50KCkge31cbiAgZGlkVXBkYXRlKCkge31cbiAgZGlkUmVuZGVyKCkge31cbn1cblxuZXhwb3J0IGNsYXNzIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCBleHRlbmRzIEdsaW1tZXJPYmplY3Qge1xuICBwdWJsaWMgZGlydGluZXNzVGFnID0gbmV3IERpcnR5YWJsZVRhZygpO1xuICBwdWJsaWMgYXR0cnM6IEF0dHJzO1xuICBwdWJsaWMgZWxlbWVudDogRWxlbWVudDtcbiAgcHVibGljIGJvdW5kczogQm91bmRzO1xuICBwdWJsaWMgcGFyZW50VmlldzogQ29tcG9uZW50ID0gbnVsbDtcblxuICBzdGF0aWMgY3JlYXRlKGFyZ3M6IHsgYXR0cnM6IEF0dHJzIH0pOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQge1xuICAgIHJldHVybiBzdXBlci5jcmVhdGUoYXJncykgYXMgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50O1xuICB9XG5cbiAgcmVjb21wdXRlKCkge1xuICAgIHRoaXMuZGlydGluZXNzVGFnLmRpcnR5KCk7XG4gIH1cblxuICBkaWRJbml0QXR0cnMob3B0aW9ucyA6IHsgYXR0cnMgOiBBdHRycyB9KSB7fVxuICBkaWRVcGRhdGVBdHRycyhkaWZmIDogQXR0cnNEaWZmKSB7fVxuICBkaWRSZWNlaXZlQXR0cnMoZGlmZiA6IEF0dHJzRGlmZikge31cbiAgd2lsbEluc2VydEVsZW1lbnQoKSB7fVxuICB3aWxsVXBkYXRlKCkge31cbiAgd2lsbFJlbmRlcigpIHt9XG4gIGRpZEluc2VydEVsZW1lbnQoKSB7fVxuICBkaWRVcGRhdGUoKSB7fVxuICBkaWRSZW5kZXIoKSB7fVxufVxuXG5jbGFzcyBCYXNpY0NvbXBvbmVudE1hbmFnZXIgaW1wbGVtZW50cyBDb21wb25lbnRNYW5hZ2VyPEJhc2ljQ29tcG9uZW50PiB7XG4gIHByZXBhcmVBcmdzKGRlZmluaXRpb246IEJhc2ljQ29tcG9uZW50RGVmaW5pdGlvbiwgYXJnczogRXZhbHVhdGVkQXJncyk6IEV2YWx1YXRlZEFyZ3Mge1xuICAgIHJldHVybiBhcmdzO1xuICB9XG5cbiAgY3JlYXRlKGVudmlyb25tZW50OiBFbnZpcm9ubWVudCwgZGVmaW5pdGlvbjogQmFzaWNDb21wb25lbnREZWZpbml0aW9uLCBhcmdzOiBFdmFsdWF0ZWRBcmdzKTogQmFzaWNDb21wb25lbnQge1xuICAgIGxldCBrbGFzcyA9IGRlZmluaXRpb24uQ29tcG9uZW50Q2xhc3MgfHwgQmFzaWNDb21wb25lbnQ7XG4gICAgcmV0dXJuIG5ldyBrbGFzcyhhcmdzLm5hbWVkLnZhbHVlKCkpO1xuICB9XG5cbiAgbGF5b3V0Rm9yKGRlZmluaXRpb246IEJhc2ljQ29tcG9uZW50RGVmaW5pdGlvbiwgY29tcG9uZW50OiBCYXNpY0NvbXBvbmVudCwgZW52OiBUZXN0RW52aXJvbm1lbnQpOiBDb21waWxlZFByb2dyYW0ge1xuICAgIGxldCBsYXlvdXQgPSBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV07XG5cbiAgICBpZiAobGF5b3V0KSB7XG4gICAgICByZXR1cm4gbGF5b3V0O1xuICAgIH1cblxuICAgIHJldHVybiBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV0gPSBjb21waWxlTGF5b3V0KG5ldyBCYXNpY0NvbXBvbmVudExheW91dENvbXBpbGVyKGRlZmluaXRpb24ubGF5b3V0U3RyaW5nKSwgZW52KTtcbiAgfVxuXG4gIGdldFNlbGYoY29tcG9uZW50OiBCYXNpY0NvbXBvbmVudCk6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgcmV0dXJuIG5ldyBVcGRhdGFibGVSZWZlcmVuY2UoY29tcG9uZW50KTtcbiAgfVxuXG4gIGRpZENyZWF0ZUVsZW1lbnQoY29tcG9uZW50OiBCYXNpY0NvbXBvbmVudCwgZWxlbWVudDogRWxlbWVudCkge1xuICAgIGNvbXBvbmVudC5lbGVtZW50ID0gZWxlbWVudDtcbiAgfVxuXG4gIGRpZFJlbmRlckxheW91dChjb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50LCBib3VuZHM6IEJvdW5kcykge1xuICAgIGNvbXBvbmVudC5ib3VuZHMgPSBib3VuZHM7XG4gIH1cblxuICBkaWRDcmVhdGUoKSB7fVxuXG4gIGdldFRhZygpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHVwZGF0ZShjb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50LCBhdHRyczogRXZhbHVhdGVkQXJncykge1xuICAgIGNvbXBvbmVudC5hdHRycyA9IGF0dHJzLm5hbWVkLnZhbHVlKCk7XG4gIH1cblxuICBkaWRVcGRhdGVMYXlvdXQoKSB7fVxuXG4gIGRpZFVwZGF0ZSgpIHt9XG5cbiAgZ2V0RGVzdHJ1Y3RvcigpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5jb25zdCBCQVNJQ19DT01QT05FTlRfTUFOQUdFUiA9IG5ldyBCYXNpY0NvbXBvbmVudE1hbmFnZXIoKTtcblxuY2xhc3MgU3RhdGljVGFnbGVzc0NvbXBvbmVudE1hbmFnZXIgZXh0ZW5kcyBCYXNpY0NvbXBvbmVudE1hbmFnZXIge1xuICBsYXlvdXRGb3IoZGVmaW5pdGlvbjogU3RhdGljVGFnbGVzc0NvbXBvbmVudERlZmluaXRpb24sIGNvbXBvbmVudDogQmFzaWNDb21wb25lbnQsIGVudjogVGVzdEVudmlyb25tZW50KTogQ29tcGlsZWRQcm9ncmFtIHtcbiAgICBsZXQgbGF5b3V0ID0gZW52LmNvbXBpbGVkTGF5b3V0c1tkZWZpbml0aW9uLm5hbWVdO1xuXG4gICAgaWYgKGxheW91dCkge1xuICAgICAgcmV0dXJuIGxheW91dDtcbiAgICB9XG5cbiAgICByZXR1cm4gZW52LmNvbXBpbGVkTGF5b3V0c1tkZWZpbml0aW9uLm5hbWVdID0gY29tcGlsZUxheW91dChuZXcgU3RhdGljVGFnbGVzc0NvbXBvbmVudExheW91dENvbXBpbGVyKGRlZmluaXRpb24ubGF5b3V0U3RyaW5nKSwgZW52KTtcbiAgfVxufVxuXG5jb25zdCBTVEFUSUNfVEFHTEVTU19DT01QT05FTlRfTUFOQUdFUiA9IG5ldyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50TWFuYWdlcigpO1xuXG5jb25zdCBCYXNlRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50ID0gRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50LmV4dGVuZCgpIGFzIHR5cGVvZiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQ7XG5cbmNsYXNzIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudE1hbmFnZXIgaW1wbGVtZW50cyBDb21wb25lbnRNYW5hZ2VyPEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudD4ge1xuICBwcmVwYXJlQXJncyhkZWZpbml0aW9uOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnREZWZpbml0aW9uLCBhcmdzOiBFdmFsdWF0ZWRBcmdzKTogRXZhbHVhdGVkQXJncyB7XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICBjcmVhdGUoZW52aXJvbm1lbnQ6IEVudmlyb25tZW50LCBkZWZpbml0aW9uOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnREZWZpbml0aW9uLCBhcmdzOiBFdmFsdWF0ZWRBcmdzLCBkeW5hbWljU2NvcGUsIGNhbGxlclNlbGY6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiwgaGFzRGVmYXVsdEJsb2NrOiBib29sZWFuKTogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50IHtcbiAgICBsZXQga2xhc3MgPSBkZWZpbml0aW9uLkNvbXBvbmVudENsYXNzIHx8IEJhc2VFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQ7XG4gICAgbGV0IGF0dHJzID0gYXJncy5uYW1lZC52YWx1ZSgpO1xuICAgIGxldCBjb21wb25lbnQgPSBrbGFzcy5jcmVhdGUoeyBhdHRycyB9KTtcblxuICAgIGNvbXBvbmVudC5kaWRJbml0QXR0cnMoeyBhdHRycyB9KTtcbiAgICBjb21wb25lbnQuZGlkUmVjZWl2ZUF0dHJzKHsgb2xkQXR0cnM6IG51bGwsIG5ld0F0dHJzOiBhdHRycyB9KTtcbiAgICBjb21wb25lbnQud2lsbEluc2VydEVsZW1lbnQoKTtcbiAgICBjb21wb25lbnQud2lsbFJlbmRlcigpO1xuXG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxuXG4gIGxheW91dEZvcihkZWZpbml0aW9uOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnREZWZpbml0aW9uLCBjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCwgZW52OiBUZXN0RW52aXJvbm1lbnQpOiBDb21waWxlZFByb2dyYW0ge1xuICAgIGlmIChlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV0pIHtcbiAgICAgIHJldHVybiBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV07XG4gICAgfVxuICAgIHJldHVybiBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV0gPSBjb21waWxlTGF5b3V0KG5ldyBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnRMYXlvdXRDb21waWxlcihkZWZpbml0aW9uLmxheW91dFN0cmluZyksIGVudik7XG4gIH1cblxuICBnZXRTZWxmKGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShjb21wb25lbnQpO1xuICB9XG5cbiAgZGlkQ3JlYXRlRWxlbWVudChjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCwgZWxlbWVudDogRWxlbWVudCkge1xuICAgIGNvbXBvbmVudC5lbGVtZW50ID0gZWxlbWVudDtcbiAgfVxuXG4gIGRpZFJlbmRlckxheW91dChjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCwgYm91bmRzOiBCb3VuZHMpIHtcbiAgICBjb21wb25lbnQuYm91bmRzID0gYm91bmRzO1xuICB9XG5cbiAgZGlkQ3JlYXRlKGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KSB7XG4gICAgY29tcG9uZW50LmRpZEluc2VydEVsZW1lbnQoKTtcbiAgICBjb21wb25lbnQuZGlkUmVuZGVyKCk7XG4gIH1cblxuICBnZXRUYWcoY29tcG9uZW50OiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQpIHtcbiAgICByZXR1cm4gY29tcG9uZW50LmRpcnRpbmVzc1RhZztcbiAgfVxuXG4gIHVwZGF0ZShjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCwgYXJnczogRXZhbHVhdGVkQXJncykge1xuICAgIGxldCBvbGRBdHRycyA9IGNvbXBvbmVudC5hdHRycztcbiAgICBsZXQgbmV3QXR0cnMgPSBhcmdzLm5hbWVkLnZhbHVlKCk7XG5cbiAgICBjb21wb25lbnQuc2V0KCdhdHRycycsIG5ld0F0dHJzKTtcbiAgICBjb21wb25lbnQuZGlkVXBkYXRlQXR0cnMoeyBvbGRBdHRycywgbmV3QXR0cnMgfSk7XG4gICAgY29tcG9uZW50LmRpZFJlY2VpdmVBdHRycyh7IG9sZEF0dHJzLCBuZXdBdHRycyB9KTtcbiAgICBjb21wb25lbnQud2lsbFVwZGF0ZSgpO1xuICAgIGNvbXBvbmVudC53aWxsUmVuZGVyKCk7XG4gIH1cblxuICBkaWRVcGRhdGVMYXlvdXQoKSB7fVxuXG4gIGRpZFVwZGF0ZShjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCkge1xuICAgIGNvbXBvbmVudC5kaWRVcGRhdGUoKTtcbiAgICBjb21wb25lbnQuZGlkUmVuZGVyKCk7XG4gIH1cblxuICBnZXREZXN0cnVjdG9yKGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KTogRGVzdHJveWFibGUge1xuICAgIHJldHVybiB7XG4gICAgICBkZXN0cm95KCkge1xuICAgICAgICBjb21wb25lbnQuZGVzdHJveSgpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFByb2Nlc3NlZEFyZ3Mge1xuICB0YWc6IFJldmlzaW9uVGFnO1xuICBuYW1lZDogRXZhbHVhdGVkTmFtZWRBcmdzO1xuICBwb3NpdGlvbmFsOiBFdmFsdWF0ZWRQb3NpdGlvbmFsQXJncztcbiAgcG9zaXRpb25hbFBhcmFtTmFtZXM6IEFycmF5PHN0cmluZz47XG5cbiAgY29uc3RydWN0b3IoYXJnczogRXZhbHVhdGVkQXJncywgcG9zaXRpb25hbFBhcmFtc0RlZmluaXRpb246IHN0cmluZ1tdKSB7XG4gICAgdGhpcy50YWcgPSBhcmdzLnRhZztcbiAgICB0aGlzLm5hbWVkID0gYXJncy5uYW1lZDtcbiAgICB0aGlzLnBvc2l0aW9uYWwgPSBhcmdzLnBvc2l0aW9uYWw7XG4gICAgdGhpcy5wb3NpdGlvbmFsUGFyYW1OYW1lcyA9IHBvc2l0aW9uYWxQYXJhbXNEZWZpbml0aW9uO1xuICB9XG5cbiAgdmFsdWUoKSB7XG4gICAgbGV0IHsgbmFtZWQsIHBvc2l0aW9uYWwsIHBvc2l0aW9uYWxQYXJhbU5hbWVzIH0gPSB0aGlzO1xuXG4gICAgbGV0IG1lcmdlZCA9IE9iamVjdC5hc3NpZ24oe30sIG5hbWVkLnZhbHVlKCkpO1xuXG4gICAgaWYgKHBvc2l0aW9uYWxQYXJhbU5hbWVzICYmIHBvc2l0aW9uYWxQYXJhbU5hbWVzLmxlbmd0aCkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwb3NpdGlvbmFsUGFyYW1OYW1lcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBsZXQgbmFtZSA9IHBvc2l0aW9uYWxQYXJhbU5hbWVzW2ldO1xuICAgICAgICBsZXQgcmVmZXJlbmNlID0gcG9zaXRpb25hbC5hdChpKTtcblxuICAgICAgICBtZXJnZWRbbmFtZV0gPSByZWZlcmVuY2UudmFsdWUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgYXR0cnM6IG1lcmdlZCxcbiAgICAgIHByb3BzOiBtZXJnZWRcbiAgICB9O1xuICB9XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NBcmdzKGFyZ3M6IEV2YWx1YXRlZEFyZ3MsIHBvc2l0aW9uYWxQYXJhbXNEZWZpbml0aW9uOiBzdHJpbmdbXSkgOiBQcm9jZXNzZWRBcmdzIHtcbiAgcmV0dXJuIG5ldyBQcm9jZXNzZWRBcmdzKGFyZ3MsIHBvc2l0aW9uYWxQYXJhbXNEZWZpbml0aW9uKTtcbn1cblxuY29uc3QgRU1CRVJJU0hfR0xJTU1FUl9DT01QT05FTlRfTUFOQUdFUiA9IG5ldyBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnRNYW5hZ2VyKCk7XG5cbmNvbnN0IEJhc2VFbWJlcmlzaEN1cmx5Q29tcG9uZW50ID0gRW1iZXJpc2hDdXJseUNvbXBvbmVudC5leHRlbmQoKSBhcyB0eXBlb2YgRW1iZXJpc2hDdXJseUNvbXBvbmVudDtcblxuY2xhc3MgRW1iZXJpc2hDdXJseUNvbXBvbmVudE1hbmFnZXIgaW1wbGVtZW50cyBDb21wb25lbnRNYW5hZ2VyPEVtYmVyaXNoQ3VybHlDb21wb25lbnQ+IHtcbiAgcHJlcGFyZUFyZ3MoZGVmaW5pdGlvbjogRW1iZXJpc2hDdXJseUNvbXBvbmVudERlZmluaXRpb24sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MsIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlKTogRXZhbHVhdGVkQXJncyB7XG4gICAgbGV0IGR5biA9IGRlZmluaXRpb24uQ29tcG9uZW50Q2xhc3MgPyBkZWZpbml0aW9uLkNvbXBvbmVudENsYXNzWydmcm9tRHluYW1pY1Njb3BlJ10gOiBudWxsO1xuICAgIGlmIChkeW4pIHtcbiAgICAgIGxldCBtYXAgPSBhc3NpZ24oe30sIGFyZ3MubmFtZWQubWFwKTtcbiAgICAgIGR5bi5mb3JFYWNoKG5hbWUgPT4gbWFwW25hbWVdID0gZHluYW1pY1Njb3BlLmdldChuYW1lKSk7XG4gICAgICBhcmdzID0gRXZhbHVhdGVkQXJncy5jcmVhdGUoYXJncy5wb3NpdGlvbmFsLCBFdmFsdWF0ZWROYW1lZEFyZ3MuY3JlYXRlKG1hcCksIGFyZ3MuYmxvY2tzKTtcbiAgICB9XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICBjcmVhdGUoZW52aXJvbm1lbnQ6IEVudmlyb25tZW50LCBkZWZpbml0aW9uOiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50RGVmaW5pdGlvbiwgYXJnczogRXZhbHVhdGVkQXJncywgZHluYW1pY1Njb3BlOiBEeW5hbWljU2NvcGUsIGNhbGxlclNlbGY6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPik6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQge1xuICAgIGxldCBrbGFzcyA9IGRlZmluaXRpb24uQ29tcG9uZW50Q2xhc3MgfHwgQmFzZUVtYmVyaXNoQ3VybHlDb21wb25lbnQ7XG4gICAgbGV0IHByb2Nlc3NlZEFyZ3MgPSBwcm9jZXNzQXJncyhhcmdzLCBrbGFzc1sncG9zaXRpb25hbFBhcmFtcyddKTtcbiAgICBsZXQgeyBhdHRycyB9ID0gcHJvY2Vzc2VkQXJncy52YWx1ZSgpO1xuICAgIGxldCBzZWxmID0gY2FsbGVyU2VsZi52YWx1ZSgpO1xuICAgIGxldCBtZXJnZWQgPSBhc3NpZ24oe30sIGF0dHJzLCB7IGF0dHJzIH0sIHsgYXJnczogcHJvY2Vzc2VkQXJncyB9LCB7IHRhcmdldE9iamVjdDogc2VsZiB9KTtcbiAgICBsZXQgY29tcG9uZW50ID0ga2xhc3MuY3JlYXRlKG1lcmdlZCk7XG5cbiAgICBjb21wb25lbnQuZGlkSW5pdEF0dHJzKHsgYXR0cnMgfSk7XG4gICAgY29tcG9uZW50LmRpZFJlY2VpdmVBdHRycyh7IG9sZEF0dHJzOiBudWxsLCBuZXdBdHRyczogYXR0cnMgfSk7XG4gICAgY29tcG9uZW50LndpbGxJbnNlcnRFbGVtZW50KCk7XG4gICAgY29tcG9uZW50LndpbGxSZW5kZXIoKTtcblxuICAgIHJldHVybiBjb21wb25lbnQ7XG4gIH1cblxuICBsYXlvdXRGb3IoZGVmaW5pdGlvbjogRW1iZXJpc2hDdXJseUNvbXBvbmVudERlZmluaXRpb24sIGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCwgZW52OiBUZXN0RW52aXJvbm1lbnQpOiBDb21waWxlZFByb2dyYW0ge1xuICAgIGxldCBsYXlvdXQgPSBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV07XG5cbiAgICBpZiAobGF5b3V0KSB7XG4gICAgICByZXR1cm4gbGF5b3V0O1xuICAgIH1cblxuICAgIGxldCBsYXlvdXRTdHJpbmcgPSBkZWZpbml0aW9uLmxheW91dFN0cmluZztcbiAgICBsZXQgbGF0ZUJvdW5kID0gIWxheW91dFN0cmluZztcblxuICAgIGlmICghbGF5b3V0U3RyaW5nICYmIGxheW91dFN0cmluZyAhPT0gJycpIHtcbiAgICAgIGxheW91dFN0cmluZyA9IGNvbXBvbmVudFsnbGF5b3V0J107XG4gICAgfVxuXG4gICAgbGF5b3V0ID0gY29tcGlsZUxheW91dChuZXcgRW1iZXJpc2hDdXJseUNvbXBvbmVudExheW91dENvbXBpbGVyKGxheW91dFN0cmluZyksIGVudik7XG5cbiAgICByZXR1cm4gbGF0ZUJvdW5kID8gbGF5b3V0IDogKGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXSA9IGxheW91dCk7XG4gIH1cblxuICBnZXRTZWxmKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCk6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgcmV0dXJuIG5ldyBVcGRhdGFibGVSZWZlcmVuY2UoY29tcG9uZW50KTtcbiAgfVxuXG4gIGRpZENyZWF0ZUVsZW1lbnQoY29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50LCBlbGVtZW50OiBFbGVtZW50LCBvcGVyYXRpb25zOiBFbGVtZW50T3BlcmF0aW9ucykge1xuICAgIGNvbXBvbmVudC5lbGVtZW50ID0gZWxlbWVudDtcblxuICAgIGxldCBiaW5kaW5ncyA9IGNvbXBvbmVudC5hdHRyaWJ1dGVCaW5kaW5ncztcbiAgICBsZXQgcm9vdFJlZiA9IG5ldyBVcGRhdGFibGVSZWZlcmVuY2UoY29tcG9uZW50KTtcblxuICAgIGlmIChiaW5kaW5ncykge1xuICAgICAgZm9yIChsZXQgaT0wOyBpPGJpbmRpbmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBhdHRyaWJ1dGUgPSBiaW5kaW5nc1tpXTtcbiAgICAgICAgbGV0IHJlZmVyZW5jZSA9IHJvb3RSZWYuZ2V0KGF0dHJpYnV0ZSkgYXMgUGF0aFJlZmVyZW5jZTxzdHJpbmc+O1xuXG4gICAgICAgIG9wZXJhdGlvbnMuYWRkRHluYW1pY0F0dHJpYnV0ZShlbGVtZW50LCBhdHRyaWJ1dGUsIHJlZmVyZW5jZSwgZmFsc2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGRpZFJlbmRlckxheW91dChjb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQsIGJvdW5kczogQm91bmRzKSB7XG4gICAgY29tcG9uZW50LmJvdW5kcyA9IGJvdW5kcztcbiAgfVxuXG4gIGRpZENyZWF0ZShjb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQpIHtcbiAgICBjb21wb25lbnQuZGlkSW5zZXJ0RWxlbWVudCgpO1xuICAgIGNvbXBvbmVudC5kaWRSZW5kZXIoKTtcbiAgfVxuXG4gIGdldFRhZyhjb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQpIHtcbiAgICByZXR1cm4gY29tcG9uZW50LmRpcnRpbmVzc1RhZztcbiAgfVxuXG4gIHVwZGF0ZShjb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQsIGFyZ3M6IEV2YWx1YXRlZEFyZ3MpIHtcbiAgICBsZXQgb2xkQXR0cnMgPSBjb21wb25lbnQuYXR0cnM7XG4gICAgbGV0IG5ld0F0dHJzID0gY29tcG9uZW50LmFyZ3MudmFsdWUoKS5hdHRycztcbiAgICBsZXQgbWVyZ2VkID0gYXNzaWduKHt9LCBuZXdBdHRycywgeyBhdHRyczogbmV3QXR0cnMgfSk7XG5cbiAgICBjb21wb25lbnQuc2V0UHJvcGVydGllcyhtZXJnZWQpO1xuICAgIGNvbXBvbmVudC5kaWRVcGRhdGVBdHRycyh7IG9sZEF0dHJzLCBuZXdBdHRycyB9KTtcbiAgICBjb21wb25lbnQuZGlkUmVjZWl2ZUF0dHJzKHsgb2xkQXR0cnMsIG5ld0F0dHJzIH0pO1xuICAgIGNvbXBvbmVudC53aWxsVXBkYXRlKCk7XG4gICAgY29tcG9uZW50LndpbGxSZW5kZXIoKTtcbiAgfVxuXG4gIGRpZFVwZGF0ZUxheW91dCgpIHt9XG5cbiAgZGlkVXBkYXRlKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCkge1xuICAgIGNvbXBvbmVudC5kaWRVcGRhdGUoKTtcbiAgICBjb21wb25lbnQuZGlkUmVuZGVyKCk7XG4gIH1cblxuICBnZXREZXN0cnVjdG9yKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCk6IERlc3Ryb3lhYmxlIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGVzdHJveSAoKSB7XG4gICAgICAgIGNvbXBvbmVudC5kZXN0cm95KCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuXG5jb25zdCBFTUJFUklTSF9DVVJMWV9DT01QT05FTlRfTUFOQUdFUiA9IG5ldyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50TWFuYWdlcigpO1xuXG5mdW5jdGlvbiBlbWJlclRvQm9vbCh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPiAwO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiAhIXZhbHVlO1xuICB9XG59XG5cbmNsYXNzIEVtYmVyaXNoQ29uZGl0aW9uYWxSZWZlcmVuY2UgZXh0ZW5kcyBDb25kaXRpb25hbFJlZmVyZW5jZSB7XG4gIHByb3RlY3RlZCB0b0Jvb2wodmFsdWU6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBlbWJlclRvQm9vbCh2YWx1ZSk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNpbXBsZVBhdGhSZWZlcmVuY2U8VD4gaW1wbGVtZW50cyBQYXRoUmVmZXJlbmNlPFQ+IHtcbiAgcHJpdmF0ZSBwYXJlbnQ6IFJlZmVyZW5jZTxUPjtcbiAgcHJpdmF0ZSBwcm9wZXJ0eTogc3RyaW5nO1xuICBwdWJsaWMgdGFnID0gVk9MQVRJTEVfVEFHO1xuXG4gIGNvbnN0cnVjdG9yKHBhcmVudDogUmVmZXJlbmNlPFQ+LCBwcm9wZXJ0eTogc3RyaW5nKSB7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnQ7XG4gICAgdGhpcy5wcm9wZXJ0eSA9IHByb3BlcnR5O1xuICB9XG5cbiAgdmFsdWUoKTogVCB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50LnZhbHVlKClbdGhpcy5wcm9wZXJ0eV07XG4gIH1cblxuICBnZXQocHJvcDogc3RyaW5nKTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFNpbXBsZVBhdGhSZWZlcmVuY2UodGhpcywgcHJvcCk7XG4gIH1cbn1cblxuZXhwb3J0IHR5cGUgVXNlckhlbHBlciA9IChhcmdzOiBSZWFkb25seUFycmF5PE9wYXF1ZT4sIG5hbWVkOiBEaWN0PE9wYXF1ZT4pID0+IGFueTtcblxuY2xhc3MgSGVscGVyUmVmZXJlbmNlIGltcGxlbWVudHMgUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgcHJpdmF0ZSBoZWxwZXI6IFVzZXJIZWxwZXI7XG4gIHByaXZhdGUgYXJnczogRXZhbHVhdGVkQXJncztcbiAgcHVibGljIHRhZyA9IFZPTEFUSUxFX1RBRztcblxuICBjb25zdHJ1Y3RvcihoZWxwZXI6IFVzZXJIZWxwZXIsIGFyZ3M6IEV2YWx1YXRlZEFyZ3MpIHtcbiAgICB0aGlzLmhlbHBlciA9IGhlbHBlcjtcbiAgICB0aGlzLmFyZ3MgPSBhcmdzO1xuICB9XG5cbiAgdmFsdWUoKSB7XG4gICAgbGV0IHsgaGVscGVyLCBhcmdzOiB7IHBvc2l0aW9uYWwsIG5hbWVkIH0gfSA9IHRoaXM7XG5cbiAgICByZXR1cm4gaGVscGVyKHBvc2l0aW9uYWwudmFsdWUoKSwgbmFtZWQudmFsdWUoKSk7XG4gIH1cblxuICBnZXQocHJvcDogc3RyaW5nKTogU2ltcGxlUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFNpbXBsZVBhdGhSZWZlcmVuY2UodGhpcywgcHJvcCk7XG4gIH1cbn1cblxuY2xhc3MgSW5lcnRNb2RpZmllck1hbmFnZXIgaW1wbGVtZW50cyBNb2RpZmllck1hbmFnZXI8T3BhcXVlPiB7XG4gIGNyZWF0ZSgpIHt9XG5cbiAgaW5zdGFsbChtb2RpZmllcjogT3BhcXVlKSB7fVxuXG4gIHVwZGF0ZShtb2RpZmllcjogT3BhcXVlKSB7fVxuXG4gIGdldERlc3RydWN0b3IobW9kaWZpZXI6IE9wYXF1ZSk6IERlc3Ryb3lhYmxlIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVGVzdE1vZGlmaWVyIHtcbiAgY29uc3RydWN0b3IoXG4gICAgcHVibGljIGVsZW1lbnQ6IEVsZW1lbnQsXG4gICAgcHVibGljIGFyZ3M6IEV2YWx1YXRlZEFyZ3MsXG4gICAgcHVibGljIGRvbTogSURPTUNoYW5nZXNcbiAgKSB7fVxufVxuXG5leHBvcnQgY2xhc3MgVGVzdE1vZGlmaWVyTWFuYWdlciBpbXBsZW1lbnRzIE1vZGlmaWVyTWFuYWdlcjxUZXN0TW9kaWZpZXI+IHtcbiAgcHVibGljIGluc3RhbGxlZEVsZW1lbnRzOiBFbGVtZW50W10gPSBbXTtcbiAgcHVibGljIHVwZGF0ZWRFbGVtZW50czogRWxlbWVudFtdID0gW107XG4gIHB1YmxpYyBkZXN0cm95ZWRNb2RpZmllcnM6IFRlc3RNb2RpZmllcltdID0gW107XG5cbiAgY3JlYXRlKGVsZW1lbnQ6IEVsZW1lbnQsIGFyZ3M6IEV2YWx1YXRlZEFyZ3MsIGR5bmFtaWNTY29wZTogRHluYW1pY1Njb3BlLCBkb206IElET01DaGFuZ2VzKTogVGVzdE1vZGlmaWVyIHtcbiAgICByZXR1cm4gbmV3IFRlc3RNb2RpZmllcihlbGVtZW50LCBhcmdzLCBkb20pO1xuICB9XG5cbiAgaW5zdGFsbCh7IGVsZW1lbnQsIGFyZ3MsIGRvbSB9OiBUZXN0TW9kaWZpZXIpIHtcbiAgICB0aGlzLmluc3RhbGxlZEVsZW1lbnRzLnB1c2goZWxlbWVudCk7XG5cbiAgICBsZXQgcGFyYW0gPSBhcmdzLnBvc2l0aW9uYWwuYXQoMCkudmFsdWUoKTtcbiAgICBkb20uc2V0QXR0cmlidXRlKGVsZW1lbnQsICdkYXRhLW1vZGlmaWVyJywgYGluc3RhbGxlZCAtICR7cGFyYW19YCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICB1cGRhdGUoeyBlbGVtZW50LCBhcmdzLCBkb20gfTogVGVzdE1vZGlmaWVyKSB7XG4gICAgdGhpcy51cGRhdGVkRWxlbWVudHMucHVzaChlbGVtZW50KTtcblxuICAgIGxldCBwYXJhbSA9IGFyZ3MucG9zaXRpb25hbC5hdCgwKS52YWx1ZSgpO1xuICAgIGRvbS5zZXRBdHRyaWJ1dGUoZWxlbWVudCwgJ2RhdGEtbW9kaWZpZXInLCBgdXBkYXRlZCAtICR7cGFyYW19YCk7XG5cbiAgICByZXR1cm47XG4gIH1cblxuICBnZXREZXN0cnVjdG9yKG1vZGlmaWVyOiBUZXN0TW9kaWZpZXIpOiBEZXN0cm95YWJsZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRlc3Ryb3k6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kZXN0cm95ZWRNb2RpZmllcnMucHVzaChtb2RpZmllcik7XG4gICAgICAgIGxldCB7IGVsZW1lbnQsIGRvbSB9ID0gbW9kaWZpZXI7XG4gICAgICAgIGRvbS5yZW1vdmVBdHRyaWJ1dGUoZWxlbWVudCwgJ2RhdGEtbW9kaWZpZXInKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGVzdEVudmlyb25tZW50T3B0aW9ucyB7XG4gIGRvY3VtZW50PzogU2ltcGxlLkRvY3VtZW50O1xuICBhcHBlbmRPcGVyYXRpb25zPzogRE9NVHJlZUNvbnN0cnVjdGlvbjtcbn1cblxuZXhwb3J0IGNsYXNzIFRlc3RFbnZpcm9ubWVudCBleHRlbmRzIEVudmlyb25tZW50IHtcbiAgcHJpdmF0ZSBoZWxwZXJzID0gZGljdDxHbGltbWVySGVscGVyPigpO1xuICBwcml2YXRlIG1vZGlmaWVycyA9IGRpY3Q8TW9kaWZpZXJNYW5hZ2VyPE9wYXF1ZT4+KCk7XG4gIHByaXZhdGUgcGFydGlhbHMgPSBkaWN0PFBhcnRpYWxEZWZpbml0aW9uPHt9Pj4oKTtcbiAgcHJpdmF0ZSBjb21wb25lbnRzID0gZGljdDxDb21wb25lbnREZWZpbml0aW9uPGFueT4+KCk7XG4gIHByaXZhdGUgdXNlbGVzc0FuY2hvcjogSFRNTEFuY2hvckVsZW1lbnQ7XG4gIHB1YmxpYyBjb21waWxlZExheW91dHMgPSBkaWN0PENvbXBpbGVkUHJvZ3JhbT4oKTtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBUZXN0RW52aXJvbm1lbnRPcHRpb25zID0ge1xuICAgIGRvY3VtZW50OiBkb2N1bWVudCxcbiAgICBhcHBlbmRPcGVyYXRpb25zOiBuZXcgRE9NVHJlZUNvbnN0cnVjdGlvbihkb2N1bWVudClcbiAgfSkge1xuICAgIHN1cGVyKHsgYXBwZW5kT3BlcmF0aW9uczogb3B0aW9ucy5hcHBlbmRPcGVyYXRpb25zLCB1cGRhdGVPcGVyYXRpb25zOiBuZXcgRE9NQ2hhbmdlcyhvcHRpb25zLmRvY3VtZW50IGFzIERvY3VtZW50KSB9KTtcblxuICAgIHRoaXMudXNlbGVzc0FuY2hvciA9IG9wdGlvbnMuZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpIGFzIEhUTUxBbmNob3JFbGVtZW50O1xuICAgIHRoaXMucmVnaXN0ZXJIZWxwZXIoXCJpZlwiLCAoW2NvbmQsIHllcywgbm9dKSA9PiBjb25kID8geWVzIDogbm8pO1xuICAgIHRoaXMucmVnaXN0ZXJIZWxwZXIoXCJ1bmxlc3NcIiwgKFtjb25kLCB5ZXMsIG5vXSkgPT4gY29uZCA/IG5vIDogeWVzKTtcbiAgICB0aGlzLnJlZ2lzdGVySW50ZXJuYWxIZWxwZXIoXCItZ2V0LWR5bmFtaWMtdmFyXCIsIGdldER5bmFtaWNWYXIpO1xuICAgIHRoaXMucmVnaXN0ZXJNb2RpZmllcihcImFjdGlvblwiLCBuZXcgSW5lcnRNb2RpZmllck1hbmFnZXIoKSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVySW50ZXJuYWxIZWxwZXIoXCJjb21wb25lbnRcIiwgKHZtLCBhcmdzLCBzeW1ib2xUYWJsZSkgPT4ge1xuICAgICAgcmV0dXJuIG5ldyBEeW5hbWljQ29tcG9uZW50UmVmZXJlbmNlKGFyZ3MucG9zaXRpb25hbC5hdCgwKSwgdm0uZW52LCBzeW1ib2xUYWJsZSk7XG4gICAgfSk7XG5cbiAgICB0aGlzLnJlZ2lzdGVySW50ZXJuYWxIZWxwZXIoXCJoYXNoXCIsICh2bSwgYXJncykgPT4gYXJncy5uYW1lZCk7XG4gIH1cblxuICBwcm90b2NvbEZvclVSTCh1cmw6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgdGhpcy51c2VsZXNzQW5jaG9yLmhyZWYgPSB1cmw7XG4gICAgcmV0dXJuIHRoaXMudXNlbGVzc0FuY2hvci5wcm90b2NvbDtcbiAgfVxuXG4gIHJlZ2lzdGVySGVscGVyKG5hbWU6IHN0cmluZywgaGVscGVyOiBVc2VySGVscGVyKSB7XG4gICAgdGhpcy5oZWxwZXJzW25hbWVdID0gKHZtOiBWTSwgYXJnczogRXZhbHVhdGVkQXJncykgPT4gbmV3IEhlbHBlclJlZmVyZW5jZShoZWxwZXIsIGFyZ3MpO1xuICB9XG5cbiAgcmVnaXN0ZXJJbnRlcm5hbEhlbHBlcihuYW1lOiBzdHJpbmcsIGhlbHBlcjogR2xpbW1lckhlbHBlcikge1xuICAgIHRoaXMuaGVscGVyc1tuYW1lXSA9IGhlbHBlcjtcbiAgfVxuXG4gIHJlZ2lzdGVyTW9kaWZpZXIobmFtZTogc3RyaW5nLCBtb2RpZmllcjogTW9kaWZpZXJNYW5hZ2VyPE9wYXF1ZT4pIHtcbiAgICB0aGlzLm1vZGlmaWVyc1tuYW1lXSA9IG1vZGlmaWVyO1xuICB9XG5cbiAgcmVnaXN0ZXJQYXJ0aWFsKG5hbWU6IHN0cmluZywgc291cmNlOiBzdHJpbmcpIHtcbiAgICB0aGlzLnBhcnRpYWxzW25hbWVdID0gbmV3IFBhcnRpYWxEZWZpbml0aW9uKG5hbWUsIHJhd0NvbXBpbGUoc291cmNlLCB7IGVudjogdGhpcyB9KSk7XG4gIH1cblxuICByZWdpc3RlckNvbXBvbmVudChuYW1lOiBzdHJpbmcsIGRlZmluaXRpb246IENvbXBvbmVudERlZmluaXRpb248YW55Pikge1xuICAgIHRoaXMuY29tcG9uZW50c1tuYW1lXSA9IGRlZmluaXRpb247XG4gICAgcmV0dXJuIGRlZmluaXRpb247XG4gIH1cblxuICByZWdpc3RlckJhc2ljQ29tcG9uZW50PFQgZXh0ZW5kcyBCYXNpY0NvbXBvbmVudD4obmFtZTogc3RyaW5nLCBDb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50RmFjdG9yeSwgbGF5b3V0OiBzdHJpbmcpOiBDb21wb25lbnREZWZpbml0aW9uPEJhc2ljQ29tcG9uZW50RGVmaW5pdGlvbj4ge1xuICAgIGxldCBkZWZpbml0aW9uID0gbmV3IEJhc2ljQ29tcG9uZW50RGVmaW5pdGlvbihuYW1lLCBCQVNJQ19DT01QT05FTlRfTUFOQUdFUiwgQ29tcG9uZW50LCBsYXlvdXQpO1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KG5hbWUsIGRlZmluaXRpb24pO1xuICB9XG5cbiAgcmVnaXN0ZXJTdGF0aWNUYWdsZXNzQ29tcG9uZW50KG5hbWU6IHN0cmluZywgQ29tcG9uZW50OiBCYXNpY0NvbXBvbmVudEZhY3RvcnksIGxheW91dDogc3RyaW5nKTogQ29tcG9uZW50RGVmaW5pdGlvbjxCYXNpY0NvbXBvbmVudEZhY3Rvcnk+IHtcbiAgICBsZXQgZGVmaW5pdGlvbiA9IG5ldyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50RGVmaW5pdGlvbihuYW1lLCBTVEFUSUNfVEFHTEVTU19DT01QT05FTlRfTUFOQUdFUiwgQ29tcG9uZW50LCBsYXlvdXQpO1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KG5hbWUsIGRlZmluaXRpb24pO1xuICB9XG5cbiAgcmVnaXN0ZXJFbWJlcmlzaEN1cmx5Q29tcG9uZW50KG5hbWU6IHN0cmluZywgQ29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50RmFjdG9yeSwgbGF5b3V0OiBzdHJpbmcpOiBDb21wb25lbnREZWZpbml0aW9uPEVtYmVyaXNoQ3VybHlDb21wb25lbnREZWZpbml0aW9uPiB7XG4gICAgbGV0IGRlZmluaXRpb24gPSBuZXcgRW1iZXJpc2hDdXJseUNvbXBvbmVudERlZmluaXRpb24obmFtZSwgRU1CRVJJU0hfQ1VSTFlfQ09NUE9ORU5UX01BTkFHRVIsIENvbXBvbmVudCwgbGF5b3V0KTtcbiAgICByZXR1cm4gdGhpcy5yZWdpc3RlckNvbXBvbmVudChuYW1lLCBkZWZpbml0aW9uKTtcbiAgfVxuXG4gIHJlZ2lzdGVyRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KG5hbWU6IHN0cmluZywgQ29tcG9uZW50OiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnRGYWN0b3J5LCBsYXlvdXQ6IHN0cmluZyk6IENvbXBvbmVudERlZmluaXRpb248RW1iZXJpc2hHbGltbWVyQ29tcG9uZW50RGVmaW5pdGlvbj4ge1xuICAgIGxldCBkZWZpbml0aW9uID0gbmV3IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudERlZmluaXRpb24obmFtZSwgRU1CRVJJU0hfR0xJTU1FUl9DT01QT05FTlRfTUFOQUdFUiwgQ29tcG9uZW50LCBsYXlvdXQpO1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KG5hbWUsIGRlZmluaXRpb24pO1xuICB9XG5cbiAgdG9Db25kaXRpb25hbFJlZmVyZW5jZShyZWZlcmVuY2U6IFJlZmVyZW5jZTxhbnk+KTogUmVmZXJlbmNlPGJvb2xlYW4+IHtcbiAgICBpZiAoaXNDb25zdChyZWZlcmVuY2UpKSB7XG4gICAgICByZXR1cm4gUHJpbWl0aXZlUmVmZXJlbmNlLmNyZWF0ZShlbWJlclRvQm9vbChyZWZlcmVuY2UudmFsdWUoKSkpO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRW1iZXJpc2hDb25kaXRpb25hbFJlZmVyZW5jZShyZWZlcmVuY2UpO1xuICB9XG5cbiAgbWFjcm9zKCk6IHsgYmxvY2tzOiBCbG9ja01hY3JvcywgaW5saW5lczogSW5saW5lTWFjcm9zIH0ge1xuICAgIGxldCBtYWNyb3MgPSBzdXBlci5tYWNyb3MoKTtcbiAgICBwb3B1bGF0ZUJsb2NrcyhtYWNyb3MuYmxvY2tzLCBtYWNyb3MuaW5saW5lcyk7XG4gICAgcmV0dXJuIG1hY3JvcztcbiAgfVxuXG4gIGhhc0hlbHBlcihoZWxwZXJOYW1lOiBzdHJpbmdbXSkge1xuICAgIHJldHVybiBoZWxwZXJOYW1lLmxlbmd0aCA9PT0gMSAmJiAoPHN0cmluZz5oZWxwZXJOYW1lWzBdIGluIHRoaXMuaGVscGVycyk7XG4gIH1cblxuICBsb29rdXBIZWxwZXIoaGVscGVyUGFydHM6IHN0cmluZ1tdKSB7XG4gICAgbGV0IGhlbHBlck5hbWUgPSBoZWxwZXJQYXJ0c1swXTtcblxuICAgIGxldCBoZWxwZXIgPSB0aGlzLmhlbHBlcnNbaGVscGVyTmFtZV07XG5cbiAgICBpZiAoIWhlbHBlcikgdGhyb3cgbmV3IEVycm9yKGBIZWxwZXIgZm9yICR7aGVscGVyUGFydHMuam9pbignLicpfSBub3QgZm91bmQuYCk7XG5cbiAgICByZXR1cm4gaGVscGVyO1xuICB9XG5cbiAgaGFzUGFydGlhbChwYXJ0aWFsTmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHBhcnRpYWxOYW1lIGluIHRoaXMucGFydGlhbHM7XG4gIH1cblxuICBsb29rdXBQYXJ0aWFsKHBhcnRpYWxOYW1lOiBzdHJpbmcpIHtcbiAgICBsZXQgcGFydGlhbCA9IHRoaXMucGFydGlhbHNbcGFydGlhbE5hbWVdO1xuXG4gICAgcmV0dXJuIHBhcnRpYWw7XG4gIH1cblxuICBoYXNDb21wb25lbnREZWZpbml0aW9uKG5hbWU6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuICEhdGhpcy5jb21wb25lbnRzW25hbWVbMF1dO1xuICB9XG5cbiAgZ2V0Q29tcG9uZW50RGVmaW5pdGlvbihuYW1lOiBzdHJpbmdbXSwgYmxvY2tNZXRhPzogVGVtcGxhdGVNZXRhKTogQ29tcG9uZW50RGVmaW5pdGlvbjxhbnk+IHtcbiAgICByZXR1cm4gdGhpcy5jb21wb25lbnRzW25hbWVbMF1dO1xuICB9XG5cbiAgaGFzTW9kaWZpZXIobW9kaWZpZXJOYW1lOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBtb2RpZmllck5hbWUubGVuZ3RoID09PSAxICYmICg8c3RyaW5nPm1vZGlmaWVyTmFtZVswXSBpbiB0aGlzLm1vZGlmaWVycyk7XG4gIH1cblxuICBsb29rdXBNb2RpZmllcihtb2RpZmllck5hbWU6IHN0cmluZ1tdKTogTW9kaWZpZXJNYW5hZ2VyPE9wYXF1ZT4ge1xuICAgIGxldCBbbmFtZV0gPSBtb2RpZmllck5hbWU7XG5cbiAgICBsZXQgbW9kaWZpZXIgPSB0aGlzLm1vZGlmaWVyc1tuYW1lXTtcblxuICAgIGlmKCFtb2RpZmllcikgdGhyb3cgbmV3IEVycm9yKGBNb2RpZmllciBmb3IgJHttb2RpZmllck5hbWUuam9pbignLicpfSBub3QgZm91bmQuYCk7XG4gICAgcmV0dXJuIG1vZGlmaWVyO1xuICB9XG5cbiAgY29tcGlsZSh0ZW1wbGF0ZTogc3RyaW5nKTogVGVtcGxhdGU8dW5kZWZpbmVkPiB7XG4gICAgcmV0dXJuIHJhd0NvbXBpbGU8dW5kZWZpbmVkPih0ZW1wbGF0ZSwgeyBlbnY6IHRoaXMgfSk7XG4gIH1cblxuICBjb21waWxlTGF5b3V0KHRlbXBsYXRlOiBzdHJpbmcpOiBMYXlvdXQge1xuICAgIHJldHVybiByYXdDb21waWxlTGF5b3V0KHRlbXBsYXRlLCB7IGVudjogdGhpcyB9KTtcbiAgfVxuXG4gIGl0ZXJhYmxlRm9yKHJlZjogUmVmZXJlbmNlPE9wYXF1ZT4sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MpOiBPcGFxdWVJdGVyYWJsZSB7XG4gICAgbGV0IGtleVBhdGggPSBhcmdzLm5hbWVkLmdldChcImtleVwiKS52YWx1ZSgpIGFzIEZJWE1FPGFueSwgXCJVc2VyIHZhbHVlIHRvIGxvb2t1cCBrZXlcIj47XG4gICAgbGV0IGtleUZvcjogS2V5Rm9yPE9wYXF1ZT47XG5cbiAgICBpZiAoIWtleVBhdGgpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTXVzdCBzcGVjaWZ5IGEga2V5IGZvciAjZWFjaCcpO1xuICAgIH1cblxuICAgIHN3aXRjaCAoa2V5UGF0aCkge1xuICAgICAgY2FzZSAnQGluZGV4JzpcbiAgICAgICAga2V5Rm9yID0gKF8sIGluZGV4OiBudW1iZXIpID0+IFN0cmluZyhpbmRleCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnQHByaW1pdGl2ZSc6XG4gICAgICAgIGtleUZvciA9IChpdGVtOiBPcGFxdWUpID0+IFN0cmluZyhpdGVtKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBrZXlGb3IgPSAoaXRlbTogT3BhcXVlKSA9PiBpdGVtW2tleVBhdGhdO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEl0ZXJhYmxlKHJlZiwga2V5Rm9yKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgVGVzdER5bmFtaWNTY29wZSBpbXBsZW1lbnRzIER5bmFtaWNTY29wZSB7XG4gIHByaXZhdGUgYnVja2V0O1xuXG4gIGNvbnN0cnVjdG9yKGJ1Y2tldD1udWxsKSB7XG4gICAgaWYgKGJ1Y2tldCkge1xuICAgICAgdGhpcy5idWNrZXQgPSBhc3NpZ24oe30sIGJ1Y2tldCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuYnVja2V0ID0ge307XG4gICAgfVxuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nKTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gdGhpcy5idWNrZXRba2V5XTtcbiAgfVxuXG4gIHNldChrZXk6IHN0cmluZywgcmVmZXJlbmNlOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4pIHtcbiAgICByZXR1cm4gdGhpcy5idWNrZXRba2V5XSA9IHJlZmVyZW5jZTtcbiAgfVxuXG4gIGNoaWxkKCk6IFRlc3REeW5hbWljU2NvcGUge1xuICAgIHJldHVybiBuZXcgVGVzdER5bmFtaWNTY29wZSh0aGlzLmJ1Y2tldCk7XG4gIH1cbn1cblxuY2xhc3MgRHluYW1pY0NvbXBvbmVudFJlZmVyZW5jZSBpbXBsZW1lbnRzIFBhdGhSZWZlcmVuY2U8Q29tcG9uZW50RGVmaW5pdGlvbjxPcGFxdWU+PiB7XG4gIHB1YmxpYyB0YWc6IFJldmlzaW9uVGFnO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbmFtZVJlZjogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBwcml2YXRlIGVudjogRW52aXJvbm1lbnQsIHByaXZhdGUgc3ltYm9sVGFibGU6IFN5bWJvbFRhYmxlKSB7XG4gICAgdGhpcy50YWcgPSBuYW1lUmVmLnRhZztcbiAgfVxuXG4gIHZhbHVlKCk6IENvbXBvbmVudERlZmluaXRpb248T3BhcXVlPiB7XG4gICAgbGV0IHsgZW52LCBuYW1lUmVmIH0gPSB0aGlzO1xuXG4gICAgbGV0IG5hbWVPckRlZiA9IG5hbWVSZWYudmFsdWUoKTtcblxuICAgIGlmICh0eXBlb2YgbmFtZU9yRGVmID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGVudi5nZXRDb21wb25lbnREZWZpbml0aW9uKFtuYW1lT3JEZWZdLCB0aGlzLnN5bWJvbFRhYmxlKTtcbiAgICB9IGVsc2UgaWYgKGlzQ29tcG9uZW50RGVmaW5pdGlvbihuYW1lT3JEZWYpKSB7XG4gICAgICByZXR1cm4gbmFtZU9yRGVmO1xuICAgIH1cblxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZ2V0KCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmZ1bmN0aW9uIGR5bmFtaWNDb21wb25lbnRGb3Iodm06IFZNLCBzeW1ib2xUYWJsZTogU3ltYm9sVGFibGUpIHtcbiAgbGV0IGFyZ3MgPSB2bS5nZXRBcmdzKCk7XG4gIGxldCBuYW1lUmVmID0gYXJncy5wb3NpdGlvbmFsLmF0KDApO1xuICBsZXQgZW52ID0gdm0uZW52O1xuICByZXR1cm4gbmV3IER5bmFtaWNDb21wb25lbnRSZWZlcmVuY2UobmFtZVJlZiwgZW52LCBzeW1ib2xUYWJsZSk7XG59O1xuXG5leHBvcnQgaW50ZXJmYWNlIEJhc2ljQ29tcG9uZW50RmFjdG9yeSB7XG4gIG5ldyhhdHRyczogRGljdDxhbnk+KTogQmFzaWNDb21wb25lbnQ7XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBHZW5lcmljQ29tcG9uZW50RGVmaW5pdGlvbjxUPiBleHRlbmRzIENvbXBvbmVudERlZmluaXRpb248VD4ge1xuICBwdWJsaWMgbGF5b3V0U3RyaW5nIDogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgbWFuYWdlcjogQ29tcG9uZW50TWFuYWdlcjxUPiwgQ29tcG9uZW50Q2xhc3M6IGFueSwgbGF5b3V0OiBzdHJpbmcpIHtcbiAgICBzdXBlcihuYW1lLCBtYW5hZ2VyLCBDb21wb25lbnRDbGFzcyk7XG4gICAgdGhpcy5sYXlvdXRTdHJpbmcgPSBsYXlvdXQ7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEJhc2ljQ29tcG9uZW50RGVmaW5pdGlvbiBleHRlbmRzIEdlbmVyaWNDb21wb25lbnREZWZpbml0aW9uPEJhc2ljQ29tcG9uZW50PiB7XG4gIHB1YmxpYyBDb21wb25lbnRDbGFzczogQmFzaWNDb21wb25lbnRGYWN0b3J5O1xufVxuXG5jbGFzcyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50RGVmaW5pdGlvbiBleHRlbmRzIEdlbmVyaWNDb21wb25lbnREZWZpbml0aW9uPEJhc2ljQ29tcG9uZW50PiB7XG4gIHB1YmxpYyBDb21wb25lbnRDbGFzczogQmFzaWNDb21wb25lbnRGYWN0b3J5O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVtYmVyaXNoQ3VybHlDb21wb25lbnRGYWN0b3J5IHtcbiAgcG9zaXRpb25hbFBhcmFtcz86IHN0cmluZ1tdO1xuICBjcmVhdGUob3B0aW9uczogeyBhdHRyczogQXR0cnMsIHRhcmdldE9iamVjdCB9KTogRW1iZXJpc2hDdXJseUNvbXBvbmVudDtcbn1cblxuZXhwb3J0IGNsYXNzIEVtYmVyaXNoQ3VybHlDb21wb25lbnREZWZpbml0aW9uIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudERlZmluaXRpb248RW1iZXJpc2hDdXJseUNvbXBvbmVudD4ge1xuICBwdWJsaWMgQ29tcG9uZW50Q2xhc3M6IEVtYmVyaXNoQ3VybHlDb21wb25lbnRGYWN0b3J5O1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudEZhY3Rvcnkge1xuICBjcmVhdGUob3B0aW9uczogeyBhdHRyczogQXR0cnMgfSk6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudDtcbn1cblxuZXhwb3J0IGNsYXNzIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudERlZmluaXRpb24gZXh0ZW5kcyBHZW5lcmljQ29tcG9uZW50RGVmaW5pdGlvbjxFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQ+IHtcbiAgcHVibGljIENvbXBvbmVudENsYXNzOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnRGYWN0b3J5O1xufVxuXG5hYnN0cmFjdCBjbGFzcyBHZW5lcmljQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIgaW1wbGVtZW50cyBDb21waWxhYmxlTGF5b3V0IHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBsYXlvdXRTdHJpbmc6IHN0cmluZykge31cblxuICBwcm90ZWN0ZWQgY29tcGlsZUxheW91dChlbnY6IEVudmlyb25tZW50KSB7XG4gICAgcmV0dXJuIHJhd0NvbXBpbGVMYXlvdXQodGhpcy5sYXlvdXRTdHJpbmcsIHsgZW52IH0pO1xuICB9XG5cbiAgYWJzdHJhY3QgY29tcGlsZShidWlsZGVyOiBDb21wb25lbnRMYXlvdXRCdWlsZGVyKTtcbn1cblxuY2xhc3MgQmFzaWNDb21wb25lbnRMYXlvdXRDb21waWxlciBleHRlbmRzIEdlbmVyaWNDb21wb25lbnRMYXlvdXRDb21waWxlciB7XG4gIGNvbXBpbGUoYnVpbGRlcjogQ29tcG9uZW50TGF5b3V0QnVpbGRlcikge1xuICAgIGJ1aWxkZXIuZnJvbUxheW91dCh0aGlzLmNvbXBpbGVMYXlvdXQoYnVpbGRlci5lbnYpKTtcbiAgfVxufVxuXG5jbGFzcyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIgZXh0ZW5kcyBHZW5lcmljQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIge1xuICBjb21waWxlKGJ1aWxkZXI6IENvbXBvbmVudExheW91dEJ1aWxkZXIpIHtcbiAgICBidWlsZGVyLndyYXBMYXlvdXQodGhpcy5jb21waWxlTGF5b3V0KGJ1aWxkZXIuZW52KSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gRW1iZXJUYWdOYW1lKHZtOiBWTSk6IFBhdGhSZWZlcmVuY2U8c3RyaW5nPiB7XG4gIGxldCBzZWxmID0gdm0uZ2V0U2VsZigpLnZhbHVlKCk7XG4gIGxldCB0YWdOYW1lOiBzdHJpbmcgPSBzZWxmWyd0YWdOYW1lJ107XG4gIHRhZ05hbWUgPSB0YWdOYW1lID09PSAnJyA/IG51bGwgOiBzZWxmWyd0YWdOYW1lJ10gfHwgJ2Rpdic7XG4gIHJldHVybiBQcmltaXRpdmVSZWZlcmVuY2UuY3JlYXRlKHRhZ05hbWUpO1xufVxuXG5mdW5jdGlvbiBFbWJlcklEKHZtOiBWTSk6IFBhdGhSZWZlcmVuY2U8c3RyaW5nPiB7XG4gIGxldCBzZWxmID0gdm0uZ2V0U2VsZigpLnZhbHVlKCkgYXMgeyBfZ3VpZDogc3RyaW5nIH07XG4gIHJldHVybiBQcmltaXRpdmVSZWZlcmVuY2UuY3JlYXRlKGBlbWJlciR7c2VsZi5fZ3VpZH1gKTtcbn1cblxuY2xhc3MgRW1iZXJpc2hDdXJseUNvbXBvbmVudExheW91dENvbXBpbGVyIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudExheW91dENvbXBpbGVyIHtcbiAgY29tcGlsZShidWlsZGVyOiBDb21wb25lbnRMYXlvdXRCdWlsZGVyKSB7XG4gICAgYnVpbGRlci53cmFwTGF5b3V0KHRoaXMuY29tcGlsZUxheW91dChidWlsZGVyLmVudikpO1xuICAgIGJ1aWxkZXIudGFnLmR5bmFtaWMoRW1iZXJUYWdOYW1lKTtcbiAgICBidWlsZGVyLmF0dHJzLnN0YXRpYygnY2xhc3MnLCAnZW1iZXItdmlldycpO1xuICAgIGJ1aWxkZXIuYXR0cnMuZHluYW1pYygnaWQnLCBFbWJlcklEKTtcbiAgfVxufVxuXG5jbGFzcyBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnRMYXlvdXRDb21waWxlciBleHRlbmRzIEdlbmVyaWNDb21wb25lbnRMYXlvdXRDb21waWxlciB7XG4gIGNvbXBpbGUoYnVpbGRlcjogQ29tcG9uZW50TGF5b3V0QnVpbGRlcikge1xuICAgIGJ1aWxkZXIuZnJvbUxheW91dCh0aGlzLmNvbXBpbGVMYXlvdXQoYnVpbGRlci5lbnYpKTtcbiAgICBidWlsZGVyLmF0dHJzLnN0YXRpYygnY2xhc3MnLCAnZW1iZXItdmlldycpO1xuICAgIGJ1aWxkZXIuYXR0cnMuZHluYW1pYygnaWQnLCBFbWJlcklEKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5zcGVjdEhvb2tzPFQgZXh0ZW5kcyBDb21wb25lbnQ+KENvbXBvbmVudENsYXNzOiBHbGltbWVyT2JqZWN0RmFjdG9yeTxUPik6IEdsaW1tZXJPYmplY3RGYWN0b3J5PFQ+IHtcbiAgcmV0dXJuIENvbXBvbmVudENsYXNzLmV4dGVuZCh7XG4gICAgaW5pdCgpIHtcbiAgICAgIHRoaXMuX3N1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmhvb2tzID0ge1xuICAgICAgICBkaWRJbml0QXR0cnM6IDAsXG4gICAgICAgIGRpZFVwZGF0ZUF0dHJzOiAwLFxuICAgICAgICBkaWRSZWNlaXZlQXR0cnM6IDAsXG4gICAgICAgIHdpbGxJbnNlcnRFbGVtZW50OiAwLFxuICAgICAgICB3aWxsVXBkYXRlOiAwLFxuICAgICAgICB3aWxsUmVuZGVyOiAwLFxuICAgICAgICBkaWRJbnNlcnRFbGVtZW50OiAwLFxuICAgICAgICBkaWRVcGRhdGU6IDAsXG4gICAgICAgIGRpZFJlbmRlcjogMFxuICAgICAgfTtcbiAgICB9LFxuXG4gICAgZGlkSW5pdEF0dHJzKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZEluaXRBdHRycyddKys7XG4gICAgfSxcblxuICAgIGRpZFVwZGF0ZUF0dHJzKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZFVwZGF0ZUF0dHJzJ10rKztcbiAgICB9LFxuXG4gICAgZGlkUmVjZWl2ZUF0dHJzKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZFJlY2VpdmVBdHRycyddKys7XG4gICAgfSxcblxuICAgIHdpbGxJbnNlcnRFbGVtZW50KCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ3dpbGxJbnNlcnRFbGVtZW50J10rKztcbiAgICB9LFxuXG4gICAgd2lsbFVwZGF0ZSgpIHtcbiAgICAgIHRoaXMuX3N1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmhvb2tzWyd3aWxsVXBkYXRlJ10rKztcbiAgICB9LFxuXG4gICAgd2lsbFJlbmRlcigpIHtcbiAgICAgIHRoaXMuX3N1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmhvb2tzWyd3aWxsUmVuZGVyJ10rKztcbiAgICB9LFxuXG4gICAgZGlkSW5zZXJ0RWxlbWVudCgpIHtcbiAgICAgIHRoaXMuX3N1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmhvb2tzWydkaWRJbnNlcnRFbGVtZW50J10rKztcbiAgICB9LFxuXG4gICAgZGlkVXBkYXRlKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZFVwZGF0ZSddKys7XG4gICAgfSxcblxuICAgIGRpZFJlbmRlcigpIHtcbiAgICAgIHRoaXMuX3N1cGVyKC4uLmFyZ3VtZW50cyk7XG4gICAgICB0aGlzLmhvb2tzWydkaWRSZW5kZXInXSsrO1xuICAgIH1cbiAgfSk7XG59XG5cbmNvbnN0IHsgZGVmYXVsdEJsb2NrLCBpbnZlcnNlQmxvY2ssIHBhcmFtcywgaGFzaCB9ID0gQmFzZWxpbmVTeW50YXguTmVzdGVkQmxvY2s7XG5cbmZ1bmN0aW9uIHBvcHVsYXRlQmxvY2tzKGJsb2NrczogQmxvY2tNYWNyb3MsIGlubGluZXM6IElubGluZU1hY3Jvcyk6IHsgYmxvY2tzOiBCbG9ja01hY3JvcywgaW5saW5lczogSW5saW5lTWFjcm9zIH0ge1xuICBibG9ja3MuYWRkKCdpZGVudGl0eScsIChzZXhwOiBOZXN0ZWRCbG9ja1N5bnRheCwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlckRTTCkgPT4ge1xuICAgIGJ1aWxkZXIuZXZhbHVhdGUoc2V4cFs0XSk7XG4gIH0pO1xuXG4gIGJsb2Nrcy5hZGQoJ3JlbmRlci1pbnZlcnNlJywgKHNleHA6IE5lc3RlZEJsb2NrU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyRFNMKSA9PiB7XG4gICAgYnVpbGRlci5ldmFsdWF0ZShzZXhwWzVdKTtcbiAgfSk7XG5cbiAgYmxvY2tzLmFkZCgnLXdpdGgtZHluYW1pYy12YXJzJywgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgYmxvY2sgPSBkZWZhdWx0QmxvY2soc2V4cCk7XG4gICAgbGV0IGFyZ3MgPSBjb21waWxlQXJncyhwYXJhbXMoc2V4cCksIGhhc2goc2V4cCksIGJ1aWxkZXIpO1xuXG4gICAgYnVpbGRlci51bml0KGIgPT4ge1xuICAgICAgYi5wdXRBcmdzKGFyZ3MpO1xuICAgICAgYi5wdXNoRHluYW1pY1Njb3BlKCk7XG4gICAgICBiLmJpbmREeW5hbWljU2NvcGUoYXJncy5uYW1lZC5rZXlzIGFzIHN0cmluZ1tdKTtcbiAgICAgIGIuZXZhbHVhdGUodW53cmFwKGJsb2NrKSk7XG4gICAgICBiLnBvcER5bmFtaWNTY29wZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICBibG9ja3MuYWRkKCctaW4tZWxlbWVudCcsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IGJsb2NrID0gZGVmYXVsdEJsb2NrKHNleHApO1xuICAgIGxldCBhcmdzID0gY29tcGlsZUFyZ3MocGFyYW1zKHNleHApLCBoYXNoKHNleHApLCBidWlsZGVyKTtcblxuICAgIGJ1aWxkZXIucHV0QXJncyhhcmdzKTtcbiAgICBidWlsZGVyLnRlc3QoJ3NpbXBsZScpO1xuXG4gICAgYnVpbGRlci5sYWJlbGxlZChudWxsLCBiID0+IHtcbiAgICAgIGIuanVtcFVubGVzcygnRU5EJyk7XG4gICAgICBiLnB1c2hSZW1vdGVFbGVtZW50KCk7XG4gICAgICBiLmV2YWx1YXRlKHVud3JhcChibG9jaykpO1xuICAgICAgYi5wb3BSZW1vdGVFbGVtZW50KCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGJsb2Nrcy5hZGQoJ2NvbXBvbmVudCcsIChzZXhwLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IFssIHBhdGgsIHBhcmFtcywgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdID0gc2V4cDtcbiAgICBsZXQgZGVmaW5pdGlvbkFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MgPSBbcGFyYW1zLnNsaWNlKDAsIDEpLCBudWxsLCBudWxsLCBudWxsXTtcbiAgICBsZXQgYXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtwYXJhbXMuc2xpY2UoMSksIGhhc2gsIF9kZWZhdWx0LCBpbnZlcnNlXTtcbiAgICBidWlsZGVyLmNvbXBvbmVudC5keW5hbWljKGRlZmluaXRpb25BcmdzLCBkeW5hbWljQ29tcG9uZW50Rm9yLCBhcmdzLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG5cbiAgYmxvY2tzLmFkZE1pc3NpbmcoKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgcGF0aCwgcGFyYW1zLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV0gPSBzZXhwO1xuICAgIGxldCB0YWJsZSA9IGJ1aWxkZXIuc3ltYm9sVGFibGU7XG5cbiAgICBpZiAoIXBhcmFtcykge1xuICAgICAgcGFyYW1zID0gW107XG4gICAgfVxuXG4gICAgaWYgKHBhdGgubGVuZ3RoID4gMSkge1xuICAgICAgbGV0IGRlZmluaXRpb25BcmdzOiBCYXNlbGluZVN5bnRheC5BcmdzID0gW1tbJ2dldCcsIHBhdGhdXSwgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdO1xuICAgICAgbGV0IGFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MgPSBbcGFyYW1zLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV07XG4gICAgICBidWlsZGVyLmNvbXBvbmVudC5keW5hbWljKGRlZmluaXRpb25BcmdzLCBkeW5hbWljQ29tcG9uZW50Rm9yLCBhcmdzLCB0YWJsZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBsZXQgZGVmaW5pdGlvbiA9IGJ1aWxkZXIuZW52LmdldENvbXBvbmVudERlZmluaXRpb24ocGF0aCwgYnVpbGRlci5zeW1ib2xUYWJsZSk7XG5cbiAgICBpZiAoZGVmaW5pdGlvbikge1xuICAgICAgYnVpbGRlci5jb21wb25lbnQuc3RhdGljKGRlZmluaXRpb24sIFtwYXJhbXMsIGhhc2gsIF9kZWZhdWx0LCBpbnZlcnNlXSwgdGFibGUpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxuICBpbmxpbmVzLmFkZCgnY29tcG9uZW50JywgKHBhdGgsIHBhcmFtcywgaGFzaCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBkZWZpbml0aW9uQXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtwYXJhbXMuc2xpY2UoMCwgMSksIG51bGwsIG51bGwsIG51bGxdO1xuICAgIGxldCBhcmdzOiBCYXNlbGluZVN5bnRheC5BcmdzID0gW3BhcmFtcy5zbGljZSgxKSwgaGFzaCwgbnVsbCwgbnVsbF07XG4gICAgYnVpbGRlci5jb21wb25lbnQuZHluYW1pYyhkZWZpbml0aW9uQXJncywgZHluYW1pY0NvbXBvbmVudEZvciwgYXJncywgYnVpbGRlci5zeW1ib2xUYWJsZSk7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0pO1xuXG4gIGlubGluZXMuYWRkTWlzc2luZygocGF0aCwgcGFyYW1zLCBoYXNoLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IHRhYmxlID0gYnVpbGRlci5zeW1ib2xUYWJsZTtcblxuICAgIGxldCBkZWZpbml0aW9uID0gYnVpbGRlci5lbnYuZ2V0Q29tcG9uZW50RGVmaW5pdGlvbihwYXRoLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcblxuICAgIGlmIChwYXRoLmxlbmd0aCA+IDEpIHtcbiAgICAgIGxldCBkZWZpbml0aW9uQXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtbWydnZXQnLCBwYXRoXV0sIGhhc2gsIG51bGwsIG51bGxdO1xuICAgICAgbGV0IGFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MgPSBbcGFyYW1zLCBoYXNoLCBudWxsLCBudWxsXTtcbiAgICAgIGJ1aWxkZXIuY29tcG9uZW50LmR5bmFtaWMoZGVmaW5pdGlvbkFyZ3MsIGR5bmFtaWNDb21wb25lbnRGb3IsIGFyZ3MsIHRhYmxlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICBidWlsZGVyLmNvbXBvbmVudC5zdGF0aWMoZGVmaW5pdGlvbiwgW3BhcmFtcywgaGFzaCwgbnVsbCwgbnVsbF0sIHRhYmxlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG5cbiAgcmV0dXJuIHsgYmxvY2tzLCBpbmxpbmVzIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlcXVhbHNFbGVtZW50KGVsZW1lbnQ6IEVsZW1lbnQsIHRhZ05hbWU6IHN0cmluZywgYXR0cmlidXRlczogT2JqZWN0LCBjb250ZW50OiBzdHJpbmcpIHtcbiAgUVVuaXQucHVzaChlbGVtZW50LnRhZ05hbWUgPT09IHRhZ05hbWUudG9VcHBlckNhc2UoKSwgZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCksIHRhZ05hbWUsIGBleHBlY3QgdGFnTmFtZSB0byBiZSAke3RhZ05hbWV9YCk7XG5cbiAgbGV0IGV4cGVjdGVkQXR0cnM6IERpY3Q8TWF0Y2hlcj4gPSBkaWN0PE1hdGNoZXI+KCk7XG5cbiAgbGV0IGV4cGVjdGVkQ291bnQgPSAwO1xuICBmb3IgKGxldCBwcm9wIGluIGF0dHJpYnV0ZXMpIHtcbiAgICBleHBlY3RlZENvdW50Kys7XG4gICAgbGV0IGV4cGVjdGVkID0gYXR0cmlidXRlc1twcm9wXTtcblxuICAgIGxldCBtYXRjaGVyOiBNYXRjaGVyID0gdHlwZW9mIGV4cGVjdGVkID09PSAnb2JqZWN0JyAmJiBNQVRDSEVSIGluIGV4cGVjdGVkID8gZXhwZWN0ZWQgOiBlcXVhbHNBdHRyKGV4cGVjdGVkKTtcbiAgICBleHBlY3RlZEF0dHJzW3Byb3BdID0gbWF0Y2hlcjtcblxuICAgIFFVbml0LnB1c2goXG4gICAgICBleHBlY3RlZEF0dHJzW3Byb3BdLm1hdGNoKGVsZW1lbnQuZ2V0QXR0cmlidXRlKHByb3ApKSxcbiAgICAgIG1hdGNoZXIuZmFpbChlbGVtZW50LmdldEF0dHJpYnV0ZShwcm9wKSksXG4gICAgICBtYXRjaGVyLmZhaWwoZWxlbWVudC5nZXRBdHRyaWJ1dGUocHJvcCkpLFxuICAgICAgYEV4cGVjdGVkIGVsZW1lbnQncyAke3Byb3B9IGF0dHJpYnV0ZSAke21hdGNoZXIuZXhwZWN0ZWQoKX1gXG4gICAgKTtcbiAgfVxuXG4gIGxldCBhY3R1YWxBdHRyaWJ1dGVzID0ge307XG4gIGZvciAobGV0IGkgPSAwLCBsID0gZWxlbWVudC5hdHRyaWJ1dGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgIGFjdHVhbEF0dHJpYnV0ZXNbZWxlbWVudC5hdHRyaWJ1dGVzW2ldLm5hbWVdID0gZWxlbWVudC5hdHRyaWJ1dGVzW2ldLnZhbHVlO1xuICB9XG5cbiAgaWYgKCEoZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSkge1xuICAgIFFVbml0LnB1c2goZWxlbWVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50LCBudWxsLCBudWxsLCBcIkVsZW1lbnQgbXVzdCBiZSBhbiBIVE1MIEVsZW1lbnQsIG5vdCBhbiBTVkcgRWxlbWVudFwiKTtcbiAgfSBlbHNlIHtcbiAgICBRVW5pdC5wdXNoKFxuICAgICAgZWxlbWVudC5hdHRyaWJ1dGVzLmxlbmd0aCA9PT0gZXhwZWN0ZWRDb3VudCxcbiAgICAgIGVsZW1lbnQuYXR0cmlidXRlcy5sZW5ndGgsIGV4cGVjdGVkQ291bnQsXG4gICAgICBgRXhwZWN0ZWQgJHtleHBlY3RlZENvdW50fSBhdHRyaWJ1dGVzOyBnb3QgJHtlbGVtZW50Lm91dGVySFRNTH1gXG4gICAgKTtcblxuICAgIGlmIChjb250ZW50ICE9PSBudWxsKSB7XG4gICAgICBRVW5pdC5wdXNoKGVsZW1lbnQuaW5uZXJIVE1MID09PSBjb250ZW50LCBlbGVtZW50LmlubmVySFRNTCwgY29udGVudCwgYFRoZSBlbGVtZW50IGhhZCAnJHtjb250ZW50fScgYXMgaXRzIGNvbnRlbnRgKTtcbiAgICB9XG4gIH1cbn1cblxuaW50ZXJmYWNlIE1hdGNoZXIge1xuICBcIjNkNGVmMTk0LTEzYmUtNGNjZi04ZGM3LTg2MmVlYTAyYzkzZVwiOiBib29sZWFuO1xuICBtYXRjaChhY3R1YWwpOiBib29sZWFuO1xuICBmYWlsKGFjdHVhbCk6IHN0cmluZztcbiAgZXhwZWN0ZWQoKTogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgTUFUQ0hFUiA9IFwiM2Q0ZWYxOTQtMTNiZS00Y2NmLThkYzctODYyZWVhMDJjOTNlXCI7XG5cbmV4cG9ydCBmdW5jdGlvbiBlcXVhbHNBdHRyKGV4cGVjdGVkKSB7XG4gIHJldHVybiB7XG4gICAgXCIzZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2VcIjogdHJ1ZSxcbiAgICBtYXRjaChhY3R1YWwpIHtcbiAgICAgIHJldHVybiBleHBlY3RlZCA9PT0gYWN0dWFsO1xuICAgIH0sXG5cbiAgICBleHBlY3RlZCgpIHtcbiAgICAgIHJldHVybiBgdG8gZXF1YWwgJHtleHBlY3RlZH1gO1xuICAgIH0sXG5cbiAgICBmYWlsKGFjdHVhbCkge1xuICAgICAgcmV0dXJuIGAke2FjdHVhbH0gZGlkIG5vdCBlcXVhbCAke2V4cGVjdGVkfWA7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXF1YWxzKGV4cGVjdGVkKSB7XG4gIHJldHVybiB7XG4gICAgXCIzZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2VcIjogdHJ1ZSxcbiAgICBtYXRjaChhY3R1YWwpIHtcbiAgICAgIHJldHVybiBleHBlY3RlZCA9PT0gYWN0dWFsO1xuICAgIH0sXG5cbiAgICBleHBlY3RlZCgpIHtcbiAgICAgIHJldHVybiBgdG8gZXF1YWwgJHtleHBlY3RlZH1gO1xuICAgIH0sXG5cbiAgICBmYWlsKGFjdHVhbCkge1xuICAgICAgcmV0dXJuIGAke2FjdHVhbH0gZGlkIG5vdCBlcXVhbCAke2V4cGVjdGVkfWA7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVnZXgocikge1xuICByZXR1cm4ge1xuICAgIFwiM2Q0ZWYxOTQtMTNiZS00Y2NmLThkYzctODYyZWVhMDJjOTNlXCI6IHRydWUsXG4gICAgbWF0Y2godikge1xuICAgICAgcmV0dXJuIHIudGVzdCh2KTtcbiAgICB9LFxuICAgIGV4cGVjdGVkKCkge1xuICAgICAgcmV0dXJuIGB0byBtYXRjaCAke3J9YDtcbiAgICB9LFxuICAgIGZhaWwoYWN0dWFsKSB7XG4gICAgICByZXR1cm4gYCR7YWN0dWFsfSBkaWQgbm90IG1hdGNoICR7cn1gO1xuICAgIH1cbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNsYXNzZXMoZXhwZWN0ZWQ6IHN0cmluZykge1xuICByZXR1cm4ge1xuICAgIFwiM2Q0ZWYxOTQtMTNiZS00Y2NmLThkYzctODYyZWVhMDJjOTNlXCI6IHRydWUsXG4gICAgbWF0Y2goYWN0dWFsKSB7XG4gICAgICByZXR1cm4gYWN0dWFsICYmIChleHBlY3RlZC5zcGxpdCgnICcpLnNvcnQoKS5qb2luKCcgJykgPT09IGFjdHVhbC5zcGxpdCgnICcpLnNvcnQoKS5qb2luKCcgJykpO1xuICAgIH0sXG4gICAgZXhwZWN0ZWQoKSB7XG4gICAgICByZXR1cm4gYHRvIGluY2x1ZGUgJyR7ZXhwZWN0ZWR9J2A7XG4gICAgfSxcbiAgICBmYWlsKGFjdHVhbCkge1xuICAgICAgcmV0dXJuIGAnJHthY3R1YWx9JycgZGlkIG5vdCBtYXRjaCAnJHtleHBlY3RlZH0nYDtcbiAgICB9XG4gIH07XG59XG4iXX0=