"use strict";
var test_helpers_1 = require("@glimmer/test-helpers");
var object_reference_1 = require("@glimmer/object-reference");
var compiler_1 = require("@glimmer/compiler");
var runtime_1 = require("@glimmer/runtime");
var DEFAULT_DATA = "{\n  \"contacts\": [\n    {\n      \"id\": 1,\n      \"name\": {\n        \"first\": \"John\",\n        \"last\": \"Appleseed\"\n      },\n      \"org\": \"Apple Inc.\",\n      \"email\": \"appleseed@apple.com\",\n      \"address\": {\n        \"street\": \"1 Infinite Loop\",\n        \"city\": \"Cupertino\",\n        \"state\": \"CA\",\n        \"zip\": 95014,\n        \"country\": \"USA\"\n      },\n      \"phones\": [\n        {\n          \"type\": \"Office\",\n          \"number\": \"1 (800) MYAPPLE\"\n        },\n        {\n          \"type\": \"Home\",\n          \"number\": \"(555) 123 4567\"\n        },\n        {\n          \"type\": \"Mobile\",\n          \"number\": \"(555) 555 5555\"\n        }\n      ]\n    }\n  ]\n}";
var DEFAULT_TEMPLATE = "<div class=\"contacts\">\n  {{#each contacts key=\"id\" as |contact|}}\n    <h-card @person={{contact}} />\n    <hr />\n  {{/each}}\n</div>";
var DEFAULT_LAYOUT = "<div class=\"vcard\">\n  {{#if @person.url}}\n    <div>\n      <a class=\"url fn n\" href=\"{{@person.url}}\">\n      {{#with @person.name as |name|}}\n        <span class=\"given-name\">{{name.first}}</span>\n        {{#if name.middle}}\n        <span class=\"additional-name\">{{name.middle}}</span>\n        {{/if}}\n        <span class=\"family-name\">{{name.last}}</span>\n      {{/with}}\n      </a>\n    </div>\n  {{else}}\n    <div>\n      {{#with @person.name as |name|}}\n        <span class=\"given-name\">{{name.first}}</span>\n        {{#if name.additional}}\n        <span class=\"additional-name\">{{name.middle}}</span>\n        {{/if}}\n        <span class=\"family-name\">{{name.last}}</span>\n      {{/with}}\n    </div>\n  {{/if}}\n  {{#if @person.org}}\n    <div class=\"org\">{{@person.org}}</div>\n  {{/if}}\n  {{#if @person.email}}\n    <div>\n      <a class=\"email\" href=\"mailto:{{@person.email}}\">\n        {{@person.email}}\n      </a>\n    </div>\n  {{/if}}\n  {{#with @person.address as |address|}}\n    <div class=\"adr\">\n      <span class=\"street-address\">{{address.street}}</span>\n      <br>\n      <span class=\"locality\">{{address.city}}</span>,\n      <span class=\"region\">{{address.state}}</span>\n      <span class=\"postal-code\">{{address.zip}}</span>\n      <br>\n      <span class=\"country-name\">{{address.country}}</span>\n    </div>\n  {{/with}}\n  {{#each @person.phones key=\"type\" as |phone|}}\n    <div class=\"tel\">\n      <span class=\"type\">{{phone.type}}</span>:\n      <span class=\"value\">{{phone.number}}</span>\n    </div>\n  {{/each}}\n</div>";
var UI = "<div id=\"inputs\" class=\"{{if rendered '' 'full-width'}}\">\n  <h1>\n    <span style=\"font-size: 48px; color: rgb(238, 89, 57);\">Glimmer</span>\n    <span style=\"font-size: 40px; color: rgb(161, 63, 43);\">Visualizer</span>\n  </h1>\n\n  <div class=\"input-group\">\n    <label for=\"data\">Data</label>\n    <textarea id=\"data\" wrap=\"off\">{{data}}</textarea>\n  </div>\n\n  <div class=\"input-group\">\n    <label for=\"top-level-template\">Top-Level Template</label>\n    <textarea id=\"top-level-template\" wrap=\"off\" readOnly={{if rendered true false}}>{{template.source}}</textarea>\n  </div>\n\n  <div class=\"input-group\">\n    <label for=\"component-layout\">&lt;h-card&gt; Layout</label>\n    <textarea id=\"component-layout\" wrap=\"off\" readOnly={{if rendered true false}}>{{layout.source}}</textarea>\n  </div>\n\n  <button id=\"btn-render\" class=\"primary\" style=\"display: {{if rendered 'none' 'block'}}\">Render</button>\n  <button id=\"btn-update\" class=\"primary\" style=\"display: {{if rendered 'block' 'none'}}\">Update</button>\n  <button id=\"btn-edit\" style=\"display: {{if rendered 'block' 'none'}}\">Edit</button>\n  <button id=\"btn-reset\">Reset</button>\n</div>\n{{#if rendered}}\n  <div id=\"output\">\n    <div id=\"wire-format\">\n      <div class=\"header\">Wire Format (Top-Level)</div>\n      <wire-format-inspector class=\"content\" @spec={{template.wireFormat}} />\n      <div class=\"header secondary\">Wire Format (&lt;h-card&gt;)</div>\n      <wire-format-inspector class=\"content\" @spec={{layout.wireFormat}} />\n    </div>\n    <div id=\"initial\">\n      <div class=\"header\">Opcodes (Top-Level)</div>\n      <div class=\"content\">\n        <h3>Opcodes</h3>\n        <ol>\n          {{#each template.opcodes key=\"guid\" as |opcode|}}\n            <opcode-inspector @opcode={{opcode}} />\n          {{/each}}\n        </ol>\n      </div>\n      <div class=\"header secondary\">Opcodes (&lt;h-card&gt;)</div>\n      <div class=\"content\">\n        <h3>Opcodes</h3>\n        <ol>\n          {{#each layout.opcodes key=\"guid\" as |opcode|}}\n            <opcode-inspector @opcode={{opcode}} />\n          {{/each}}\n        </ol>\n      </div>\n    </div>\n    <div id=\"updating\">\n      <div class=\"header\">Updating Opcodes</div>\n      <div class=\"content full-height\">\n        <h3>Opcodes</h3>\n        <ol>\n          {{#each updatingOpcodes key=\"guid\" as |opcode|}}\n            <opcode-inspector @opcode={{opcode}} />\n          {{/each}}\n        </ol>\n      </div>\n    </div>\n    <div id=\"dom\">\n      <div class=\"header\">DOM</div>\n      <div class=\"content rendered\">{{{html}}}</div>\n      <div class=\"header secondary\">HTML</div>\n      <pre class=\"content secondary source\">{{html}}</pre>\n    </div>\n  </div>\n{{/if}}";
function compile(str, env) {
    var spec = JSON.parse(compiler_1.precompile(str, {}));
    var factory = runtime_1.templateFactory(spec);
    return factory.create(env);
}
var $inputs, $data, $template, $layout, $render, $update, $edit, $reset;
var ui = {
    rendered: false,
    data: DEFAULT_DATA,
    template: {
        source: DEFAULT_TEMPLATE,
        wireFormat: null,
        opcodes: null
    },
    layout: {
        source: DEFAULT_LAYOUT,
        wireFormat: null,
        opcodes: null
    },
    updatingOpcodes: null,
    html: ""
};
function init() {
    renderUI();
    bindUI();
    wireUI();
}
exports.init = init;
var rerenderUI;
function renderUI() {
    var env = new test_helpers_1.TestEnvironment();
    env.registerHelper("json", function (_a) {
        var value = _a[0];
        return JSON.stringify(value);
    });
    env.registerEmberishGlimmerComponent("wire-format-inspector", null, "<div>\n  <h3>Statements</h3>\n  <ol>\n    {{#each @spec.statements key=\"@index\" as |statement|}}\n      <li><span class=\"pre\">{{json statement}}</span></li>\n    {{/each}}\n  </ol>\n  <hr />\n  {{#if @spec.locals}}\n    <h3>Locals</h3>\n    <ol>\n      {{#each @spec.locals key=\"@index\" as |local|}}\n        <li><span class=\"pre\">{{json local}}</span></li>\n      {{/each}}\n    </ol>\n    <hr />\n  {{/if}}\n  {{#if @spec.named}}\n    <h3>Named</h3>\n    <ol>\n      {{#each @spec.named key=\"@index\" as |name|}}\n        <li><span class=\"pre\">{{json name}}</span></li>\n      {{/each}}\n    </ol>\n    <hr />\n  {{/if}}\n  {{#if @spec.yields}}\n    <h3>Yields</h3>\n    <ol>\n      {{#each @spec.yields key=\"@index\" as |yield|}}\n        <li><span class=\"pre\">{{json yield}}</span></li>\n      {{/each}}\n    </ol>\n    <hr />\n  {{/if}}\n  {{#if @spec.blocks}}\n    <h3>Blocks</h3>\n    <ol>\n      {{#each @spec.blocks key=\"@index\" as |block|}}\n        <li>\n          <h3>Block</h3>\n          <wire-format-inspector @spec={{block}} />\n        </li>\n      {{/each}}\n    </ol>\n  {{/if}}\n</div>");
    env.registerHelper("pp-opcode", function (_a) {
        var opcode = _a[0];
        var output = opcode.type.toUpperCase();
        if (opcode.args || opcode.details) {
            output += "(";
            if (opcode.args && opcode.args.length) {
                output += opcode.args.join(", ");
            }
            if (opcode.details) {
                var keys = Object.keys(opcode.details);
                if (keys.length) {
                    if (opcode.args && opcode.args.length) {
                        output += ", ";
                    }
                    output += keys.map(function (key) { return key + "=" + opcode.details[key]; }).join(", ");
                    ;
                }
            }
            output += ")";
        }
        return output;
    });
    env.registerEmberishGlimmerComponent("opcode-inspector", null, "<li>\n  <span class=\"pre\">{{#if @opcode.deopted}}[DEOPT] <del>{{pp-opcode @opcode}}</del>{{else}}{{pp-opcode @opcode}}{{/if}}</span>\n  {{#if @opcode.children}}\n    <ol>\n      {{#each @opcode.children key=\"guid\" as |opcode|}}\n        <opcode-inspector @opcode={{opcode}} />\n      {{/each}}\n    </ol>\n  {{/if}}\n</li>");
    env.begin();
    var self = new object_reference_1.UpdatableReference(ui);
    var res = env.compile(UI).render(self, document.body, new test_helpers_1.TestDynamicScope());
    env.commit();
    rerenderUI = function () {
        self.update(ui);
        env.begin();
        res.rerender();
        env.commit();
    };
}
function bindUI() {
    $inputs = document.querySelectorAll("#inputs")[0];
    $data = document.querySelectorAll("#data")[0];
    $template = document.querySelectorAll("#top-level-template")[0];
    $layout = document.querySelectorAll("#component-layout")[0];
    $render = document.querySelectorAll("#btn-render")[0];
    $update = document.querySelectorAll("#btn-update")[0];
    $edit = document.querySelectorAll("#btn-edit")[0];
    $reset = document.querySelectorAll("#btn-reset")[0];
}
function wireUI() {
    $render.addEventListener("click", renderContent, false);
    $update.addEventListener("click", updateContent, false);
    $edit.addEventListener("click", editContent, false);
    $reset.addEventListener("click", resetContent, false);
    $data.addEventListener("input", storeContent);
    $template.addEventListener("input", storeContent);
    $layout.addEventListener("input", storeContent);
    initContent();
}
function initContent() {
    var _a = getInitialContent(), data = _a.data, template = _a.template, layout = _a.layout;
    $data.value = data;
    $template.value = template;
    $layout.value = layout;
}
var _updateContent = null;
function renderContent() {
    var data = JSON.parse($data.value);
    var env = new test_helpers_1.TestEnvironment();
    env.registerHelper('foo-bar', function () {
        return 'FOO BAR!!!';
    });
    env.registerEmberishGlimmerComponent("h-card", null, $layout.value);
    var app = env.compile($template.value);
    function compileLayout(component) {
        var definition = env.getComponentDefinition([component]);
        var manager = definition.manager;
        var instance = manager.create(env, definition, runtime_1.EvaluatedArgs.empty(), new test_helpers_1.TestDynamicScope(), null, false);
        var compiled = manager.layoutFor(definition, instance, env);
        return compiled.ops;
    }
    function eagerCompile(ops) {
        ops.toArray().forEach(function (op) {
            if (op.block) {
                eagerCompile(op.block.compile(env).ops);
            }
        });
        return ops;
    }
    function toJSON(ops) {
        return ops.toArray().map(function (op) { return op.toJSON(); });
    }
    var div = document.createElement('div');
    env.begin();
    var self = new object_reference_1.UpdatableReference(data);
    var res = app.render(self, div, new test_helpers_1.TestDynamicScope());
    env.commit();
    var entryPoint = app.asEntryPoint();
    var templateOps = entryPoint.compile(env).ops;
    var layoutOps = compileLayout("h-card");
    ui.rendered = true;
    ui.template.source = $template.value;
    ui.template.wireFormat = compile($template.value, env)._block;
    ui.template.opcodes = toJSON(eagerCompile(templateOps));
    ui.layout.source = $layout.value;
    ui.layout.wireFormat = compile($layout.value, env)._block;
    ui.layout.opcodes = toJSON(eagerCompile(layoutOps));
    ui.updatingOpcodes = toJSON(res['updating']);
    ui.html = div.innerHTML;
    window['$UI'] = ui;
    window['$DIV'] = div;
    _updateContent = function () {
        self.update(JSON.parse($data.value));
        env.begin();
        res.rerender();
        env.commit();
        ui.template.opcodes = toJSON(eagerCompile(templateOps));
        ui.layout.opcodes = toJSON(eagerCompile(layoutOps));
        ui.updatingOpcodes = toJSON(res['updating']);
        ui.html = div.innerHTML;
        rerenderUI();
    };
    rerenderUI();
}
function updateContent() {
    _updateContent();
}
function editContent() {
    _updateContent = null;
    ui.rendered = false;
    rerenderUI();
}
function getInitialContent() {
    return getStoredContent() || {
        data: DEFAULT_DATA,
        template: DEFAULT_TEMPLATE,
        layout: DEFAULT_LAYOUT
    };
}
function getStoredContent() {
    var content = localStorage.getItem('glimmer-visualizer:content');
    if (content) {
        return JSON.parse(content);
    }
}
function storeContent() {
    localStorage.setItem('glimmer-visualizer:content', JSON.stringify({
        data: $data.value,
        template: $template.value,
        layout: $layout.value
    }));
}
function resetContent() {
    $data.value = DEFAULT_DATA;
    $template.value = DEFAULT_TEMPLATE;
    $layout.value = DEFAULT_LAYOUT;
    storeContent();
    editContent();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlzdWFsaXplci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImdsaW1tZXItZGVtb3MvbGliL3Zpc3VhbGl6ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHNEQUcrQjtBQUMvQiw4REFBK0Q7QUFDL0QsOENBQStDO0FBRS9DLDRDQUFrRTtBQUVsRSxJQUFNLFlBQVksR0FDbEIsc3VCQWlDRSxDQUFDO0FBRUgsSUFBTSxnQkFBZ0IsR0FDdEIsNklBS08sQ0FBQztBQUVSLElBQU0sY0FBYyxHQUNwQixrbERBbURPLENBQUM7QUFFUixJQUFNLEVBQUUsR0FDUixpd0ZBd0VRLENBQUM7QUFFVCxpQkFBaUIsR0FBVyxFQUFFLEdBQW9CO0lBQ2hELElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMscUJBQVUsQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDLENBQUMsQ0FBQztJQUMzQyxJQUFJLE9BQU8sR0FBRyx5QkFBZSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0FBQzdCLENBQUM7QUFFRCxJQUFJLE9BQWtCLEVBQ2xCLEtBQThCLEVBQzlCLFNBQThCLEVBQzlCLE9BQThCLEVBQzlCLE9BQWtCLEVBQ2xCLE9BQWtCLEVBQ2xCLEtBQWtCLEVBQ2xCLE1BQWtCLENBQUM7QUFFdkIsSUFBSSxFQUFFLEdBQUc7SUFDUCxRQUFRLEVBQUUsS0FBSztJQUNmLElBQUksRUFBRSxZQUFZO0lBQ2xCLFFBQVEsRUFBRTtRQUNSLE1BQU0sRUFBRSxnQkFBZ0I7UUFDeEIsVUFBVSxFQUFFLElBQUk7UUFDaEIsT0FBTyxFQUFFLElBQUk7S0FDZDtJQUNELE1BQU0sRUFBRTtRQUNOLE1BQU0sRUFBRSxjQUFjO1FBQ3RCLFVBQVUsRUFBRSxJQUFJO1FBQ2hCLE9BQU8sRUFBRSxJQUFJO0tBQ2Q7SUFDRCxlQUFlLEVBQUUsSUFBSTtJQUNyQixJQUFJLEVBQUUsRUFB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LEtBQUssQ0FBQyxLQUFLLEdBQUcsWUFBWSxDQUFDO0lBQzNCLFNBQVMsQ0FBQyxLQUFLLEdBQUcsZ0JBQWdCLENBQUM7SUFDbkMsT0FBTyxDQUFDLEtBQUssR0FBRyxjQUFjLENBQUM7SUFFL0IsWUFBWSxFQUFFLENBQUM7SUFDZixXQUFXLEVBQUUsQ0FBQztBQUNoQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgVGVzdEVudmlyb25tZW50LFxuICBUZXN0RHluYW1pY1Njb3BlXG59IGZyb20gJ0BnbGltbWVyL3Rlc3QtaGVscGVycyc7XG5pbXBvcnQgeyBVcGRhdGFibGVSZWZlcmVuY2UgfSBmcm9tICdAZ2xpbW1lci9vYmplY3QtcmVmZXJlbmNlJztcbmltcG9ydCB7IHByZWNvbXBpbGUgfSBmcm9tICdAZ2xpbW1lci9jb21waWxlcic7XG5cbmltcG9ydCB7IEV2YWx1YXRlZEFyZ3MsIHRlbXBsYXRlRmFjdG9yeSB9IGZyb20gJ0BnbGltbWVyL3J1bnRpbWUnO1xuXG5jb25zdCBERUZBVUxUX0RBVEEgPVxuYHtcbiAgXCJjb250YWN0c1wiOiBbXG4gICAge1xuICAgICAgXCJpZFwiOiAxLFxuICAgICAgXCJuYW1lXCI6IHtcbiAgICAgICAgXCJmaXJzdFwiOiBcIkpvaG5cIixcbiAgICAgICAgXCJsYXN0XCI6IFwiQXBwbGVzZWVkXCJcbiAgICAgIH0sXG4gICAgICBcIm9yZ1wiOiBcIkFwcGxlIEluYy5cIixcbiAgICAgIFwiZW1haWxcIjogXCJhcHBsZXNlZWRAYXBwbGUuY29tXCIsXG4gICAgICBcImFkZHJlc3NcIjoge1xuICAgICAgICBcInN0cmVldFwiOiBcIjEgSW5maW5pdGUgTG9vcFwiLFxuICAgICAgICBcImNpdHlcIjogXCJDdXBlcnRpbm9cIixcbiAgICAgICAgXCJzdGF0ZVwiOiBcIkNBXCIsXG4gICAgICAgIFwiemlwXCI6IDk1MDE0LFxuICAgICAgICBcImNvdW50cnlcIjogXCJVU0FcIlxuICAgICAgfSxcbiAgICAgIFwicGhvbmVzXCI6IFtcbiAgICAgICAge1xuICAgICAgICAgIFwidHlwZVwiOiBcIk9mZmljZVwiLFxuICAgICAgICAgIFwibnVtYmVyXCI6IFwiMSAoODAwKSBNWUFQUExFXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIFwidHlwZVwiOiBcIkhvbWVcIixcbiAgICAgICAgICBcIm51bWJlclwiOiBcIig1NTUpIDEyMyA0NTY3XCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIFwidHlwZVwiOiBcIk1vYmlsZVwiLFxuICAgICAgICAgIFwibnVtYmVyXCI6IFwiKDU1NSkgNTU1IDU1NTVcIlxuICAgICAgICB9XG4gICAgICBdXG4gICAgfVxuICBdXG59YDtcblxuY29uc3QgREVGQVVMVF9URU1QTEFURSA9XG5gPGRpdiBjbGFzcz1cImNvbnRhY3RzXCI+XG4gIHt7I2VhY2ggY29udGFjdHMga2V5PVwiaWRcIiBhcyB8Y29udGFjdHx9fVxuICAgIDxoLWNhcmQgQHBlcnNvbj17e2NvbnRhY3R9fSAvPlxuICAgIDxociAvPlxuICB7ey9lYWNofX1cbjwvZGl2PmA7XG5cbmNvbnN0IERFRkFVTFRfTEFZT1VUID1cbmA8ZGl2IGNsYXNzPVwidmNhcmRcIj5cbiAge3sjaWYgQHBlcnNvbi51cmx9fVxuICAgIDxkaXY+XG4gICAgICA8YSBjbGFzcz1cInVybCBmbiBuXCIgaHJlZj1cInt7QHBlcnNvbi51cmx9fVwiPlxuICAgICAge3sjd2l0aCBAcGVyc29uLm5hbWUgYXMgfG5hbWV8fX1cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJnaXZlbi1uYW1lXCI+e3tuYW1lLmZpcnN0fX08L3NwYW4+XG4gICAgICAgIHt7I2lmIG5hbWUubWlkZGxlfX1cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJhZGRpdGlvbmFsLW5hbWVcIj57e25hbWUubWlkZGxlfX08L3NwYW4+XG4gICAgICAgIHt7L2lmfX1cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJmYW1pbHktbmFtZVwiPnt7bmFtZS5sYXN0fX08L3NwYW4+XG4gICAgICB7ey93aXRofX1cbiAgICAgIDwvYT5cbiAgICA8L2Rpdj5cbiAge3tlbHNlfX1cbiAgICA8ZGl2PlxuICAgICAge3sjd2l0aCBAcGVyc29uLm5hbWUgYXMgfG5hbWV8fX1cbiAgICAgICAgPHNwYW4gY2xhc3M9XCJnaXZlbi1uYW1lXCI+e3tuYW1lLmZpcnN0fX08L3NwYW4+XG4gICAgICAgIHt7I2lmIG5hbWUuYWRkaXRpb25hbH19XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiYWRkaXRpb25hbC1uYW1lXCI+e3tuYW1lLm1pZGRsZX19PC9zcGFuPlxuICAgICAgICB7ey9pZn19XG4gICAgICAgIDxzcGFuIGNsYXNzPVwiZmFtaWx5LW5hbWVcIj57e25hbWUubGFzdH19PC9zcGFuPlxuICAgICAge3svd2l0aH19XG4gICAgPC9kaXY+XG4gIHt7L2lmfX1cbiAge3sjaWYgQHBlcnNvbi5vcmd9fVxuICAgIDxkaXYgY2xhc3M9XCJvcmdcIj57e0BwZXJzb24ub3JnfX08L2Rpdj5cbiAge3svaWZ9fVxuICB7eyNpZiBAcGVyc29uLmVtYWlsfX1cbiAgICA8ZGl2PlxuICAgICAgPGEgY2xhc3M9XCJlbWFpbFwiIGhyZWY9XCJtYWlsdG86e3tAcGVyc29uLmVtYWlsfX1cIj5cbiAgICAgICAge3tAcGVyc29uLmVtYWlsfX1cbiAgICAgIDwvYT5cbiAgICA8L2Rpdj5cbiAge3svaWZ9fVxuICB7eyN3aXRoIEBwZXJzb24uYWRkcmVzcyBhcyB8YWRkcmVzc3x9fVxuICAgIDxkaXYgY2xhc3M9XCJhZHJcIj5cbiAgICAgIDxzcGFuIGNsYXNzPVwic3RyZWV0LWFkZHJlc3NcIj57e2FkZHJlc3Muc3RyZWV0fX08L3NwYW4+XG4gICAgICA8YnI+XG4gICAgICA8c3BhbiBjbGFzcz1cImxvY2FsaXR5XCI+e3thZGRyZXNzLmNpdHl9fTwvc3Bhbj4sXG4gICAgICA8c3BhbiBjbGFzcz1cInJlZ2lvblwiPnt7YWRkcmVzcy5zdGF0ZX19PC9zcGFuPlxuICAgICAgPHNwYW4gY2xhc3M9XCJwb3N0YWwtY29kZVwiPnt7YWRkcmVzcy56aXB9fTwvc3Bhbj5cbiAgICAgIDxicj5cbiAgICAgIDxzcGFuIGNsYXNzPVwiY291bnRyeS1uYW1lXCI+e3thZGRyZXNzLmNvdW50cnl9fTwvc3Bhbj5cbiAgICA8L2Rpdj5cbiAge3svd2l0aH19XG4gIHt7I2VhY2ggQHBlcnNvbi5waG9uZXMga2V5PVwidHlwZVwiIGFzIHxwaG9uZXx9fVxuICAgIDxkaXYgY2xhc3M9XCJ0ZWxcIj5cbiAgICAgIDxzcGFuIGNsYXNzPVwidHlwZVwiPnt7cGhvbmUudHlwZX19PC9zcGFuPjpcbiAgICAgIDxzcGFuIGNsYXNzPVwidmFsdWVcIj57e3Bob25lLm51bWJlcn19PC9zcGFuPlxuICAgIDwvZGl2PlxuICB7ey9lYWNofX1cbjwvZGl2PmA7XG5cbmNvbnN0IFVJID1cbmA8ZGl2IGlkPVwiaW5wdXRzXCIgY2xhc3M9XCJ7e2lmIHJlbmRlcmVkICcnICdmdWxsLXdpZHRoJ319XCI+XG4gIDxoMT5cbiAgICA8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogNDhweDsgY29sb3I6IHJnYigyMzgsIDg5LCA1Nyk7XCI+R2xpbW1lcjwvc3Bhbj5cbiAgICA8c3BhbiBzdHlsZT1cImZvbnQtc2l6ZTogNDBweDsgY29sb3I6IHJnYigxNjEsIDYzLCA0Myk7XCI+VmlzdWFsaXplcjwvc3Bhbj5cbiAgPC9oMT5cblxuICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXBcIj5cbiAgICA8bGFiZWwgZm9yPVwiZGF0YVwiPkRhdGE8L2xhYmVsPlxuICAgIDx0ZXh0YXJlYSBpZD1cImRhdGFcIiB3cmFwPVwib2ZmXCI+e3tkYXRhfX08L3RleHRhcmVhPlxuICA8L2Rpdj5cblxuICA8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXBcIj5cbiAgICA8bGFiZWwgZm9yPVwidG9wLWxldmVsLXRlbXBsYXRlXCI+VG9wLUxldmVsIFRlbXBsYXRlPC9sYWJlbD5cbiAgICA8dGV4dGFyZWEgaWQ9XCJ0b3AtbGV2ZWwtdGVtcGxhdGVcIiB3cmFwPVwib2ZmXCIgcmVhZE9ubHk9e3tpZiByZW5kZXJlZCB0cnVlIGZhbHNlfX0+e3t0ZW1wbGF0ZS5zb3VyY2V9fTwvdGV4dGFyZWE+XG4gIDwvZGl2PlxuXG4gIDxkaXYgY2xhc3M9XCJpbnB1dC1ncm91cFwiPlxuICAgIDxsYWJlbCBmb3I9XCJjb21wb25lbnQtbGF5b3V0XCI+Jmx0O2gtY2FyZCZndDsgTGF5b3V0PC9sYWJlbD5cbiAgICA8dGV4dGFyZWEgaWQ9XCJjb21wb25lbnQtbGF5b3V0XCIgd3JhcD1cIm9mZlwiIHJlYWRPbmx5PXt7aWYgcmVuZGVyZWQgdHJ1ZSBmYWxzZX19Pnt7bGF5b3V0LnNvdXJjZX19PC90ZXh0YXJlYT5cbiAgPC9kaXY+XG5cbiAgPGJ1dHRvbiBpZD1cImJ0bi1yZW5kZXJcIiBjbGFzcz1cInByaW1hcnlcIiBzdHlsZT1cImRpc3BsYXk6IHt7aWYgcmVuZGVyZWQgJ25vbmUnICdibG9jayd9fVwiPlJlbmRlcjwvYnV0dG9uPlxuICA8YnV0dG9uIGlkPVwiYnRuLXVwZGF0ZVwiIGNsYXNzPVwicHJpbWFyeVwiIHN0eWxlPVwiZGlzcGxheToge3tpZiByZW5kZXJlZCAnYmxvY2snICdub25lJ319XCI+VXBkYXRlPC9idXR0b24+XG4gIDxidXR0b24gaWQ9XCJidG4tZWRpdFwiIHN0eWxlPVwiZGlzcGxheToge3tpZiByZW5kZXJlZCAnYmxvY2snICdub25lJ319XCI+RWRpdDwvYnV0dG9uPlxuICA8YnV0dG9uIGlkPVwiYnRuLXJlc2V0XCI+UmVzZXQ8L2J1dHRvbj5cbjwvZGl2Plxue3sjaWYgcmVuZGVyZWR9fVxuICA8ZGl2IGlkPVwib3V0cHV0XCI+XG4gICAgPGRpdiBpZD1cIndpcmUtZm9ybWF0XCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiaGVhZGVyXCI+V2lyZSBGb3JtYXQgKFRvcC1MZXZlbCk8L2Rpdj5cbiAgICAgIDx3aXJlLWZvcm1hdC1pbnNwZWN0b3IgY2xhc3M9XCJjb250ZW50XCIgQHNwZWM9e3t0ZW1wbGF0ZS53aXJlRm9ybWF0fX0gLz5cbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXIgc2Vjb25kYXJ5XCI+V2lyZSBGb3JtYXQgKCZsdDtoLWNhcmQmZ3Q7KTwvZGl2PlxuICAgICAgPHdpcmUtZm9ybWF0LWluc3BlY3RvciBjbGFzcz1cImNvbnRlbnRcIiBAc3BlYz17e2xheW91dC53aXJlRm9ybWF0fX0gLz5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGlkPVwiaW5pdGlhbFwiPlxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlclwiPk9wY29kZXMgKFRvcC1MZXZlbCk8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50XCI+XG4gICAgICAgIDxoMz5PcGNvZGVzPC9oMz5cbiAgICAgICAgPG9sPlxuICAgICAgICAgIHt7I2VhY2ggdGVtcGxhdGUub3Bjb2RlcyBrZXk9XCJndWlkXCIgYXMgfG9wY29kZXx9fVxuICAgICAgICAgICAgPG9wY29kZS1pbnNwZWN0b3IgQG9wY29kZT17e29wY29kZX19IC8+XG4gICAgICAgICAge3svZWFjaH19XG4gICAgICAgIDwvb2w+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXIgc2Vjb25kYXJ5XCI+T3Bjb2RlcyAoJmx0O2gtY2FyZCZndDspPC9kaXY+XG4gICAgICA8ZGl2IGNsYXNzPVwiY29udGVudFwiPlxuICAgICAgICA8aDM+T3Bjb2RlczwvaDM+XG4gICAgICAgIDxvbD5cbiAgICAgICAgICB7eyNlYWNoIGxheW91dC5vcGNvZGVzIGtleT1cImd1aWRcIiBhcyB8b3Bjb2RlfH19XG4gICAgICAgICAgICA8b3Bjb2RlLWluc3BlY3RvciBAb3Bjb2RlPXt7b3Bjb2RlfX0gLz5cbiAgICAgICAgICB7ey9lYWNofX1cbiAgICAgICAgPC9vbD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgaWQ9XCJ1cGRhdGluZ1wiPlxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlclwiPlVwZGF0aW5nIE9wY29kZXM8L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50IGZ1bGwtaGVpZ2h0XCI+XG4gICAgICAgIDxoMz5PcGNvZGVzPC9oMz5cbiAgICAgICAgPG9sPlxuICAgICAgICAgIHt7I2VhY2ggdXBkYXRpbmdPcGNvZGVzIGtleT1cImd1aWRcIiBhcyB8b3Bjb2RlfH19XG4gICAgICAgICAgICA8b3Bjb2RlLWluc3BlY3RvciBAb3Bjb2RlPXt7b3Bjb2RlfX0gLz5cbiAgICAgICAgICB7ey9lYWNofX1cbiAgICAgICAgPC9vbD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICAgIDxkaXYgaWQ9XCJkb21cIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJcIj5ET008L2Rpdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJjb250ZW50IHJlbmRlcmVkXCI+e3t7aHRtbH19fTwvZGl2PlxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlciBzZWNvbmRhcnlcIj5IVE1MPC9kaXY+XG4gICAgICA8cHJlIGNsYXNzPVwiY29udGVudCBzZWNvbmRhcnkgc291cmNlXCI+e3todG1sfX08L3ByZT5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG57ey9pZn19YDtcblxuZnVuY3Rpb24gY29tcGlsZShzdHI6IHN0cmluZywgZW52OiBUZXN0RW52aXJvbm1lbnQpIHtcbiAgbGV0IHNwZWMgPSBKU09OLnBhcnNlKHByZWNvbXBpbGUoc3RyLCB7fSkpO1xuICBsZXQgZmFjdG9yeSA9IHRlbXBsYXRlRmFjdG9yeShzcGVjKTtcbiAgcmV0dXJuIGZhY3RvcnkuY3JlYXRlKGVudik7XG59XG5cbmxldCAkaW5wdXRzOiAgIEVsZW1lbnQsXG4gICAgJGRhdGE6ICAgICBIVE1MVGV4dEFyZWFFbGVtZW50LFxuICAgICR0ZW1wbGF0ZTogSFRNTFRleHRBcmVhRWxlbWVudCxcbiAgICAkbGF5b3V0OiAgIEhUTUxUZXh0QXJlYUVsZW1lbnQsXG4gICAgJHJlbmRlcjogICBFbGVtZW50LFxuICAgICR1cGRhdGU6ICAgRWxlbWVudCxcbiAgICAkZWRpdDogICAgIEVsZW1lbnQsXG4gICAgJHJlc2V0OiAgICBFbGVtZW50O1xuXG5sZXQgdWkgPSB7XG4gIHJlbmRlcmVkOiBmYWxzZSxcbiAgZGF0YTogREVGQVVMVF9EQVRBLFxuICB0ZW1wbGF0ZToge1xuICAgIHNvdXJjZTogREVGQVVMVF9URU1QTEFURSxcbiAgICB3aXJlRm9ybWF0OiBudWxsLFxuICAgIG9wY29kZXM6IG51bGxcbiAgfSxcbiAgbGF5b3V0OiB7XG4gICAgc291cmNlOiBERUZBVUxUX0xBWU9VVCxcbiAgICB3aXJlRm9ybWF0OiBudWxsLFxuICAgIG9wY29kZXM6IG51bGxcbiAgfSxcbiAgdXBkYXRpbmdPcGNvZGVzOiBudWxsLFxuICBodG1sOiBcIlwiXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaW5pdCgpIHtcbiAgcmVuZGVyVUkoKTtcbiAgYmluZFVJKCk7XG4gIHdpcmVVSSgpO1xufVxuXG5sZXQgcmVyZW5kZXJVSTtcblxuZnVuY3Rpb24gcmVuZGVyVUkoKSB7XG4gIGxldCBlbnYgPSBuZXcgVGVzdEVudmlyb25tZW50KCk7XG5cbiAgZW52LnJlZ2lzdGVySGVscGVyKFwianNvblwiLCAoW3ZhbHVlXSkgPT4gSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcblxuICBlbnYucmVnaXN0ZXJFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQoXCJ3aXJlLWZvcm1hdC1pbnNwZWN0b3JcIiwgbnVsbCxcbmA8ZGl2PlxuICA8aDM+U3RhdGVtZW50czwvaDM+XG4gIDxvbD5cbiAgICB7eyNlYWNoIEBzcGVjLnN0YXRlbWVudHMga2V5PVwiQGluZGV4XCIgYXMgfHN0YXRlbWVudHx9fVxuICAgICAgPGxpPjxzcGFuIGNsYXNzPVwicHJlXCI+e3tqc29uIHN0YXRlbWVudH19PC9zcGFuPjwvbGk+XG4gICAge3svZWFjaH19XG4gIDwvb2w+XG4gIDxociAvPlxuICB7eyNpZiBAc3BlYy5sb2NhbHN9fVxuICAgIDxoMz5Mb2NhbHM8L2gzPlxuICAgIDxvbD5cbiAgICAgIHt7I2VhY2ggQHNwZWMubG9jYWxzIGtleT1cIkBpbmRleFwiIGFzIHxsb2NhbHx9fVxuICAgICAgICA8bGk+PHNwYW4gY2xhc3M9XCJwcmVcIj57e2pzb24gbG9jYWx9fTwvc3Bhbj48L2xpPlxuICAgICAge3svZWFjaH19XG4gICAgPC9vbD5cbiAgICA8aHIgLz5cbiAge3svaWZ9fVxuICB7eyNpZiBAc3BlYy5uYW1lZH19XG4gICAgPGgzPk5hbWVkPC9oMz5cbiAgICA8b2w+XG4gICAgICB7eyNlYWNoIEBzcGVjLm5hbWVkIGtleT1cIkBpbmRleFwiIGFzIHxuYW1lfH19XG4gICAgICAgIDxsaT48c3BhbiBjbGFzcz1cInByZVwiPnt7anNvbiBuYW1lfX08L3NwYW4+PC9saT5cbiAgICAgIHt7L2VhY2h9fVxuICAgIDwvb2w+XG4gICAgPGhyIC8+XG4gIHt7L2lmfX1cbiAge3sjaWYgQHNwZWMueWllbGRzfX1cbiAgICA8aDM+WWllbGRzPC9oMz5cbiAgICA8b2w+XG4gICAgICB7eyNlYWNoIEBzcGVjLnlpZWxkcyBrZXk9XCJAaW5kZXhcIiBhcyB8eWllbGR8fX1cbiAgICAgICAgPGxpPjxzcGFuIGNsYXNzPVwicHJlXCI+e3tqc29uIHlpZWxkfX08L3NwYW4+PC9saT5cbiAgICAgIHt7L2VhY2h9fVxuICAgIDwvb2w+XG4gICAgPGhyIC8+XG4gIHt7L2lmfX1cbiAge3sjaWYgQHNwZWMuYmxvY2tzfX1cbiAgICA8aDM+QmxvY2tzPC9oMz5cbiAgICA8b2w+XG4gICAgICB7eyNlYWNoIEBzcGVjLmJsb2NrcyBrZXk9XCJAaW5kZXhcIiBhcyB8YmxvY2t8fX1cbiAgICAgICAgPGxpPlxuICAgICAgICAgIDxoMz5CbG9jazwvaDM+XG4gICAgICAgICAgPHdpcmUtZm9ybWF0LWluc3BlY3RvciBAc3BlYz17e2Jsb2NrfX0gLz5cbiAgICAgICAgPC9saT5cbiAgICAgIHt7L2VhY2h9fVxuICAgIDwvb2w+XG4gIHt7L2lmfX1cbjwvZGl2PmApO1xuXG4gIGVudi5yZWdpc3RlckhlbHBlcihcInBwLW9wY29kZVwiLCAoW29wY29kZV0pID0+IHtcbiAgICBsZXQgb3V0cHV0ID0gb3Bjb2RlLnR5cGUudG9VcHBlckNhc2UoKTtcblxuICAgIGlmIChvcGNvZGUuYXJncyB8fCBvcGNvZGUuZGV0YWlscykge1xuICAgICAgb3V0cHV0ICs9IFwiKFwiO1xuXG4gICAgICBpZiAob3Bjb2RlLmFyZ3MgJiYgb3Bjb2RlLmFyZ3MubGVuZ3RoKSB7XG4gICAgICAgIG91dHB1dCArPSBvcGNvZGUuYXJncy5qb2luKFwiLCBcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChvcGNvZGUuZGV0YWlscykge1xuICAgICAgICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKG9wY29kZS5kZXRhaWxzKTtcblxuICAgICAgICBpZiAoa2V5cy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAob3Bjb2RlLmFyZ3MgJiYgb3Bjb2RlLmFyZ3MubGVuZ3RoKSB7XG4gICAgICAgICAgICBvdXRwdXQgKz0gXCIsIFwiO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIG91dHB1dCArPSBrZXlzLm1hcChrZXkgPT4gYCR7a2V5fT0ke29wY29kZS5kZXRhaWxzW2tleV19YCkuam9pbihcIiwgXCIpOztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBvdXRwdXQgKz0gXCIpXCI7XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfSk7XG5cbiAgZW52LnJlZ2lzdGVyRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KFwib3Bjb2RlLWluc3BlY3RvclwiLCBudWxsLFxuYDxsaT5cbiAgPHNwYW4gY2xhc3M9XCJwcmVcIj57eyNpZiBAb3Bjb2RlLmRlb3B0ZWR9fVtERU9QVF0gPGRlbD57e3BwLW9wY29kZSBAb3Bjb2RlfX08L2RlbD57e2Vsc2V9fXt7cHAtb3Bjb2RlIEBvcGNvZGV9fXt7L2lmfX08L3NwYW4+XG4gIHt7I2lmIEBvcGNvZGUuY2hpbGRyZW59fVxuICAgIDxvbD5cbiAgICAgIHt7I2VhY2ggQG9wY29kZS5jaGlsZHJlbiBrZXk9XCJndWlkXCIgYXMgfG9wY29kZXx9fVxuICAgICAgICA8b3Bjb2RlLWluc3BlY3RvciBAb3Bjb2RlPXt7b3Bjb2RlfX0gLz5cbiAgICAgIHt7L2VhY2h9fVxuICAgIDwvb2w+XG4gIHt7L2lmfX1cbjwvbGk+YCk7XG5cbiAgZW52LmJlZ2luKCk7XG4gIGxldCBzZWxmID0gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZSh1aSk7XG4gIGxldCByZXMgPSBlbnYuY29tcGlsZShVSSkucmVuZGVyKHNlbGYsIGRvY3VtZW50LmJvZHksIG5ldyBUZXN0RHluYW1pY1Njb3BlKCkpO1xuICBlbnYuY29tbWl0KCk7XG5cbiAgcmVyZW5kZXJVSSA9ICgpID0+IHtcbiAgICBzZWxmLnVwZGF0ZSh1aSk7XG4gICAgZW52LmJlZ2luKCk7XG4gICAgcmVzLnJlcmVuZGVyKCk7XG4gICAgZW52LmNvbW1pdCgpO1xuICB9O1xufVxuXG5mdW5jdGlvbiBiaW5kVUkoKSB7XG4gICRpbnB1dHMgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjaW5wdXRzXCIpWzBdO1xuICAkZGF0YSAgICAgPSA8SFRNTFRleHRBcmVhRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI2RhdGFcIilbMF07XG4gICR0ZW1wbGF0ZSA9IDxIVE1MVGV4dEFyZWFFbGVtZW50PmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjdG9wLWxldmVsLXRlbXBsYXRlXCIpWzBdO1xuICAkbGF5b3V0ICAgPSA8SFRNTFRleHRBcmVhRWxlbWVudD5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiI2NvbXBvbmVudC1sYXlvdXRcIilbMF07XG4gICRyZW5kZXIgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjYnRuLXJlbmRlclwiKVswXTtcbiAgJHVwZGF0ZSAgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIiNidG4tdXBkYXRlXCIpWzBdO1xuICAkZWRpdCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjYnRuLWVkaXRcIilbMF07XG4gICRyZXNldCAgICA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIjYnRuLXJlc2V0XCIpWzBdO1xufVxuXG5mdW5jdGlvbiB3aXJlVUkoKSB7XG4gICRyZW5kZXIuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJlbmRlckNvbnRlbnQsIGZhbHNlKTtcbiAgJHVwZGF0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdXBkYXRlQ29udGVudCwgZmFsc2UpO1xuICAkZWRpdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZWRpdENvbnRlbnQsIGZhbHNlKTtcbiAgJHJlc2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCByZXNldENvbnRlbnQsIGZhbHNlKTtcblxuICAkZGF0YS5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgc3RvcmVDb250ZW50KTtcbiAgJHRlbXBsYXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBzdG9yZUNvbnRlbnQpO1xuICAkbGF5b3V0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCBzdG9yZUNvbnRlbnQpO1xuXG4gIGluaXRDb250ZW50KCk7XG59XG5cbmZ1bmN0aW9uIGluaXRDb250ZW50KCkge1xuICBsZXQgeyBkYXRhLCB0ZW1wbGF0ZSwgbGF5b3V0IH0gPSBnZXRJbml0aWFsQ29udGVudCgpO1xuICAkZGF0YS52YWx1ZSA9IGRhdGE7XG4gICR0ZW1wbGF0ZS52YWx1ZSA9IHRlbXBsYXRlO1xuICAkbGF5b3V0LnZhbHVlID0gbGF5b3V0O1xufVxuXG5sZXQgX3VwZGF0ZUNvbnRlbnQgPSBudWxsO1xuXG5mdW5jdGlvbiByZW5kZXJDb250ZW50KCkge1xuICBsZXQgZGF0YSA9IEpTT04ucGFyc2UoJGRhdGEudmFsdWUpO1xuXG4gIGxldCBlbnYgPSBuZXcgVGVzdEVudmlyb25tZW50KCk7XG5cbiAgZW52LnJlZ2lzdGVySGVscGVyKCdmb28tYmFyJywgZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gJ0ZPTyBCQVIhISEnO1xuICB9KTtcblxuICBlbnYucmVnaXN0ZXJFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQoXCJoLWNhcmRcIiwgbnVsbCwgJGxheW91dC52YWx1ZSk7XG5cbiAgbGV0IGFwcCA9IGVudi5jb21waWxlKCR0ZW1wbGF0ZS52YWx1ZSk7XG5cbiAgZnVuY3Rpb24gY29tcGlsZUxheW91dChjb21wb25lbnQpIHtcbiAgICBsZXQgZGVmaW5pdGlvbiA9IGVudi5nZXRDb21wb25lbnREZWZpbml0aW9uKFtjb21wb25lbnRdKTtcblxuICAgIGxldCBtYW5hZ2VyID0gZGVmaW5pdGlvbi5tYW5hZ2VyO1xuICAgIGxldCBpbnN0YW5jZSA9IG1hbmFnZXIuY3JlYXRlKGVudiwgZGVmaW5pdGlvbiwgRXZhbHVhdGVkQXJncy5lbXB0eSgpLCBuZXcgVGVzdER5bmFtaWNTY29wZSgpLCBudWxsLCBmYWxzZSk7XG4gICAgbGV0IGNvbXBpbGVkID0gbWFuYWdlci5sYXlvdXRGb3IoZGVmaW5pdGlvbiwgaW5zdGFuY2UsIGVudik7XG5cbiAgICByZXR1cm4gY29tcGlsZWQub3BzO1xuICB9XG5cbiAgZnVuY3Rpb24gZWFnZXJDb21waWxlKG9wcykge1xuICAgIG9wcy50b0FycmF5KCkuZm9yRWFjaChvcCA9PiB7XG4gICAgICBpZiAob3AuYmxvY2spIHtcbiAgICAgICAgZWFnZXJDb21waWxlKG9wLmJsb2NrLmNvbXBpbGUoZW52KS5vcHMpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIG9wcztcbiAgfVxuXG4gIGZ1bmN0aW9uIHRvSlNPTihvcHMpIHtcbiAgICByZXR1cm4gb3BzLnRvQXJyYXkoKS5tYXAob3AgPT4gb3AudG9KU09OKCkpO1xuICB9XG5cbiAgbGV0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gIGVudi5iZWdpbigpO1xuICBsZXQgc2VsZiA9IG5ldyBVcGRhdGFibGVSZWZlcmVuY2UoZGF0YSk7XG4gIGxldCByZXMgPSBhcHAucmVuZGVyKHNlbGYsIGRpdiwgbmV3IFRlc3REeW5hbWljU2NvcGUoKSk7XG4gIGVudi5jb21taXQoKTtcblxuICBsZXQgZW50cnlQb2ludCA9IGFwcC5hc0VudHJ5UG9pbnQoKTtcbiAgbGV0IHRlbXBsYXRlT3BzID0gZW50cnlQb2ludC5jb21waWxlKGVudikub3BzO1xuICBsZXQgbGF5b3V0T3BzID0gY29tcGlsZUxheW91dChcImgtY2FyZFwiKTtcblxuICB1aS5yZW5kZXJlZCA9IHRydWU7XG5cbiAgdWkudGVtcGxhdGUuc291cmNlID0gJHRlbXBsYXRlLnZhbHVlO1xuICB1aS50ZW1wbGF0ZS53aXJlRm9ybWF0ID0gY29tcGlsZSgkdGVtcGxhdGUudmFsdWUsIGVudikuX2Jsb2NrO1xuICB1aS50ZW1wbGF0ZS5vcGNvZGVzID0gdG9KU09OKGVhZ2VyQ29tcGlsZSh0ZW1wbGF0ZU9wcykpO1xuXG4gIHVpLmxheW91dC5zb3VyY2UgPSAkbGF5b3V0LnZhbHVlO1xuICB1aS5sYXlvdXQud2lyZUZvcm1hdCA9IGNvbXBpbGUoJGxheW91dC52YWx1ZSwgZW52KS5fYmxvY2s7XG4gIHVpLmxheW91dC5vcGNvZGVzID0gdG9KU09OKGVhZ2VyQ29tcGlsZShsYXlvdXRPcHMpKTtcblxuICB1aS51cGRhdGluZ09wY29kZXMgPSB0b0pTT04ocmVzWyd1cGRhdGluZyddKTtcblxuICB1aS5odG1sID0gZGl2LmlubmVySFRNTDtcblxuICB3aW5kb3dbJyRVSSddID0gdWk7XG4gIHdpbmRvd1snJERJViddID0gZGl2O1xuXG4gIF91cGRhdGVDb250ZW50ID0gKCkgPT4ge1xuICAgIHNlbGYudXBkYXRlKEpTT04ucGFyc2UoJGRhdGEudmFsdWUpKTtcbiAgICBlbnYuYmVnaW4oKTtcbiAgICByZXMucmVyZW5kZXIoKTtcbiAgICBlbnYuY29tbWl0KCk7XG4gICAgdWkudGVtcGxhdGUub3Bjb2RlcyA9IHRvSlNPTihlYWdlckNvbXBpbGUodGVtcGxhdGVPcHMpKTtcbiAgICB1aS5sYXlvdXQub3Bjb2RlcyA9IHRvSlNPTihlYWdlckNvbXBpbGUobGF5b3V0T3BzKSk7XG4gICAgdWkudXBkYXRpbmdPcGNvZGVzID0gdG9KU09OKHJlc1sndXBkYXRpbmcnXSk7XG4gICAgdWkuaHRtbCA9IGRpdi5pbm5lckhUTUw7XG4gICAgcmVyZW5kZXJVSSgpO1xuICB9O1xuXG4gIHJlcmVuZGVyVUkoKTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ29udGVudCgpIHtcbiAgX3VwZGF0ZUNvbnRlbnQoKTtcbn1cblxuZnVuY3Rpb24gZWRpdENvbnRlbnQoKSB7XG4gIF91cGRhdGVDb250ZW50ID0gbnVsbDtcbiAgdWkucmVuZGVyZWQgPSBmYWxzZTtcbiAgcmVyZW5kZXJVSSgpO1xufVxuXG5mdW5jdGlvbiBnZXRJbml0aWFsQ29udGVudCgpIHtcbiAgcmV0dXJuIGdldFN0b3JlZENvbnRlbnQoKSB8fCB7XG4gICAgZGF0YTogREVGQVVMVF9EQVRBLFxuICAgIHRlbXBsYXRlOiBERUZBVUxUX1RFTVBMQVRFLFxuICAgIGxheW91dDogREVGQVVMVF9MQVlPVVRcbiAgfTtcbn1cblxuZnVuY3Rpb24gZ2V0U3RvcmVkQ29udGVudCgpIHtcbiAgbGV0IGNvbnRlbnQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnZ2xpbW1lci12aXN1YWxpemVyOmNvbnRlbnQnKTtcbiAgaWYgKGNvbnRlbnQpIHtcbiAgICByZXR1cm4gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBzdG9yZUNvbnRlbnQoKSB7XG4gIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdnbGltbWVyLXZpc3VhbGl6ZXI6Y29udGVudCcsIEpTT04uc3RyaW5naWZ5KHtcbiAgICBkYXRhOiAkZGF0YS52YWx1ZSxcbiAgICB0ZW1wbGF0ZTogJHRlbXBsYXRlLnZhbHVlLFxuICAgIGxheW91dDogJGxheW91dC52YWx1ZVxuICB9KSk7XG59XG5cbmZ1bmN0aW9uIHJlc2V0Q29udGVudCgpIHtcbiAgJGRhdGEudmFsdWUgPSBERUZBVUxUX0RBVEE7XG4gICR0ZW1wbGF0ZS52YWx1ZSA9IERFRkFVTFRfVEVNUExBVEU7XG4gICRsYXlvdXQudmFsdWUgPSBERUZBVUxUX0xBWU9VVDtcblxuICBzdG9yZUNvbnRlbnQoKTtcbiAgZWRpdENvbnRlbnQoKTtcbn1cbiJdfQ==