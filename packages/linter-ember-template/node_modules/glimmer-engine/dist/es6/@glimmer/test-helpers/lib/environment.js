import { compileLayout, compileArgs, 
// Environment
Environment, DOMTreeConstruction, DOMChanges, 
// Partials
PartialDefinition, ComponentDefinition, 
// Values
EvaluatedArgs, EvaluatedNamedArgs, BaselineSyntax, 
// References
PrimitiveReference, ConditionalReference, getDynamicVar, isComponentDefinition } from "@glimmer/runtime";
import { compile as rawCompile, compileLayout as rawCompileLayout } from "./helpers";
import { assign, dict, unwrap } from '@glimmer/util';
import GlimmerObject from "@glimmer/object";
import { VOLATILE_TAG, DirtyableTag, isConst } from "@glimmer/reference";
import { UpdatableReference } from "@glimmer/object-reference";
class ArrayIterator {
    constructor(array, keyFor) {
        this.position = 0;
        this.array = array;
        this.keyFor = keyFor;
    }
    isEmpty() {
        return this.array.length === 0;
    }
    next() {
        let { position, array, keyFor } = this;
        if (position >= array.length)
            return null;
        let value = array[position];
        let key = keyFor(value, position);
        let memo = position;
        this.position++;
        return { key, value, memo };
    }
}
class ObjectKeysIterator {
    constructor(keys, values, keyFor) {
        this.position = 0;
        this.keys = keys;
        this.values = values;
        this.keyFor = keyFor;
    }
    isEmpty() {
        return this.keys.length === 0;
    }
    next() {
        let { position, keys, values, keyFor } = this;
        if (position >= keys.length)
            return null;
        let value = values[position];
        let memo = keys[position];
        let key = keyFor(value, memo);
        this.position++;
        return { key, value, memo };
    }
}
class EmptyIterator {
    isEmpty() {
        return true;
    }
    next() {
        throw new Error(`Cannot call next() on an empty iterator`);
    }
}
const EMPTY_ITERATOR = new EmptyIterator();
class Iterable {
    constructor(ref, keyFor) {
        this.tag = ref.tag;
        this.ref = ref;
        this.keyFor = keyFor;
    }
    iterate() {
        let { ref, keyFor } = this;
        let iterable = ref.value();
        if (Array.isArray(iterable)) {
            return iterable.length > 0 ? new ArrayIterator(iterable, keyFor) : EMPTY_ITERATOR;
        }
        else if (iterable === undefined || iterable === null) {
            return EMPTY_ITERATOR;
        }
        else if (iterable.forEach !== undefined) {
            let array = [];
            iterable.forEach(function (item) {
                array.push(item);
            });
            return array.length > 0 ? new ArrayIterator(array, keyFor) : EMPTY_ITERATOR;
        }
        else if (typeof iterable === 'object') {
            let keys = Object.keys(iterable);
            return keys.length > 0 ? new ObjectKeysIterator(keys, keys.map(key => iterable[key]), keyFor) : EMPTY_ITERATOR;
        }
        else {
            throw new Error(`Don't know how to {{#each ${iterable}}}`);
        }
    }
    valueReferenceFor(item) {
        return new UpdatableReference(item.value);
    }
    updateValueReference(reference, item) {
        reference.update(item.value);
    }
    memoReferenceFor(item) {
        return new UpdatableReference(item.memo);
    }
    updateMemoReference(reference, item) {
        reference.update(item.memo);
    }
}
export class BasicComponent {
    constructor(attrs) {
        this.attrs = attrs;
    }
}
export class EmberishCurlyComponent extends GlimmerObject {
    constructor() {
        super(...arguments);
        this.dirtinessTag = new DirtyableTag();
        this.tagName = null;
        this.attributeBindings = null;
        this.parentView = null;
    }
    static create(args) {
        return super.create(args);
    }
    recompute() {
        this.dirtinessTag.dirty();
    }
    didInitAttrs(options) { }
    didUpdateAttrs(diff) { }
    didReceiveAttrs(diff) { }
    willInsertElement() { }
    willUpdate() { }
    willRender() { }
    didInsertElement() { }
    didUpdate() { }
    didRender() { }
}
export class EmberishGlimmerComponent extends GlimmerObject {
    constructor() {
        super(...arguments);
        this.dirtinessTag = new DirtyableTag();
        this.parentView = null;
    }
    static create(args) {
        return super.create(args);
    }
    recompute() {
        this.dirtinessTag.dirty();
    }
    didInitAttrs(options) { }
    didUpdateAttrs(diff) { }
    didReceiveAttrs(diff) { }
    willInsertElement() { }
    willUpdate() { }
    willRender() { }
    didInsertElement() { }
    didUpdate() { }
    didRender() { }
}
class BasicComponentManager {
    prepareArgs(definition, args) {
        return args;
    }
    create(environment, definition, args) {
        let klass = definition.ComponentClass || BasicComponent;
        return new klass(args.named.value());
    }
    layoutFor(definition, component, env) {
        let layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        return env.compiledLayouts[definition.name] = compileLayout(new BasicComponentLayoutCompiler(definition.layoutString), env);
    }
    getSelf(component) {
        return new UpdatableReference(component);
    }
    didCreateElement(component, element) {
        component.element = element;
    }
    didRenderLayout(component, bounds) {
        component.bounds = bounds;
    }
    didCreate() { }
    getTag() {
        return null;
    }
    update(component, attrs) {
        component.attrs = attrs.named.value();
    }
    didUpdateLayout() { }
    didUpdate() { }
    getDestructor() {
        return null;
    }
}
const BASIC_COMPONENT_MANAGER = new BasicComponentManager();
class StaticTaglessComponentManager extends BasicComponentManager {
    layoutFor(definition, component, env) {
        let layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        return env.compiledLayouts[definition.name] = compileLayout(new StaticTaglessComponentLayoutCompiler(definition.layoutString), env);
    }
}
const STATIC_TAGLESS_COMPONENT_MANAGER = new StaticTaglessComponentManager();
const BaseEmberishGlimmerComponent = EmberishGlimmerComponent.extend();
class EmberishGlimmerComponentManager {
    prepareArgs(definition, args) {
        return args;
    }
    create(environment, definition, args, dynamicScope, callerSelf, hasDefaultBlock) {
        let klass = definition.ComponentClass || BaseEmberishGlimmerComponent;
        let attrs = args.named.value();
        let component = klass.create({ attrs });
        component.didInitAttrs({ attrs });
        component.didReceiveAttrs({ oldAttrs: null, newAttrs: attrs });
        component.willInsertElement();
        component.willRender();
        return component;
    }
    layoutFor(definition, component, env) {
        if (env.compiledLayouts[definition.name]) {
            return env.compiledLayouts[definition.name];
        }
        return env.compiledLayouts[definition.name] = compileLayout(new EmberishGlimmerComponentLayoutCompiler(definition.layoutString), env);
    }
    getSelf(component) {
        return new UpdatableReference(component);
    }
    didCreateElement(component, element) {
        component.element = element;
    }
    didRenderLayout(component, bounds) {
        component.bounds = bounds;
    }
    didCreate(component) {
        component.didInsertElement();
        component.didRender();
    }
    getTag(component) {
        return component.dirtinessTag;
    }
    update(component, args) {
        let oldAttrs = component.attrs;
        let newAttrs = args.named.value();
        component.set('attrs', newAttrs);
        component.didUpdateAttrs({ oldAttrs, newAttrs });
        component.didReceiveAttrs({ oldAttrs, newAttrs });
        component.willUpdate();
        component.willRender();
    }
    didUpdateLayout() { }
    didUpdate(component) {
        component.didUpdate();
        component.didRender();
    }
    getDestructor(component) {
        return {
            destroy() {
                component.destroy();
            }
        };
    }
}
export class ProcessedArgs {
    constructor(args, positionalParamsDefinition) {
        this.tag = args.tag;
        this.named = args.named;
        this.positional = args.positional;
        this.positionalParamNames = positionalParamsDefinition;
    }
    value() {
        let { named, positional, positionalParamNames } = this;
        let merged = Object.assign({}, named.value());
        if (positionalParamNames && positionalParamNames.length) {
            for (let i = 0; i < positionalParamNames.length; i++) {
                let name = positionalParamNames[i];
                let reference = positional.at(i);
                merged[name] = reference.value();
            }
        }
        return {
            attrs: merged,
            props: merged
        };
    }
}
function processArgs(args, positionalParamsDefinition) {
    return new ProcessedArgs(args, positionalParamsDefinition);
}
const EMBERISH_GLIMMER_COMPONENT_MANAGER = new EmberishGlimmerComponentManager();
const BaseEmberishCurlyComponent = EmberishCurlyComponent.extend();
class EmberishCurlyComponentManager {
    prepareArgs(definition, args, dynamicScope) {
        let dyn = definition.ComponentClass ? definition.ComponentClass['fromDynamicScope'] : null;
        if (dyn) {
            let map = assign({}, args.named.map);
            dyn.forEach(name => map[name] = dynamicScope.get(name));
            args = EvaluatedArgs.create(args.positional, EvaluatedNamedArgs.create(map), args.blocks);
        }
        return args;
    }
    create(environment, definition, args, dynamicScope, callerSelf) {
        let klass = definition.ComponentClass || BaseEmberishCurlyComponent;
        let processedArgs = processArgs(args, klass['positionalParams']);
        let { attrs } = processedArgs.value();
        let self = callerSelf.value();
        let merged = assign({}, attrs, { attrs }, { args: processedArgs }, { targetObject: self });
        let component = klass.create(merged);
        component.didInitAttrs({ attrs });
        component.didReceiveAttrs({ oldAttrs: null, newAttrs: attrs });
        component.willInsertElement();
        component.willRender();
        return component;
    }
    layoutFor(definition, component, env) {
        let layout = env.compiledLayouts[definition.name];
        if (layout) {
            return layout;
        }
        let layoutString = definition.layoutString;
        let lateBound = !layoutString;
        if (!layoutString && layoutString !== '') {
            layoutString = component['layout'];
        }
        layout = compileLayout(new EmberishCurlyComponentLayoutCompiler(layoutString), env);
        return lateBound ? layout : (env.compiledLayouts[definition.name] = layout);
    }
    getSelf(component) {
        return new UpdatableReference(component);
    }
    didCreateElement(component, element, operations) {
        component.element = element;
        let bindings = component.attributeBindings;
        let rootRef = new UpdatableReference(component);
        if (bindings) {
            for (let i = 0; i < bindings.length; i++) {
                let attribute = bindings[i];
                let reference = rootRef.get(attribute);
                operations.addDynamicAttribute(element, attribute, reference, false);
            }
        }
    }
    didRenderLayout(component, bounds) {
        component.bounds = bounds;
    }
    didCreate(component) {
        component.didInsertElement();
        component.didRender();
    }
    getTag(component) {
        return component.dirtinessTag;
    }
    update(component, args) {
        let oldAttrs = component.attrs;
        let newAttrs = component.args.value().attrs;
        let merged = assign({}, newAttrs, { attrs: newAttrs });
        component.setProperties(merged);
        component.didUpdateAttrs({ oldAttrs, newAttrs });
        component.didReceiveAttrs({ oldAttrs, newAttrs });
        component.willUpdate();
        component.willRender();
    }
    didUpdateLayout() { }
    didUpdate(component) {
        component.didUpdate();
        component.didRender();
    }
    getDestructor(component) {
        return {
            destroy() {
                component.destroy();
            }
        };
    }
}
const EMBERISH_CURLY_COMPONENT_MANAGER = new EmberishCurlyComponentManager();
function emberToBool(value) {
    if (Array.isArray(value)) {
        return value.length > 0;
    }
    else {
        return !!value;
    }
}
class EmberishConditionalReference extends ConditionalReference {
    toBool(value) {
        return emberToBool(value);
    }
}
export class SimplePathReference {
    constructor(parent, property) {
        this.tag = VOLATILE_TAG;
        this.parent = parent;
        this.property = property;
    }
    value() {
        return this.parent.value()[this.property];
    }
    get(prop) {
        return new SimplePathReference(this, prop);
    }
}
class HelperReference {
    constructor(helper, args) {
        this.tag = VOLATILE_TAG;
        this.helper = helper;
        this.args = args;
    }
    value() {
        let { helper, args: { positional, named } } = this;
        return helper(positional.value(), named.value());
    }
    get(prop) {
        return new SimplePathReference(this, prop);
    }
}
class InertModifierManager {
    create() { }
    install(modifier) { }
    update(modifier) { }
    getDestructor(modifier) {
        return null;
    }
}
export class TestModifier {
    constructor(element, args, dom) {
        this.element = element;
        this.args = args;
        this.dom = dom;
    }
}
export class TestModifierManager {
    constructor() {
        this.installedElements = [];
        this.updatedElements = [];
        this.destroyedModifiers = [];
    }
    create(element, args, dynamicScope, dom) {
        return new TestModifier(element, args, dom);
    }
    install({ element, args, dom }) {
        this.installedElements.push(element);
        let param = args.positional.at(0).value();
        dom.setAttribute(element, 'data-modifier', `installed - ${param}`);
        return;
    }
    update({ element, args, dom }) {
        this.updatedElements.push(element);
        let param = args.positional.at(0).value();
        dom.setAttribute(element, 'data-modifier', `updated - ${param}`);
        return;
    }
    getDestructor(modifier) {
        return {
            destroy: () => {
                this.destroyedModifiers.push(modifier);
                let { element, dom } = modifier;
                dom.removeAttribute(element, 'data-modifier');
            }
        };
    }
}
export class TestEnvironment extends Environment {
    constructor(options = {
            document: document,
            appendOperations: new DOMTreeConstruction(document)
        }) {
        super({ appendOperations: options.appendOperations, updateOperations: new DOMChanges(options.document) });
        this.helpers = dict();
        this.modifiers = dict();
        this.partials = dict();
        this.components = dict();
        this.compiledLayouts = dict();
        this.uselessAnchor = options.document.createElement('a');
        this.registerHelper("if", ([cond, yes, no]) => cond ? yes : no);
        this.registerHelper("unless", ([cond, yes, no]) => cond ? no : yes);
        this.registerInternalHelper("-get-dynamic-var", getDynamicVar);
        this.registerModifier("action", new InertModifierManager());
        this.registerInternalHelper("component", (vm, args, symbolTable) => {
            return new DynamicComponentReference(args.positional.at(0), vm.env, symbolTable);
        });
        this.registerInternalHelper("hash", (vm, args) => args.named);
    }
    protocolForURL(url) {
        this.uselessAnchor.href = url;
        return this.uselessAnchor.protocol;
    }
    registerHelper(name, helper) {
        this.helpers[name] = (vm, args) => new HelperReference(helper, args);
    }
    registerInternalHelper(name, helper) {
        this.helpers[name] = helper;
    }
    registerModifier(name, modifier) {
        this.modifiers[name] = modifier;
    }
    registerPartial(name, source) {
        this.partials[name] = new PartialDefinition(name, rawCompile(source, { env: this }));
    }
    registerComponent(name, definition) {
        this.components[name] = definition;
        return definition;
    }
    registerBasicComponent(name, Component, layout) {
        let definition = new BasicComponentDefinition(name, BASIC_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    }
    registerStaticTaglessComponent(name, Component, layout) {
        let definition = new StaticTaglessComponentDefinition(name, STATIC_TAGLESS_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    }
    registerEmberishCurlyComponent(name, Component, layout) {
        let definition = new EmberishCurlyComponentDefinition(name, EMBERISH_CURLY_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    }
    registerEmberishGlimmerComponent(name, Component, layout) {
        let definition = new EmberishGlimmerComponentDefinition(name, EMBERISH_GLIMMER_COMPONENT_MANAGER, Component, layout);
        return this.registerComponent(name, definition);
    }
    toConditionalReference(reference) {
        if (isConst(reference)) {
            return PrimitiveReference.create(emberToBool(reference.value()));
        }
        return new EmberishConditionalReference(reference);
    }
    macros() {
        let macros = super.macros();
        populateBlocks(macros.blocks, macros.inlines);
        return macros;
    }
    hasHelper(helperName) {
        return helperName.length === 1 && (helperName[0] in this.helpers);
    }
    lookupHelper(helperParts) {
        let helperName = helperParts[0];
        let helper = this.helpers[helperName];
        if (!helper)
            throw new Error(`Helper for ${helperParts.join('.')} not found.`);
        return helper;
    }
    hasPartial(partialName) {
        return partialName in this.partials;
    }
    lookupPartial(partialName) {
        let partial = this.partials[partialName];
        return partial;
    }
    hasComponentDefinition(name) {
        return !!this.components[name[0]];
    }
    getComponentDefinition(name, blockMeta) {
        return this.components[name[0]];
    }
    hasModifier(modifierName) {
        return modifierName.length === 1 && (modifierName[0] in this.modifiers);
    }
    lookupModifier(modifierName) {
        let [name] = modifierName;
        let modifier = this.modifiers[name];
        if (!modifier)
            throw new Error(`Modifier for ${modifierName.join('.')} not found.`);
        return modifier;
    }
    compile(template) {
        return rawCompile(template, { env: this });
    }
    compileLayout(template) {
        return rawCompileLayout(template, { env: this });
    }
    iterableFor(ref, args) {
        let keyPath = args.named.get("key").value();
        let keyFor;
        if (!keyPath) {
            throw new Error('Must specify a key for #each');
        }
        switch (keyPath) {
            case '@index':
                keyFor = (_, index) => String(index);
                break;
            case '@primitive':
                keyFor = (item) => String(item);
                break;
            default:
                keyFor = (item) => item[keyPath];
                break;
        }
        return new Iterable(ref, keyFor);
    }
}
export class TestDynamicScope {
    constructor(bucket = null) {
        if (bucket) {
            this.bucket = assign({}, bucket);
        }
        else {
            this.bucket = {};
        }
    }
    get(key) {
        return this.bucket[key];
    }
    set(key, reference) {
        return this.bucket[key] = reference;
    }
    child() {
        return new TestDynamicScope(this.bucket);
    }
}
class DynamicComponentReference {
    constructor(nameRef, env, symbolTable) {
        this.nameRef = nameRef;
        this.env = env;
        this.symbolTable = symbolTable;
        this.tag = nameRef.tag;
    }
    value() {
        let { env, nameRef } = this;
        let nameOrDef = nameRef.value();
        if (typeof nameOrDef === 'string') {
            return env.getComponentDefinition([nameOrDef], this.symbolTable);
        }
        else if (isComponentDefinition(nameOrDef)) {
            return nameOrDef;
        }
        return null;
    }
    get() {
        return null;
    }
}
function dynamicComponentFor(vm, symbolTable) {
    let args = vm.getArgs();
    let nameRef = args.positional.at(0);
    let env = vm.env;
    return new DynamicComponentReference(nameRef, env, symbolTable);
}
;
export class GenericComponentDefinition extends ComponentDefinition {
    constructor(name, manager, ComponentClass, layout) {
        super(name, manager, ComponentClass);
        this.layoutString = layout;
    }
}
export class BasicComponentDefinition extends GenericComponentDefinition {
}
class StaticTaglessComponentDefinition extends GenericComponentDefinition {
}
export class EmberishCurlyComponentDefinition extends GenericComponentDefinition {
}
export class EmberishGlimmerComponentDefinition extends GenericComponentDefinition {
}
class GenericComponentLayoutCompiler {
    constructor(layoutString) {
        this.layoutString = layoutString;
    }
    compileLayout(env) {
        return rawCompileLayout(this.layoutString, { env });
    }
}
class BasicComponentLayoutCompiler extends GenericComponentLayoutCompiler {
    compile(builder) {
        builder.fromLayout(this.compileLayout(builder.env));
    }
}
class StaticTaglessComponentLayoutCompiler extends GenericComponentLayoutCompiler {
    compile(builder) {
        builder.wrapLayout(this.compileLayout(builder.env));
    }
}
function EmberTagName(vm) {
    let self = vm.getSelf().value();
    let tagName = self['tagName'];
    tagName = tagName === '' ? null : self['tagName'] || 'div';
    return PrimitiveReference.create(tagName);
}
function EmberID(vm) {
    let self = vm.getSelf().value();
    return PrimitiveReference.create(`ember${self._guid}`);
}
class EmberishCurlyComponentLayoutCompiler extends GenericComponentLayoutCompiler {
    compile(builder) {
        builder.wrapLayout(this.compileLayout(builder.env));
        builder.tag.dynamic(EmberTagName);
        builder.attrs.static('class', 'ember-view');
        builder.attrs.dynamic('id', EmberID);
    }
}
class EmberishGlimmerComponentLayoutCompiler extends GenericComponentLayoutCompiler {
    compile(builder) {
        builder.fromLayout(this.compileLayout(builder.env));
        builder.attrs.static('class', 'ember-view');
        builder.attrs.dynamic('id', EmberID);
    }
}
export function inspectHooks(ComponentClass) {
    return ComponentClass.extend({
        init() {
            this._super(...arguments);
            this.hooks = {
                didInitAttrs: 0,
                didUpdateAttrs: 0,
                didReceiveAttrs: 0,
                willInsertElement: 0,
                willUpdate: 0,
                willRender: 0,
                didInsertElement: 0,
                didUpdate: 0,
                didRender: 0
            };
        },
        didInitAttrs() {
            this._super(...arguments);
            this.hooks['didInitAttrs']++;
        },
        didUpdateAttrs() {
            this._super(...arguments);
            this.hooks['didUpdateAttrs']++;
        },
        didReceiveAttrs() {
            this._super(...arguments);
            this.hooks['didReceiveAttrs']++;
        },
        willInsertElement() {
            this._super(...arguments);
            this.hooks['willInsertElement']++;
        },
        willUpdate() {
            this._super(...arguments);
            this.hooks['willUpdate']++;
        },
        willRender() {
            this._super(...arguments);
            this.hooks['willRender']++;
        },
        didInsertElement() {
            this._super(...arguments);
            this.hooks['didInsertElement']++;
        },
        didUpdate() {
            this._super(...arguments);
            this.hooks['didUpdate']++;
        },
        didRender() {
            this._super(...arguments);
            this.hooks['didRender']++;
        }
    });
}
const { defaultBlock, inverseBlock, params, hash } = BaselineSyntax.NestedBlock;
function populateBlocks(blocks, inlines) {
    blocks.add('identity', (sexp, builder) => {
        builder.evaluate(sexp[4]);
    });
    blocks.add('render-inverse', (sexp, builder) => {
        builder.evaluate(sexp[5]);
    });
    blocks.add('-with-dynamic-vars', (sexp, builder) => {
        let block = defaultBlock(sexp);
        let args = compileArgs(params(sexp), hash(sexp), builder);
        builder.unit(b => {
            b.putArgs(args);
            b.pushDynamicScope();
            b.bindDynamicScope(args.named.keys);
            b.evaluate(unwrap(block));
            b.popDynamicScope();
        });
    });
    blocks.add('-in-element', (sexp, builder) => {
        let block = defaultBlock(sexp);
        let args = compileArgs(params(sexp), hash(sexp), builder);
        builder.putArgs(args);
        builder.test('simple');
        builder.labelled(null, b => {
            b.jumpUnless('END');
            b.pushRemoteElement();
            b.evaluate(unwrap(block));
            b.popRemoteElement();
        });
    });
    blocks.add('component', (sexp, builder) => {
        let [, path, params, hash, _default, inverse] = sexp;
        let definitionArgs = [params.slice(0, 1), null, null, null];
        let args = [params.slice(1), hash, _default, inverse];
        builder.component.dynamic(definitionArgs, dynamicComponentFor, args, builder.symbolTable);
        return true;
    });
    blocks.addMissing((sexp, builder) => {
        let [, path, params, hash, _default, inverse] = sexp;
        let table = builder.symbolTable;
        if (!params) {
            params = [];
        }
        if (path.length > 1) {
            let definitionArgs = [[['get', path]], hash, _default, inverse];
            let args = [params, hash, _default, inverse];
            builder.component.dynamic(definitionArgs, dynamicComponentFor, args, table);
            return true;
        }
        let definition = builder.env.getComponentDefinition(path, builder.symbolTable);
        if (definition) {
            builder.component.static(definition, [params, hash, _default, inverse], table);
            return true;
        }
        return false;
    });
    inlines.add('component', (path, params, hash, builder) => {
        let definitionArgs = [params.slice(0, 1), null, null, null];
        let args = [params.slice(1), hash, null, null];
        builder.component.dynamic(definitionArgs, dynamicComponentFor, args, builder.symbolTable);
        return true;
    });
    inlines.addMissing((path, params, hash, builder) => {
        let table = builder.symbolTable;
        let definition = builder.env.getComponentDefinition(path, builder.symbolTable);
        if (path.length > 1) {
            let definitionArgs = [[['get', path]], hash, null, null];
            let args = [params, hash, null, null];
            builder.component.dynamic(definitionArgs, dynamicComponentFor, args, table);
            return true;
        }
        if (definition) {
            builder.component.static(definition, [params, hash, null, null], table);
            return true;
        }
        return false;
    });
    return { blocks, inlines };
}
export function equalsElement(element, tagName, attributes, content) {
    QUnit.push(element.tagName === tagName.toUpperCase(), element.tagName.toLowerCase(), tagName, `expect tagName to be ${tagName}`);
    let expectedAttrs = dict();
    let expectedCount = 0;
    for (let prop in attributes) {
        expectedCount++;
        let expected = attributes[prop];
        let matcher = typeof expected === 'object' && MATCHER in expected ? expected : equalsAttr(expected);
        expectedAttrs[prop] = matcher;
        QUnit.push(expectedAttrs[prop].match(element.getAttribute(prop)), matcher.fail(element.getAttribute(prop)), matcher.fail(element.getAttribute(prop)), `Expected element's ${prop} attribute ${matcher.expected()}`);
    }
    let actualAttributes = {};
    for (let i = 0, l = element.attributes.length; i < l; i++) {
        actualAttributes[element.attributes[i].name] = element.attributes[i].value;
    }
    if (!(element instanceof HTMLElement)) {
        QUnit.push(element instanceof HTMLElement, null, null, "Element must be an HTML Element, not an SVG Element");
    }
    else {
        QUnit.push(element.attributes.length === expectedCount, element.attributes.length, expectedCount, `Expected ${expectedCount} attributes; got ${element.outerHTML}`);
        if (content !== null) {
            QUnit.push(element.innerHTML === content, element.innerHTML, content, `The element had '${content}' as its content`);
        }
    }
}
export const MATCHER = "3d4ef194-13be-4ccf-8dc7-862eea02c93e";
export function equalsAttr(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match(actual) {
            return expected === actual;
        },
        expected() {
            return `to equal ${expected}`;
        },
        fail(actual) {
            return `${actual} did not equal ${expected}`;
        }
    };
}
export function equals(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match(actual) {
            return expected === actual;
        },
        expected() {
            return `to equal ${expected}`;
        },
        fail(actual) {
            return `${actual} did not equal ${expected}`;
        }
    };
}
export function regex(r) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match(v) {
            return r.test(v);
        },
        expected() {
            return `to match ${r}`;
        },
        fail(actual) {
            return `${actual} did not match ${r}`;
        }
    };
}
export function classes(expected) {
    return {
        "3d4ef194-13be-4ccf-8dc7-862eea02c93e": true,
        match(actual) {
            return actual && (expected.split(' ').sort().join(' ') === actual.split(' ').sort().join(' '));
        },
        expected() {
            return `to include '${expected}'`;
        },
        fail(actual) {
            return `'${actual}'' did not match '${expected}'`;
        }
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZW52aXJvbm1lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJAZ2xpbW1lci90ZXN0LWhlbHBlcnMvbGliL2Vudmlyb25tZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFRTCxhQUFhLEVBQ2IsV0FBVztBQUVYLGNBQWM7QUFDZCxXQUFXLEVBR1gsbUJBQW1CLEVBQ25CLFVBQVU7QUFHVixXQUFXO0FBQ1gsaUJBQWlCLEVBS2pCLG1CQUFtQjtBQUluQixTQUFTO0FBQ1QsYUFBYSxFQUNiLGtCQUFrQixFQVFsQixjQUFjO0FBRWQsYUFBYTtBQUNiLGtCQUFrQixFQUNsQixvQkFBb0IsRUFRcEIsYUFBYSxFQUliLHFCQUFxQixFQUN0QixNQUFNLGtCQUFrQixDQUFDO0FBRTFCLE9BQU8sRUFDTCxPQUFPLElBQUksVUFBVSxFQUNyQixhQUFhLElBQUksZ0JBQWdCLEVBQ2xDLE1BQU0sV0FBVyxDQUFDO0FBRW5CLE9BQU8sRUFLTCxNQUFNLEVBQ04sSUFBSSxFQUNKLE1BQU0sRUFDUCxNQUFNLGVBQWUsQ0FBQztBQUV2QixPQUFPLGFBQXVDLE1BQU0saUJBQWlCLENBQUM7QUFFdEUsT0FBTyxFQUNMLFlBQVksRUFDWixZQUFZLEVBUVosT0FBTyxFQUNSLE1BQU0sb0JBQW9CLENBQUM7QUFFNUIsT0FBTyxFQUNMLGtCQUFrQixFQUNuQixNQUFNLDJCQUEyQixDQUFDO0FBY25DO0lBS0UsWUFBWSxLQUFlLEVBQUUsTUFBc0I7UUFGM0MsYUFBUSxHQUFHLENBQUMsQ0FBQztRQUduQixJQUFJLENBQUMsS0FBSyxHQUFHLEtBQUssQ0FBQztRQUNuQixJQUFJLENBQUMsTUFBTSxHQUFHLE1BQU0sQ0FBQztJQUN2QixDQUFDO0lBRUQsT0FBTztRQUNMLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sS0FBSyxDQUFDLENBQUM7SUFDakMsQ0FBQztJQUVELElBQUk7UUFDRixJQUFJLEVBQUUsUUFBUSxFQUFFLEtBQUss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TUFBTSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztRQUNqRyxDQUFDO1FBQ0QsUUFBUTtZQUNOLE1BQU0sQ0FBQyxlQUFlLFFBQVEsR0FBRyxDQUFDO1FBQ3BDLENBQUM7UUFDRCxJQUFJLENBQUMsTUFBTTtZQUNULE1BQU0sQ0FBQyxJQUFJLE1BQU0scUJBQXFCLFFBQVEsR0FBRyxDQUFDO1FBQ3BELENBQUM7S0FDRixDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIC8vIFZNXG4gIFZNLFxuICBEeW5hbWljU2NvcGUsXG5cbiAgLy8gQ29tcGlsZXJcbiAgQ29tcGlsZWRQcm9ncmFtLFxuICBDb21waWxhYmxlTGF5b3V0LFxuICBjb21waWxlTGF5b3V0LFxuICBjb21waWxlQXJncyxcblxuICAvLyBFbnZpcm9ubWVudFxuICBFbnZpcm9ubWVudCxcbiAgSGVscGVyIGFzIEdsaW1tZXJIZWxwZXIsXG4gIE1vZGlmaWVyTWFuYWdlcixcbiAgRE9NVHJlZUNvbnN0cnVjdGlvbixcbiAgRE9NQ2hhbmdlcyxcbiAgSURPTUNoYW5nZXMsXG5cbiAgLy8gUGFydGlhbHNcbiAgUGFydGlhbERlZmluaXRpb24sXG5cbiAgLy8gQ29tcG9uZW50c1xuICBDb21wb25lbnQsXG4gIENvbXBvbmVudE1hbmFnZXIsXG4gIENvbXBvbmVudERlZmluaXRpb24sXG4gIENvbXBvbmVudExheW91dEJ1aWxkZXIsXG4gIENvbXBvbmVudEJ1aWxkZXIsXG5cbiAgLy8gVmFsdWVzXG4gIEV2YWx1YXRlZEFyZ3MsXG4gIEV2YWx1YXRlZE5hbWVkQXJncyxcbiAgRXZhbHVhdGVkUG9zaXRpb25hbEFyZ3MsXG5cbiAgLy8gU3ludGF4IENsYXNzZXNcbiAgQmxvY2tNYWNyb3MsXG4gIElubGluZU1hY3JvcyxcbiAgTmVzdGVkQmxvY2tTeW50YXgsXG4gIENvbXBpbGVCbG9ja01hY3JvLFxuICBCYXNlbGluZVN5bnRheCxcblxuICAvLyBSZWZlcmVuY2VzXG4gIFByaW1pdGl2ZVJlZmVyZW5jZSxcbiAgQ29uZGl0aW9uYWxSZWZlcmVuY2UsXG5cbiAgLy8gTWlzY1xuICBCb3VuZHMsXG4gIEVsZW1lbnRPcGVyYXRpb25zLFxuICBGdW5jdGlvbkV4cHJlc3Npb24sXG4gIE9wY29kZUJ1aWxkZXJEU0wsXG4gIFNpbXBsZSxcbiAgZ2V0RHluYW1pY1ZhcixcblxuICBUZW1wbGF0ZSxcbiAgTGF5b3V0LFxuICBpc0NvbXBvbmVudERlZmluaXRpb25cbn0gZnJvbSBcIkBnbGltbWVyL3J1bnRpbWVcIjtcblxuaW1wb3J0IHtcbiAgY29tcGlsZSBhcyByYXdDb21waWxlLFxuICBjb21waWxlTGF5b3V0IGFzIHJhd0NvbXBpbGVMYXlvdXRcbn0gZnJvbSBcIi4vaGVscGVyc1wiO1xuXG5pbXBvcnQge1xuICBEZXN0cm95YWJsZSxcbiAgRGljdCxcbiAgT3BhcXVlLFxuICBGSVhNRSxcbiAgYXNzaWduLFxuICBkaWN0LFxuICB1bndyYXBcbn0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmltcG9ydCBHbGltbWVyT2JqZWN0LCB7IEdsaW1tZXJPYmplY3RGYWN0b3J5IH0gZnJvbSBcIkBnbGltbWVyL29iamVjdFwiO1xuXG5pbXBvcnQge1xuICBWT0xBVElMRV9UQUcsXG4gIERpcnR5YWJsZVRhZyxcbiAgUmV2aXNpb25UYWcsXG4gIFJlZmVyZW5jZSxcbiAgUGF0aFJlZmVyZW5jZSxcbiAgT3BhcXVlSXRlcmF0b3IsXG4gIE9wYXF1ZUl0ZXJhYmxlLFxuICBBYnN0cmFjdEl0ZXJhYmxlLFxuICBJdGVyYXRpb25JdGVtLFxuICBpc0NvbnN0XG59IGZyb20gXCJAZ2xpbW1lci9yZWZlcmVuY2VcIjtcblxuaW1wb3J0IHtcbiAgVXBkYXRhYmxlUmVmZXJlbmNlXG59IGZyb20gXCJAZ2xpbW1lci9vYmplY3QtcmVmZXJlbmNlXCI7XG5cbmltcG9ydCB7XG4gIFN5bWJvbFRhYmxlXG59IGZyb20gJ0BnbGltbWVyL2ludGVyZmFjZXMnO1xuXG5pbXBvcnQgKiBhcyBXaXJlRm9ybWF0IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcblxuaW1wb3J0IHtcbiAgVGVtcGxhdGVNZXRhLFxufSBmcm9tIFwiQGdsaW1tZXIvd2lyZS1mb3JtYXRcIjtcblxudHlwZSBLZXlGb3I8VD4gPSAoaXRlbTogT3BhcXVlLCBpbmRleDogVCkgPT4gc3RyaW5nO1xuXG5jbGFzcyBBcnJheUl0ZXJhdG9yIGltcGxlbWVudHMgT3BhcXVlSXRlcmF0b3Ige1xuICBwcml2YXRlIGFycmF5OiBPcGFxdWVbXTtcbiAgcHJpdmF0ZSBrZXlGb3I6IEtleUZvcjxudW1iZXI+O1xuICBwcml2YXRlIHBvc2l0aW9uID0gMDtcblxuICBjb25zdHJ1Y3RvcihhcnJheTogT3BhcXVlW10sIGtleUZvcjogS2V5Rm9yPG51bWJlcj4pIHtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG4gICAgdGhpcy5rZXlGb3IgPSBrZXlGb3I7XG4gIH1cblxuICBpc0VtcHR5KCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmFycmF5Lmxlbmd0aCA9PT0gMDtcbiAgfVxuXG4gIG5leHQoKTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIG51bWJlcj4ge1xuICAgIGxldCB7IHBvc2l0aW9uLCBhcnJheSwga2V5Rm9yIH0gPSB0aGlzO1xuXG4gICAgaWYgKHBvc2l0aW9uID49IGFycmF5Lmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICBsZXQgdmFsdWUgPSBhcnJheVtwb3NpdGlvbl07XG4gICAgbGV0IGtleSA9IGtleUZvcih2YWx1ZSwgcG9zaXRpb24pO1xuICAgIGxldCBtZW1vID0gcG9zaXRpb247XG5cbiAgICB0aGlzLnBvc2l0aW9uKys7XG5cbiAgICByZXR1cm4geyBrZXksIHZhbHVlLCBtZW1vIH07XG4gIH1cbn1cblxuY2xhc3MgT2JqZWN0S2V5c0l0ZXJhdG9yIGltcGxlbWVudHMgT3BhcXVlSXRlcmF0b3Ige1xuICBwcml2YXRlIGtleXM6IHN0cmluZ1tdO1xuICBwcml2YXRlIHZhbHVlczogT3BhcXVlW107XG4gIHByaXZhdGUga2V5Rm9yOiBLZXlGb3I8c3RyaW5nPjtcbiAgcHJpdmF0ZSBwb3NpdGlvbiA9IDA7XG5cbiAgY29uc3RydWN0b3Ioa2V5czogc3RyaW5nW10sIHZhbHVlczogT3BhcXVlW10sIGtleUZvcjogS2V5Rm9yPHN0cmluZz4pIHtcbiAgICB0aGlzLmtleXMgPSBrZXlzO1xuICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgIHRoaXMua2V5Rm9yID0ga2V5Rm9yO1xuICB9XG5cbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5rZXlzLmxlbmd0aCA9PT0gMDtcbiAgfVxuXG4gIG5leHQoKTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIHN0cmluZz4ge1xuICAgIGxldCB7IHBvc2l0aW9uLCBrZXlzLCB2YWx1ZXMsIGtleUZvciB9ID0gdGhpcztcblxuICAgIGlmIChwb3NpdGlvbiA+PSBrZXlzLmxlbmd0aCkgcmV0dXJuIG51bGw7XG5cbiAgICBsZXQgdmFsdWUgPSB2YWx1ZXNbcG9zaXRpb25dO1xuICAgIGxldCBtZW1vID0ga2V5c1twb3NpdGlvbl07XG4gICAgbGV0IGtleSA9IGtleUZvcih2YWx1ZSwgbWVtbyk7XG5cbiAgICB0aGlzLnBvc2l0aW9uKys7XG5cbiAgICByZXR1cm4geyBrZXksIHZhbHVlLCBtZW1vIH07XG4gIH1cbn1cblxuY2xhc3MgRW1wdHlJdGVyYXRvciBpbXBsZW1lbnRzIE9wYXF1ZUl0ZXJhdG9yIHtcbiAgaXNFbXB0eSgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIG5leHQoKTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIE9wYXF1ZT4ge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ2Fubm90IGNhbGwgbmV4dCgpIG9uIGFuIGVtcHR5IGl0ZXJhdG9yYCk7XG4gIH1cbn1cblxuY29uc3QgRU1QVFlfSVRFUkFUT1IgPSBuZXcgRW1wdHlJdGVyYXRvcigpO1xuXG5jbGFzcyBJdGVyYWJsZSBpbXBsZW1lbnRzIEFic3RyYWN0SXRlcmFibGU8T3BhcXVlLCBPcGFxdWUsIEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBPcGFxdWU+LCBVcGRhdGFibGVSZWZlcmVuY2U8T3BhcXVlPiwgVXBkYXRhYmxlUmVmZXJlbmNlPE9wYXF1ZT4+IHtcbiAgcHVibGljIHRhZzogUmV2aXNpb25UYWc7XG4gIHByaXZhdGUgcmVmOiBSZWZlcmVuY2U8T3BhcXVlPjtcbiAgcHJpdmF0ZSBrZXlGb3I6IEtleUZvcjxPcGFxdWU+O1xuXG4gIGNvbnN0cnVjdG9yKHJlZjogUmVmZXJlbmNlPE9wYXF1ZT4sIGtleUZvcjogS2V5Rm9yPE9wYXF1ZT4pIHtcbiAgICB0aGlzLnRhZyA9IHJlZi50YWc7XG4gICAgdGhpcy5yZWYgPSByZWY7XG4gICAgdGhpcy5rZXlGb3IgPSBrZXlGb3I7XG4gIH1cblxuICBpdGVyYXRlKCk6IE9wYXF1ZUl0ZXJhdG9yIHtcbiAgICBsZXQgeyByZWYsIGtleUZvciB9ID0gdGhpcztcblxuICAgIGxldCBpdGVyYWJsZSA9IHJlZi52YWx1ZSgpIGFzIGFueTtcblxuICAgIGlmIChBcnJheS5pc0FycmF5KGl0ZXJhYmxlKSkge1xuICAgICAgcmV0dXJuIGl0ZXJhYmxlLmxlbmd0aCA+IDAgPyBuZXcgQXJyYXlJdGVyYXRvcihpdGVyYWJsZSwga2V5Rm9yKSA6IEVNUFRZX0lURVJBVE9SO1xuICAgIH0gZWxzZSBpZiAoaXRlcmFibGUgPT09IHVuZGVmaW5lZCB8fCBpdGVyYWJsZSA9PT0gbnVsbCkge1xuICAgICAgcmV0dXJuIEVNUFRZX0lURVJBVE9SO1xuICAgIH0gZWxzZSBpZiAoaXRlcmFibGUuZm9yRWFjaCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBsZXQgYXJyYXkgPSBbXTtcbiAgICAgIGl0ZXJhYmxlLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICBhcnJheS5wdXNoKGl0ZW0pO1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gYXJyYXkubGVuZ3RoID4gMCA/IG5ldyBBcnJheUl0ZXJhdG9yKGFycmF5LCBrZXlGb3IpIDogRU1QVFlfSVRFUkFUT1I7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgaXRlcmFibGUgPT09ICdvYmplY3QnKSB7XG4gICAgICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyhpdGVyYWJsZSk7XG4gICAgICAgcmV0dXJuIGtleXMubGVuZ3RoID4gMCA/IG5ldyBPYmplY3RLZXlzSXRlcmF0b3Ioa2V5cywga2V5cy5tYXAoa2V5ID0+IGl0ZXJhYmxlW2tleV0pLCBrZXlGb3IpIDogRU1QVFlfSVRFUkFUT1I7XG4gICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYERvbid0IGtub3cgaG93IHRvIHt7I2VhY2ggJHtpdGVyYWJsZX19fWApO1xuICAgIH1cbiAgfVxuXG4gIHZhbHVlUmVmZXJlbmNlRm9yKGl0ZW06IEl0ZXJhdGlvbkl0ZW08T3BhcXVlLCBPcGFxdWU+KTogVXBkYXRhYmxlUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBuZXcgVXBkYXRhYmxlUmVmZXJlbmNlKGl0ZW0udmFsdWUpO1xuICB9XG5cbiAgdXBkYXRlVmFsdWVSZWZlcmVuY2UocmVmZXJlbmNlOiBVcGRhdGFibGVSZWZlcmVuY2U8T3BhcXVlPiwgaXRlbTogSXRlcmF0aW9uSXRlbTxPcGFxdWUsIE9wYXF1ZT4pIHtcbiAgICByZWZlcmVuY2UudXBkYXRlKGl0ZW0udmFsdWUpO1xuICB9XG5cbiAgbWVtb1JlZmVyZW5jZUZvcihpdGVtOiBJdGVyYXRpb25JdGVtPE9wYXF1ZSwgT3BhcXVlPik6IFVwZGF0YWJsZVJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShpdGVtLm1lbW8pO1xuICB9XG5cbiAgdXBkYXRlTWVtb1JlZmVyZW5jZShyZWZlcmVuY2U6IFVwZGF0YWJsZVJlZmVyZW5jZTxPcGFxdWU+LCBpdGVtOiBJdGVyYXRpb25JdGVtPE9wYXF1ZSwgT3BhcXVlPikge1xuICAgIHJlZmVyZW5jZS51cGRhdGUoaXRlbS5tZW1vKTtcbiAgfVxufVxuXG5leHBvcnQgdHlwZSBBdHRycyA9IERpY3Q8YW55PjtcbmV4cG9ydCB0eXBlIEF0dHJzRGlmZiA9IHsgb2xkQXR0cnM6IEF0dHJzLCBuZXdBdHRyczogQXR0cnMgfTtcblxuZXhwb3J0IGNsYXNzIEJhc2ljQ29tcG9uZW50IHtcbiAgcHVibGljIGF0dHJzOiBBdHRycztcbiAgcHVibGljIGVsZW1lbnQ6IEVsZW1lbnQ7XG4gIHB1YmxpYyBib3VuZHM6IEJvdW5kcztcblxuICBjb25zdHJ1Y3RvcihhdHRyczogQXR0cnMpIHtcbiAgICB0aGlzLmF0dHJzID0gYXR0cnM7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEVtYmVyaXNoQ3VybHlDb21wb25lbnQgZXh0ZW5kcyBHbGltbWVyT2JqZWN0IHtcbiAgcHVibGljIGRpcnRpbmVzc1RhZyA9IG5ldyBEaXJ0eWFibGVUYWcoKTtcbiAgcHVibGljIHRhZ05hbWU6IHN0cmluZyA9IG51bGw7XG4gIHB1YmxpYyBhdHRyaWJ1dGVCaW5kaW5nczogc3RyaW5nW10gPSBudWxsO1xuICBwdWJsaWMgYXR0cnM6IEF0dHJzO1xuICBwdWJsaWMgZWxlbWVudDogRWxlbWVudDtcbiAgcHVibGljIGJvdW5kczogQm91bmRzO1xuICBwdWJsaWMgcGFyZW50VmlldzogQ29tcG9uZW50ID0gbnVsbDtcbiAgcHVibGljIGFyZ3M6IFByb2Nlc3NlZEFyZ3M7XG5cbiAgc3RhdGljIGNyZWF0ZShhcmdzOiB7IGF0dHJzOiBBdHRycyB9KTogRW1iZXJpc2hDdXJseUNvbXBvbmVudCB7XG4gICAgcmV0dXJuIHN1cGVyLmNyZWF0ZShhcmdzKSBhcyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50O1xuICB9XG5cbiAgcmVjb21wdXRlKCkge1xuICAgIHRoaXMuZGlydGluZXNzVGFnLmRpcnR5KCk7XG4gIH1cblxuICBkaWRJbml0QXR0cnMob3B0aW9ucyA6IHsgYXR0cnMgOiBBdHRycyB9KSB7fVxuICBkaWRVcGRhdGVBdHRycyhkaWZmIDogQXR0cnNEaWZmKSB7fVxuICBkaWRSZWNlaXZlQXR0cnMoZGlmZiA6IEF0dHJzRGlmZikge31cbiAgd2lsbEluc2VydEVsZW1lbnQoKSB7fVxuICB3aWxsVXBkYXRlKCkge31cbiAgd2lsbFJlbmRlcigpIHt9XG4gIGRpZEluc2VydEVsZW1lbnQoKSB7fVxuICBkaWRVcGRhdGUoKSB7fVxuICBkaWRSZW5kZXIoKSB7fVxufVxuXG5leHBvcnQgY2xhc3MgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50IGV4dGVuZHMgR2xpbW1lck9iamVjdCB7XG4gIHB1YmxpYyBkaXJ0aW5lc3NUYWcgPSBuZXcgRGlydHlhYmxlVGFnKCk7XG4gIHB1YmxpYyBhdHRyczogQXR0cnM7XG4gIHB1YmxpYyBlbGVtZW50OiBFbGVtZW50O1xuICBwdWJsaWMgYm91bmRzOiBCb3VuZHM7XG4gIHB1YmxpYyBwYXJlbnRWaWV3OiBDb21wb25lbnQgPSBudWxsO1xuXG4gIHN0YXRpYyBjcmVhdGUoYXJnczogeyBhdHRyczogQXR0cnMgfSk6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCB7XG4gICAgcmV0dXJuIHN1cGVyLmNyZWF0ZShhcmdzKSBhcyBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQ7XG4gIH1cblxuICByZWNvbXB1dGUoKSB7XG4gICAgdGhpcy5kaXJ0aW5lc3NUYWcuZGlydHkoKTtcbiAgfVxuXG4gIGRpZEluaXRBdHRycyhvcHRpb25zIDogeyBhdHRycyA6IEF0dHJzIH0pIHt9XG4gIGRpZFVwZGF0ZUF0dHJzKGRpZmYgOiBBdHRyc0RpZmYpIHt9XG4gIGRpZFJlY2VpdmVBdHRycyhkaWZmIDogQXR0cnNEaWZmKSB7fVxuICB3aWxsSW5zZXJ0RWxlbWVudCgpIHt9XG4gIHdpbGxVcGRhdGUoKSB7fVxuICB3aWxsUmVuZGVyKCkge31cbiAgZGlkSW5zZXJ0RWxlbWVudCgpIHt9XG4gIGRpZFVwZGF0ZSgpIHt9XG4gIGRpZFJlbmRlcigpIHt9XG59XG5cbmNsYXNzIEJhc2ljQ29tcG9uZW50TWFuYWdlciBpbXBsZW1lbnRzIENvbXBvbmVudE1hbmFnZXI8QmFzaWNDb21wb25lbnQ+IHtcbiAgcHJlcGFyZUFyZ3MoZGVmaW5pdGlvbjogQmFzaWNDb21wb25lbnREZWZpbml0aW9uLCBhcmdzOiBFdmFsdWF0ZWRBcmdzKTogRXZhbHVhdGVkQXJncyB7XG4gICAgcmV0dXJuIGFyZ3M7XG4gIH1cblxuICBjcmVhdGUoZW52aXJvbm1lbnQ6IEVudmlyb25tZW50LCBkZWZpbml0aW9uOiBCYXNpY0NvbXBvbmVudERlZmluaXRpb24sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MpOiBCYXNpY0NvbXBvbmVudCB7XG4gICAgbGV0IGtsYXNzID0gZGVmaW5pdGlvbi5Db21wb25lbnRDbGFzcyB8fCBCYXNpY0NvbXBvbmVudDtcbiAgICByZXR1cm4gbmV3IGtsYXNzKGFyZ3MubmFtZWQudmFsdWUoKSk7XG4gIH1cblxuICBsYXlvdXRGb3IoZGVmaW5pdGlvbjogQmFzaWNDb21wb25lbnREZWZpbml0aW9uLCBjb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50LCBlbnY6IFRlc3RFbnZpcm9ubWVudCk6IENvbXBpbGVkUHJvZ3JhbSB7XG4gICAgbGV0IGxheW91dCA9IGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXTtcblxuICAgIGlmIChsYXlvdXQpIHtcbiAgICAgIHJldHVybiBsYXlvdXQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXSA9IGNvbXBpbGVMYXlvdXQobmV3IEJhc2ljQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIoZGVmaW5pdGlvbi5sYXlvdXRTdHJpbmcpLCBlbnYpO1xuICB9XG5cbiAgZ2V0U2VsZihjb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50KTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShjb21wb25lbnQpO1xuICB9XG5cbiAgZGlkQ3JlYXRlRWxlbWVudChjb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50LCBlbGVtZW50OiBFbGVtZW50KSB7XG4gICAgY29tcG9uZW50LmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgZGlkUmVuZGVyTGF5b3V0KGNvbXBvbmVudDogQmFzaWNDb21wb25lbnQsIGJvdW5kczogQm91bmRzKSB7XG4gICAgY29tcG9uZW50LmJvdW5kcyA9IGJvdW5kcztcbiAgfVxuXG4gIGRpZENyZWF0ZSgpIHt9XG5cbiAgZ2V0VGFnKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgdXBkYXRlKGNvbXBvbmVudDogQmFzaWNDb21wb25lbnQsIGF0dHJzOiBFdmFsdWF0ZWRBcmdzKSB7XG4gICAgY29tcG9uZW50LmF0dHJzID0gYXR0cnMubmFtZWQudmFsdWUoKTtcbiAgfVxuXG4gIGRpZFVwZGF0ZUxheW91dCgpIHt9XG5cbiAgZGlkVXBkYXRlKCkge31cblxuICBnZXREZXN0cnVjdG9yKCkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmNvbnN0IEJBU0lDX0NPTVBPTkVOVF9NQU5BR0VSID0gbmV3IEJhc2ljQ29tcG9uZW50TWFuYWdlcigpO1xuXG5jbGFzcyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50TWFuYWdlciBleHRlbmRzIEJhc2ljQ29tcG9uZW50TWFuYWdlciB7XG4gIGxheW91dEZvcihkZWZpbml0aW9uOiBTdGF0aWNUYWdsZXNzQ29tcG9uZW50RGVmaW5pdGlvbiwgY29tcG9uZW50OiBCYXNpY0NvbXBvbmVudCwgZW52OiBUZXN0RW52aXJvbm1lbnQpOiBDb21waWxlZFByb2dyYW0ge1xuICAgIGxldCBsYXlvdXQgPSBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV07XG5cbiAgICBpZiAobGF5b3V0KSB7XG4gICAgICByZXR1cm4gbGF5b3V0O1xuICAgIH1cblxuICAgIHJldHVybiBlbnYuY29tcGlsZWRMYXlvdXRzW2RlZmluaXRpb24ubmFtZV0gPSBjb21waWxlTGF5b3V0KG5ldyBTdGF0aWNUYWdsZXNzQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIoZGVmaW5pdGlvbi5sYXlvdXRTdHJpbmcpLCBlbnYpO1xuICB9XG59XG5cbmNvbnN0IFNUQVRJQ19UQUdMRVNTX0NPTVBPTkVOVF9NQU5BR0VSID0gbmV3IFN0YXRpY1RhZ2xlc3NDb21wb25lbnRNYW5hZ2VyKCk7XG5cbmNvbnN0IEJhc2VFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQgPSBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQuZXh0ZW5kKCkgYXMgdHlwZW9mIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudDtcblxuY2xhc3MgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50TWFuYWdlciBpbXBsZW1lbnRzIENvbXBvbmVudE1hbmFnZXI8RW1iZXJpc2hHbGltbWVyQ29tcG9uZW50PiB7XG4gIHByZXBhcmVBcmdzKGRlZmluaXRpb246IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudERlZmluaXRpb24sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MpOiBFdmFsdWF0ZWRBcmdzIHtcbiAgICByZXR1cm4gYXJncztcbiAgfVxuXG4gIGNyZWF0ZShlbnZpcm9ubWVudDogRW52aXJvbm1lbnQsIGRlZmluaXRpb246IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudERlZmluaXRpb24sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MsIGR5bmFtaWNTY29wZSwgY2FsbGVyU2VsZjogUGF0aFJlZmVyZW5jZTxPcGFxdWU+LCBoYXNEZWZhdWx0QmxvY2s6IGJvb2xlYW4pOiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQge1xuICAgIGxldCBrbGFzcyA9IGRlZmluaXRpb24uQ29tcG9uZW50Q2xhc3MgfHwgQmFzZUVtYmVyaXNoR2xpbW1lckNvbXBvbmVudDtcbiAgICBsZXQgYXR0cnMgPSBhcmdzLm5hbWVkLnZhbHVlKCk7XG4gICAgbGV0IGNvbXBvbmVudCA9IGtsYXNzLmNyZWF0ZSh7IGF0dHJzIH0pO1xuXG4gICAgY29tcG9uZW50LmRpZEluaXRBdHRycyh7IGF0dHJzIH0pO1xuICAgIGNvbXBvbmVudC5kaWRSZWNlaXZlQXR0cnMoeyBvbGRBdHRyczogbnVsbCwgbmV3QXR0cnM6IGF0dHJzIH0pO1xuICAgIGNvbXBvbmVudC53aWxsSW5zZXJ0RWxlbWVudCgpO1xuICAgIGNvbXBvbmVudC53aWxsUmVuZGVyKCk7XG5cbiAgICByZXR1cm4gY29tcG9uZW50O1xuICB9XG5cbiAgbGF5b3V0Rm9yKGRlZmluaXRpb246IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudERlZmluaXRpb24sIGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50LCBlbnY6IFRlc3RFbnZpcm9ubWVudCk6IENvbXBpbGVkUHJvZ3JhbSB7XG4gICAgaWYgKGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXSkge1xuICAgICAgcmV0dXJuIGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXTtcbiAgICB9XG4gICAgcmV0dXJuIGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXSA9IGNvbXBpbGVMYXlvdXQobmV3IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudExheW91dENvbXBpbGVyKGRlZmluaXRpb24ubGF5b3V0U3RyaW5nKSwgZW52KTtcbiAgfVxuXG4gIGdldFNlbGYoY29tcG9uZW50OiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBuZXcgVXBkYXRhYmxlUmVmZXJlbmNlKGNvbXBvbmVudCk7XG4gIH1cblxuICBkaWRDcmVhdGVFbGVtZW50KGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50LCBlbGVtZW50OiBFbGVtZW50KSB7XG4gICAgY29tcG9uZW50LmVsZW1lbnQgPSBlbGVtZW50O1xuICB9XG5cbiAgZGlkUmVuZGVyTGF5b3V0KGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50LCBib3VuZHM6IEJvdW5kcykge1xuICAgIGNvbXBvbmVudC5ib3VuZHMgPSBib3VuZHM7XG4gIH1cblxuICBkaWRDcmVhdGUoY29tcG9uZW50OiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQpIHtcbiAgICBjb21wb25lbnQuZGlkSW5zZXJ0RWxlbWVudCgpO1xuICAgIGNvbXBvbmVudC5kaWRSZW5kZXIoKTtcbiAgfVxuXG4gIGdldFRhZyhjb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudCkge1xuICAgIHJldHVybiBjb21wb25lbnQuZGlydGluZXNzVGFnO1xuICB9XG5cbiAgdXBkYXRlKGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50LCBhcmdzOiBFdmFsdWF0ZWRBcmdzKSB7XG4gICAgbGV0IG9sZEF0dHJzID0gY29tcG9uZW50LmF0dHJzO1xuICAgIGxldCBuZXdBdHRycyA9IGFyZ3MubmFtZWQudmFsdWUoKTtcblxuICAgIGNvbXBvbmVudC5zZXQoJ2F0dHJzJywgbmV3QXR0cnMpO1xuICAgIGNvbXBvbmVudC5kaWRVcGRhdGVBdHRycyh7IG9sZEF0dHJzLCBuZXdBdHRycyB9KTtcbiAgICBjb21wb25lbnQuZGlkUmVjZWl2ZUF0dHJzKHsgb2xkQXR0cnMsIG5ld0F0dHJzIH0pO1xuICAgIGNvbXBvbmVudC53aWxsVXBkYXRlKCk7XG4gICAgY29tcG9uZW50LndpbGxSZW5kZXIoKTtcbiAgfVxuXG4gIGRpZFVwZGF0ZUxheW91dCgpIHt9XG5cbiAgZGlkVXBkYXRlKGNvbXBvbmVudDogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50KSB7XG4gICAgY29tcG9uZW50LmRpZFVwZGF0ZSgpO1xuICAgIGNvbXBvbmVudC5kaWRSZW5kZXIoKTtcbiAgfVxuXG4gIGdldERlc3RydWN0b3IoY29tcG9uZW50OiBFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQpOiBEZXN0cm95YWJsZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRlc3Ryb3koKSB7XG4gICAgICAgIGNvbXBvbmVudC5kZXN0cm95KCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUHJvY2Vzc2VkQXJncyB7XG4gIHRhZzogUmV2aXNpb25UYWc7XG4gIG5hbWVkOiBFdmFsdWF0ZWROYW1lZEFyZ3M7XG4gIHBvc2l0aW9uYWw6IEV2YWx1YXRlZFBvc2l0aW9uYWxBcmdzO1xuICBwb3NpdGlvbmFsUGFyYW1OYW1lczogQXJyYXk8c3RyaW5nPjtcblxuICBjb25zdHJ1Y3RvcihhcmdzOiBFdmFsdWF0ZWRBcmdzLCBwb3NpdGlvbmFsUGFyYW1zRGVmaW5pdGlvbjogc3RyaW5nW10pIHtcbiAgICB0aGlzLnRhZyA9IGFyZ3MudGFnO1xuICAgIHRoaXMubmFtZWQgPSBhcmdzLm5hbWVkO1xuICAgIHRoaXMucG9zaXRpb25hbCA9IGFyZ3MucG9zaXRpb25hbDtcbiAgICB0aGlzLnBvc2l0aW9uYWxQYXJhbU5hbWVzID0gcG9zaXRpb25hbFBhcmFtc0RlZmluaXRpb247XG4gIH1cblxuICB2YWx1ZSgpIHtcbiAgICBsZXQgeyBuYW1lZCwgcG9zaXRpb25hbCwgcG9zaXRpb25hbFBhcmFtTmFtZXMgfSA9IHRoaXM7XG5cbiAgICBsZXQgbWVyZ2VkID0gT2JqZWN0LmFzc2lnbih7fSwgbmFtZWQudmFsdWUoKSk7XG5cbiAgICBpZiAocG9zaXRpb25hbFBhcmFtTmFtZXMgJiYgcG9zaXRpb25hbFBhcmFtTmFtZXMubGVuZ3RoKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBvc2l0aW9uYWxQYXJhbU5hbWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxldCBuYW1lID0gcG9zaXRpb25hbFBhcmFtTmFtZXNbaV07XG4gICAgICAgIGxldCByZWZlcmVuY2UgPSBwb3NpdGlvbmFsLmF0KGkpO1xuXG4gICAgICAgIG1lcmdlZFtuYW1lXSA9IHJlZmVyZW5jZS52YWx1ZSgpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBhdHRyczogbWVyZ2VkLFxuICAgICAgcHJvcHM6IG1lcmdlZFxuICAgIH07XG4gIH1cbn1cblxuZnVuY3Rpb24gcHJvY2Vzc0FyZ3MoYXJnczogRXZhbHVhdGVkQXJncywgcG9zaXRpb25hbFBhcmFtc0RlZmluaXRpb246IHN0cmluZ1tdKSA6IFByb2Nlc3NlZEFyZ3Mge1xuICByZXR1cm4gbmV3IFByb2Nlc3NlZEFyZ3MoYXJncywgcG9zaXRpb25hbFBhcmFtc0RlZmluaXRpb24pO1xufVxuXG5jb25zdCBFTUJFUklTSF9HTElNTUVSX0NPTVBPTkVOVF9NQU5BR0VSID0gbmV3IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudE1hbmFnZXIoKTtcblxuY29uc3QgQmFzZUVtYmVyaXNoQ3VybHlDb21wb25lbnQgPSBFbWJlcmlzaEN1cmx5Q29tcG9uZW50LmV4dGVuZCgpIGFzIHR5cGVvZiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50O1xuXG5jbGFzcyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50TWFuYWdlciBpbXBsZW1lbnRzIENvbXBvbmVudE1hbmFnZXI8RW1iZXJpc2hDdXJseUNvbXBvbmVudD4ge1xuICBwcmVwYXJlQXJncyhkZWZpbml0aW9uOiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50RGVmaW5pdGlvbiwgYXJnczogRXZhbHVhdGVkQXJncywgZHluYW1pY1Njb3BlOiBEeW5hbWljU2NvcGUpOiBFdmFsdWF0ZWRBcmdzIHtcbiAgICBsZXQgZHluID0gZGVmaW5pdGlvbi5Db21wb25lbnRDbGFzcyA/IGRlZmluaXRpb24uQ29tcG9uZW50Q2xhc3NbJ2Zyb21EeW5hbWljU2NvcGUnXSA6IG51bGw7XG4gICAgaWYgKGR5bikge1xuICAgICAgbGV0IG1hcCA9IGFzc2lnbih7fSwgYXJncy5uYW1lZC5tYXApO1xuICAgICAgZHluLmZvckVhY2gobmFtZSA9PiBtYXBbbmFtZV0gPSBkeW5hbWljU2NvcGUuZ2V0KG5hbWUpKTtcbiAgICAgIGFyZ3MgPSBFdmFsdWF0ZWRBcmdzLmNyZWF0ZShhcmdzLnBvc2l0aW9uYWwsIEV2YWx1YXRlZE5hbWVkQXJncy5jcmVhdGUobWFwKSwgYXJncy5ibG9ja3MpO1xuICAgIH1cbiAgICByZXR1cm4gYXJncztcbiAgfVxuXG4gIGNyZWF0ZShlbnZpcm9ubWVudDogRW52aXJvbm1lbnQsIGRlZmluaXRpb246IEVtYmVyaXNoQ3VybHlDb21wb25lbnREZWZpbml0aW9uLCBhcmdzOiBFdmFsdWF0ZWRBcmdzLCBkeW5hbWljU2NvcGU6IER5bmFtaWNTY29wZSwgY2FsbGVyU2VsZjogUGF0aFJlZmVyZW5jZTxPcGFxdWU+KTogRW1iZXJpc2hDdXJseUNvbXBvbmVudCB7XG4gICAgbGV0IGtsYXNzID0gZGVmaW5pdGlvbi5Db21wb25lbnRDbGFzcyB8fCBCYXNlRW1iZXJpc2hDdXJseUNvbXBvbmVudDtcbiAgICBsZXQgcHJvY2Vzc2VkQXJncyA9IHByb2Nlc3NBcmdzKGFyZ3MsIGtsYXNzWydwb3NpdGlvbmFsUGFyYW1zJ10pO1xuICAgIGxldCB7IGF0dHJzIH0gPSBwcm9jZXNzZWRBcmdzLnZhbHVlKCk7XG4gICAgbGV0IHNlbGYgPSBjYWxsZXJTZWxmLnZhbHVlKCk7XG4gICAgbGV0IG1lcmdlZCA9IGFzc2lnbih7fSwgYXR0cnMsIHsgYXR0cnMgfSwgeyBhcmdzOiBwcm9jZXNzZWRBcmdzIH0sIHsgdGFyZ2V0T2JqZWN0OiBzZWxmIH0pO1xuICAgIGxldCBjb21wb25lbnQgPSBrbGFzcy5jcmVhdGUobWVyZ2VkKTtcblxuICAgIGNvbXBvbmVudC5kaWRJbml0QXR0cnMoeyBhdHRycyB9KTtcbiAgICBjb21wb25lbnQuZGlkUmVjZWl2ZUF0dHJzKHsgb2xkQXR0cnM6IG51bGwsIG5ld0F0dHJzOiBhdHRycyB9KTtcbiAgICBjb21wb25lbnQud2lsbEluc2VydEVsZW1lbnQoKTtcbiAgICBjb21wb25lbnQud2lsbFJlbmRlcigpO1xuXG4gICAgcmV0dXJuIGNvbXBvbmVudDtcbiAgfVxuXG4gIGxheW91dEZvcihkZWZpbml0aW9uOiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50RGVmaW5pdGlvbiwgY29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50LCBlbnY6IFRlc3RFbnZpcm9ubWVudCk6IENvbXBpbGVkUHJvZ3JhbSB7XG4gICAgbGV0IGxheW91dCA9IGVudi5jb21waWxlZExheW91dHNbZGVmaW5pdGlvbi5uYW1lXTtcblxuICAgIGlmIChsYXlvdXQpIHtcbiAgICAgIHJldHVybiBsYXlvdXQ7XG4gICAgfVxuXG4gICAgbGV0IGxheW91dFN0cmluZyA9IGRlZmluaXRpb24ubGF5b3V0U3RyaW5nO1xuICAgIGxldCBsYXRlQm91bmQgPSAhbGF5b3V0U3RyaW5nO1xuXG4gICAgaWYgKCFsYXlvdXRTdHJpbmcgJiYgbGF5b3V0U3RyaW5nICE9PSAnJykge1xuICAgICAgbGF5b3V0U3RyaW5nID0gY29tcG9uZW50WydsYXlvdXQnXTtcbiAgICB9XG5cbiAgICBsYXlvdXQgPSBjb21waWxlTGF5b3V0KG5ldyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50TGF5b3V0Q29tcGlsZXIobGF5b3V0U3RyaW5nKSwgZW52KTtcblxuICAgIHJldHVybiBsYXRlQm91bmQgPyBsYXlvdXQgOiAoZW52LmNvbXBpbGVkTGF5b3V0c1tkZWZpbml0aW9uLm5hbWVdID0gbGF5b3V0KTtcbiAgfVxuXG4gIGdldFNlbGYoY29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50KTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShjb21wb25lbnQpO1xuICB9XG5cbiAgZGlkQ3JlYXRlRWxlbWVudChjb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnQsIGVsZW1lbnQ6IEVsZW1lbnQsIG9wZXJhdGlvbnM6IEVsZW1lbnRPcGVyYXRpb25zKSB7XG4gICAgY29tcG9uZW50LmVsZW1lbnQgPSBlbGVtZW50O1xuXG4gICAgbGV0IGJpbmRpbmdzID0gY29tcG9uZW50LmF0dHJpYnV0ZUJpbmRpbmdzO1xuICAgIGxldCByb290UmVmID0gbmV3IFVwZGF0YWJsZVJlZmVyZW5jZShjb21wb25lbnQpO1xuXG4gICAgaWYgKGJpbmRpbmdzKSB7XG4gICAgICBmb3IgKGxldCBpPTA7IGk8YmluZGluZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IGF0dHJpYnV0ZSA9IGJpbmRpbmdzW2ldO1xuICAgICAgICBsZXQgcmVmZXJlbmNlID0gcm9vdFJlZi5nZXQoYXR0cmlidXRlKSBhcyBQYXRoUmVmZXJlbmNlPHN0cmluZz47XG5cbiAgICAgICAgb3BlcmF0aW9ucy5hZGREeW5hbWljQXR0cmlidXRlKGVsZW1lbnQsIGF0dHJpYnV0ZSwgcmVmZXJlbmNlLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZGlkUmVuZGVyTGF5b3V0KGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCwgYm91bmRzOiBCb3VuZHMpIHtcbiAgICBjb21wb25lbnQuYm91bmRzID0gYm91bmRzO1xuICB9XG5cbiAgZGlkQ3JlYXRlKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCkge1xuICAgIGNvbXBvbmVudC5kaWRJbnNlcnRFbGVtZW50KCk7XG4gICAgY29tcG9uZW50LmRpZFJlbmRlcigpO1xuICB9XG5cbiAgZ2V0VGFnKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCkge1xuICAgIHJldHVybiBjb21wb25lbnQuZGlydGluZXNzVGFnO1xuICB9XG5cbiAgdXBkYXRlKGNvbXBvbmVudDogRW1iZXJpc2hDdXJseUNvbXBvbmVudCwgYXJnczogRXZhbHVhdGVkQXJncykge1xuICAgIGxldCBvbGRBdHRycyA9IGNvbXBvbmVudC5hdHRycztcbiAgICBsZXQgbmV3QXR0cnMgPSBjb21wb25lbnQuYXJncy52YWx1ZSgpLmF0dHJzO1xuICAgIGxldCBtZXJnZWQgPSBhc3NpZ24oe30sIG5ld0F0dHJzLCB7IGF0dHJzOiBuZXdBdHRycyB9KTtcblxuICAgIGNvbXBvbmVudC5zZXRQcm9wZXJ0aWVzKG1lcmdlZCk7XG4gICAgY29tcG9uZW50LmRpZFVwZGF0ZUF0dHJzKHsgb2xkQXR0cnMsIG5ld0F0dHJzIH0pO1xuICAgIGNvbXBvbmVudC5kaWRSZWNlaXZlQXR0cnMoeyBvbGRBdHRycywgbmV3QXR0cnMgfSk7XG4gICAgY29tcG9uZW50LndpbGxVcGRhdGUoKTtcbiAgICBjb21wb25lbnQud2lsbFJlbmRlcigpO1xuICB9XG5cbiAgZGlkVXBkYXRlTGF5b3V0KCkge31cblxuICBkaWRVcGRhdGUoY29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50KSB7XG4gICAgY29tcG9uZW50LmRpZFVwZGF0ZSgpO1xuICAgIGNvbXBvbmVudC5kaWRSZW5kZXIoKTtcbiAgfVxuXG4gIGdldERlc3RydWN0b3IoY29tcG9uZW50OiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50KTogRGVzdHJveWFibGUge1xuICAgIHJldHVybiB7XG4gICAgICBkZXN0cm95ICgpIHtcbiAgICAgICAgY29tcG9uZW50LmRlc3Ryb3koKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbmNvbnN0IEVNQkVSSVNIX0NVUkxZX0NPTVBPTkVOVF9NQU5BR0VSID0gbmV3IEVtYmVyaXNoQ3VybHlDb21wb25lbnRNYW5hZ2VyKCk7XG5cbmZ1bmN0aW9uIGVtYmVyVG9Cb29sKHZhbHVlOiBhbnkpOiBib29sZWFuIHtcbiAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgcmV0dXJuIHZhbHVlLmxlbmd0aCA+IDA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuICEhdmFsdWU7XG4gIH1cbn1cblxuY2xhc3MgRW1iZXJpc2hDb25kaXRpb25hbFJlZmVyZW5jZSBleHRlbmRzIENvbmRpdGlvbmFsUmVmZXJlbmNlIHtcbiAgcHJvdGVjdGVkIHRvQm9vbCh2YWx1ZTogYW55KTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGVtYmVyVG9Cb29sKHZhbHVlKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgU2ltcGxlUGF0aFJlZmVyZW5jZTxUPiBpbXBsZW1lbnRzIFBhdGhSZWZlcmVuY2U8VD4ge1xuICBwcml2YXRlIHBhcmVudDogUmVmZXJlbmNlPFQ+O1xuICBwcml2YXRlIHByb3BlcnR5OiBzdHJpbmc7XG4gIHB1YmxpYyB0YWcgPSBWT0xBVElMRV9UQUc7XG5cbiAgY29uc3RydWN0b3IocGFyZW50OiBSZWZlcmVuY2U8VD4sIHByb3BlcnR5OiBzdHJpbmcpIHtcbiAgICB0aGlzLnBhcmVudCA9IHBhcmVudDtcbiAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7XG4gIH1cblxuICB2YWx1ZSgpOiBUIHtcbiAgICByZXR1cm4gdGhpcy5wYXJlbnQudmFsdWUoKVt0aGlzLnByb3BlcnR5XTtcbiAgfVxuXG4gIGdldChwcm9wOiBzdHJpbmcpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBuZXcgU2ltcGxlUGF0aFJlZmVyZW5jZSh0aGlzLCBwcm9wKTtcbiAgfVxufVxuXG5leHBvcnQgdHlwZSBVc2VySGVscGVyID0gKGFyZ3M6IFJlYWRvbmx5QXJyYXk8T3BhcXVlPiwgbmFtZWQ6IERpY3Q8T3BhcXVlPikgPT4gYW55O1xuXG5jbGFzcyBIZWxwZXJSZWZlcmVuY2UgaW1wbGVtZW50cyBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICBwcml2YXRlIGhlbHBlcjogVXNlckhlbHBlcjtcbiAgcHJpdmF0ZSBhcmdzOiBFdmFsdWF0ZWRBcmdzO1xuICBwdWJsaWMgdGFnID0gVk9MQVRJTEVfVEFHO1xuXG4gIGNvbnN0cnVjdG9yKGhlbHBlcjogVXNlckhlbHBlciwgYXJnczogRXZhbHVhdGVkQXJncykge1xuICAgIHRoaXMuaGVscGVyID0gaGVscGVyO1xuICAgIHRoaXMuYXJncyA9IGFyZ3M7XG4gIH1cblxuICB2YWx1ZSgpIHtcbiAgICBsZXQgeyBoZWxwZXIsIGFyZ3M6IHsgcG9zaXRpb25hbCwgbmFtZWQgfSB9ID0gdGhpcztcblxuICAgIHJldHVybiBoZWxwZXIocG9zaXRpb25hbC52YWx1ZSgpLCBuYW1lZC52YWx1ZSgpKTtcbiAgfVxuXG4gIGdldChwcm9wOiBzdHJpbmcpOiBTaW1wbGVQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiBuZXcgU2ltcGxlUGF0aFJlZmVyZW5jZSh0aGlzLCBwcm9wKTtcbiAgfVxufVxuXG5jbGFzcyBJbmVydE1vZGlmaWVyTWFuYWdlciBpbXBsZW1lbnRzIE1vZGlmaWVyTWFuYWdlcjxPcGFxdWU+IHtcbiAgY3JlYXRlKCkge31cblxuICBpbnN0YWxsKG1vZGlmaWVyOiBPcGFxdWUpIHt9XG5cbiAgdXBkYXRlKG1vZGlmaWVyOiBPcGFxdWUpIHt9XG5cbiAgZ2V0RGVzdHJ1Y3Rvcihtb2RpZmllcjogT3BhcXVlKTogRGVzdHJveWFibGUge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXN0TW9kaWZpZXIge1xuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgZWxlbWVudDogRWxlbWVudCxcbiAgICBwdWJsaWMgYXJnczogRXZhbHVhdGVkQXJncyxcbiAgICBwdWJsaWMgZG9tOiBJRE9NQ2hhbmdlc1xuICApIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXN0TW9kaWZpZXJNYW5hZ2VyIGltcGxlbWVudHMgTW9kaWZpZXJNYW5hZ2VyPFRlc3RNb2RpZmllcj4ge1xuICBwdWJsaWMgaW5zdGFsbGVkRWxlbWVudHM6IEVsZW1lbnRbXSA9IFtdO1xuICBwdWJsaWMgdXBkYXRlZEVsZW1lbnRzOiBFbGVtZW50W10gPSBbXTtcbiAgcHVibGljIGRlc3Ryb3llZE1vZGlmaWVyczogVGVzdE1vZGlmaWVyW10gPSBbXTtcblxuICBjcmVhdGUoZWxlbWVudDogRWxlbWVudCwgYXJnczogRXZhbHVhdGVkQXJncywgZHluYW1pY1Njb3BlOiBEeW5hbWljU2NvcGUsIGRvbTogSURPTUNoYW5nZXMpOiBUZXN0TW9kaWZpZXIge1xuICAgIHJldHVybiBuZXcgVGVzdE1vZGlmaWVyKGVsZW1lbnQsIGFyZ3MsIGRvbSk7XG4gIH1cblxuICBpbnN0YWxsKHsgZWxlbWVudCwgYXJncywgZG9tIH06IFRlc3RNb2RpZmllcikge1xuICAgIHRoaXMuaW5zdGFsbGVkRWxlbWVudHMucHVzaChlbGVtZW50KTtcblxuICAgIGxldCBwYXJhbSA9IGFyZ3MucG9zaXRpb25hbC5hdCgwKS52YWx1ZSgpO1xuICAgIGRvbS5zZXRBdHRyaWJ1dGUoZWxlbWVudCwgJ2RhdGEtbW9kaWZpZXInLCBgaW5zdGFsbGVkIC0gJHtwYXJhbX1gKTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIHVwZGF0ZSh7IGVsZW1lbnQsIGFyZ3MsIGRvbSB9OiBUZXN0TW9kaWZpZXIpIHtcbiAgICB0aGlzLnVwZGF0ZWRFbGVtZW50cy5wdXNoKGVsZW1lbnQpO1xuXG4gICAgbGV0IHBhcmFtID0gYXJncy5wb3NpdGlvbmFsLmF0KDApLnZhbHVlKCk7XG4gICAgZG9tLnNldEF0dHJpYnV0ZShlbGVtZW50LCAnZGF0YS1tb2RpZmllcicsIGB1cGRhdGVkIC0gJHtwYXJhbX1gKTtcblxuICAgIHJldHVybjtcbiAgfVxuXG4gIGdldERlc3RydWN0b3IobW9kaWZpZXI6IFRlc3RNb2RpZmllcik6IERlc3Ryb3lhYmxlIHtcbiAgICByZXR1cm4ge1xuICAgICAgZGVzdHJveTogKCkgPT4ge1xuICAgICAgICB0aGlzLmRlc3Ryb3llZE1vZGlmaWVycy5wdXNoKG1vZGlmaWVyKTtcbiAgICAgICAgbGV0IHsgZWxlbWVudCwgZG9tIH0gPSBtb2RpZmllcjtcbiAgICAgICAgZG9tLnJlbW92ZUF0dHJpYnV0ZShlbGVtZW50LCAnZGF0YS1tb2RpZmllcicpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBUZXN0RW52aXJvbm1lbnRPcHRpb25zIHtcbiAgZG9jdW1lbnQ/OiBTaW1wbGUuRG9jdW1lbnQ7XG4gIGFwcGVuZE9wZXJhdGlvbnM/OiBET01UcmVlQ29uc3RydWN0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgVGVzdEVudmlyb25tZW50IGV4dGVuZHMgRW52aXJvbm1lbnQge1xuICBwcml2YXRlIGhlbHBlcnMgPSBkaWN0PEdsaW1tZXJIZWxwZXI+KCk7XG4gIHByaXZhdGUgbW9kaWZpZXJzID0gZGljdDxNb2RpZmllck1hbmFnZXI8T3BhcXVlPj4oKTtcbiAgcHJpdmF0ZSBwYXJ0aWFscyA9IGRpY3Q8UGFydGlhbERlZmluaXRpb248e30+PigpO1xuICBwcml2YXRlIGNvbXBvbmVudHMgPSBkaWN0PENvbXBvbmVudERlZmluaXRpb248YW55Pj4oKTtcbiAgcHJpdmF0ZSB1c2VsZXNzQW5jaG9yOiBIVE1MQW5jaG9yRWxlbWVudDtcbiAgcHVibGljIGNvbXBpbGVkTGF5b3V0cyA9IGRpY3Q8Q29tcGlsZWRQcm9ncmFtPigpO1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnM6IFRlc3RFbnZpcm9ubWVudE9wdGlvbnMgPSB7XG4gICAgZG9jdW1lbnQ6IGRvY3VtZW50LFxuICAgIGFwcGVuZE9wZXJhdGlvbnM6IG5ldyBET01UcmVlQ29uc3RydWN0aW9uKGRvY3VtZW50KVxuICB9KSB7XG4gICAgc3VwZXIoeyBhcHBlbmRPcGVyYXRpb25zOiBvcHRpb25zLmFwcGVuZE9wZXJhdGlvbnMsIHVwZGF0ZU9wZXJhdGlvbnM6IG5ldyBET01DaGFuZ2VzKG9wdGlvbnMuZG9jdW1lbnQgYXMgRG9jdW1lbnQpIH0pO1xuXG4gICAgdGhpcy51c2VsZXNzQW5jaG9yID0gb3B0aW9ucy5kb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJykgYXMgSFRNTEFuY2hvckVsZW1lbnQ7XG4gICAgdGhpcy5yZWdpc3RlckhlbHBlcihcImlmXCIsIChbY29uZCwgeWVzLCBub10pID0+IGNvbmQgPyB5ZXMgOiBubyk7XG4gICAgdGhpcy5yZWdpc3RlckhlbHBlcihcInVubGVzc1wiLCAoW2NvbmQsIHllcywgbm9dKSA9PiBjb25kID8gbm8gOiB5ZXMpO1xuICAgIHRoaXMucmVnaXN0ZXJJbnRlcm5hbEhlbHBlcihcIi1nZXQtZHluYW1pYy12YXJcIiwgZ2V0RHluYW1pY1Zhcik7XG4gICAgdGhpcy5yZWdpc3Rlck1vZGlmaWVyKFwiYWN0aW9uXCIsIG5ldyBJbmVydE1vZGlmaWVyTWFuYWdlcigpKTtcblxuICAgIHRoaXMucmVnaXN0ZXJJbnRlcm5hbEhlbHBlcihcImNvbXBvbmVudFwiLCAodm0sIGFyZ3MsIHN5bWJvbFRhYmxlKSA9PiB7XG4gICAgICByZXR1cm4gbmV3IER5bmFtaWNDb21wb25lbnRSZWZlcmVuY2UoYXJncy5wb3NpdGlvbmFsLmF0KDApLCB2bS5lbnYsIHN5bWJvbFRhYmxlKTtcbiAgICB9KTtcblxuICAgIHRoaXMucmVnaXN0ZXJJbnRlcm5hbEhlbHBlcihcImhhc2hcIiwgKHZtLCBhcmdzKSA9PiBhcmdzLm5hbWVkKTtcbiAgfVxuXG4gIHByb3RvY29sRm9yVVJMKHVybDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICB0aGlzLnVzZWxlc3NBbmNob3IuaHJlZiA9IHVybDtcbiAgICByZXR1cm4gdGhpcy51c2VsZXNzQW5jaG9yLnByb3RvY29sO1xuICB9XG5cbiAgcmVnaXN0ZXJIZWxwZXIobmFtZTogc3RyaW5nLCBoZWxwZXI6IFVzZXJIZWxwZXIpIHtcbiAgICB0aGlzLmhlbHBlcnNbbmFtZV0gPSAodm06IFZNLCBhcmdzOiBFdmFsdWF0ZWRBcmdzKSA9PiBuZXcgSGVscGVyUmVmZXJlbmNlKGhlbHBlciwgYXJncyk7XG4gIH1cblxuICByZWdpc3RlckludGVybmFsSGVscGVyKG5hbWU6IHN0cmluZywgaGVscGVyOiBHbGltbWVySGVscGVyKSB7XG4gICAgdGhpcy5oZWxwZXJzW25hbWVdID0gaGVscGVyO1xuICB9XG5cbiAgcmVnaXN0ZXJNb2RpZmllcihuYW1lOiBzdHJpbmcsIG1vZGlmaWVyOiBNb2RpZmllck1hbmFnZXI8T3BhcXVlPikge1xuICAgIHRoaXMubW9kaWZpZXJzW25hbWVdID0gbW9kaWZpZXI7XG4gIH1cblxuICByZWdpc3RlclBhcnRpYWwobmFtZTogc3RyaW5nLCBzb3VyY2U6IHN0cmluZykge1xuICAgIHRoaXMucGFydGlhbHNbbmFtZV0gPSBuZXcgUGFydGlhbERlZmluaXRpb24obmFtZSwgcmF3Q29tcGlsZShzb3VyY2UsIHsgZW52OiB0aGlzIH0pKTtcbiAgfVxuXG4gIHJlZ2lzdGVyQ29tcG9uZW50KG5hbWU6IHN0cmluZywgZGVmaW5pdGlvbjogQ29tcG9uZW50RGVmaW5pdGlvbjxhbnk+KSB7XG4gICAgdGhpcy5jb21wb25lbnRzW25hbWVdID0gZGVmaW5pdGlvbjtcbiAgICByZXR1cm4gZGVmaW5pdGlvbjtcbiAgfVxuXG4gIHJlZ2lzdGVyQmFzaWNDb21wb25lbnQ8VCBleHRlbmRzIEJhc2ljQ29tcG9uZW50PihuYW1lOiBzdHJpbmcsIENvbXBvbmVudDogQmFzaWNDb21wb25lbnRGYWN0b3J5LCBsYXlvdXQ6IHN0cmluZyk6IENvbXBvbmVudERlZmluaXRpb248QmFzaWNDb21wb25lbnREZWZpbml0aW9uPiB7XG4gICAgbGV0IGRlZmluaXRpb24gPSBuZXcgQmFzaWNDb21wb25lbnREZWZpbml0aW9uKG5hbWUsIEJBU0lDX0NPTVBPTkVOVF9NQU5BR0VSLCBDb21wb25lbnQsIGxheW91dCk7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJDb21wb25lbnQobmFtZSwgZGVmaW5pdGlvbik7XG4gIH1cblxuICByZWdpc3RlclN0YXRpY1RhZ2xlc3NDb21wb25lbnQobmFtZTogc3RyaW5nLCBDb21wb25lbnQ6IEJhc2ljQ29tcG9uZW50RmFjdG9yeSwgbGF5b3V0OiBzdHJpbmcpOiBDb21wb25lbnREZWZpbml0aW9uPEJhc2ljQ29tcG9uZW50RmFjdG9yeT4ge1xuICAgIGxldCBkZWZpbml0aW9uID0gbmV3IFN0YXRpY1RhZ2xlc3NDb21wb25lbnREZWZpbml0aW9uKG5hbWUsIFNUQVRJQ19UQUdMRVNTX0NPTVBPTkVOVF9NQU5BR0VSLCBDb21wb25lbnQsIGxheW91dCk7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJDb21wb25lbnQobmFtZSwgZGVmaW5pdGlvbik7XG4gIH1cblxuICByZWdpc3RlckVtYmVyaXNoQ3VybHlDb21wb25lbnQobmFtZTogc3RyaW5nLCBDb21wb25lbnQ6IEVtYmVyaXNoQ3VybHlDb21wb25lbnRGYWN0b3J5LCBsYXlvdXQ6IHN0cmluZyk6IENvbXBvbmVudERlZmluaXRpb248RW1iZXJpc2hDdXJseUNvbXBvbmVudERlZmluaXRpb24+IHtcbiAgICBsZXQgZGVmaW5pdGlvbiA9IG5ldyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50RGVmaW5pdGlvbihuYW1lLCBFTUJFUklTSF9DVVJMWV9DT01QT05FTlRfTUFOQUdFUiwgQ29tcG9uZW50LCBsYXlvdXQpO1xuICAgIHJldHVybiB0aGlzLnJlZ2lzdGVyQ29tcG9uZW50KG5hbWUsIGRlZmluaXRpb24pO1xuICB9XG5cbiAgcmVnaXN0ZXJFbWJlcmlzaEdsaW1tZXJDb21wb25lbnQobmFtZTogc3RyaW5nLCBDb21wb25lbnQ6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudEZhY3RvcnksIGxheW91dDogc3RyaW5nKTogQ29tcG9uZW50RGVmaW5pdGlvbjxFbWJlcmlzaEdsaW1tZXJDb21wb25lbnREZWZpbml0aW9uPiB7XG4gICAgbGV0IGRlZmluaXRpb24gPSBuZXcgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50RGVmaW5pdGlvbihuYW1lLCBFTUJFUklTSF9HTElNTUVSX0NPTVBPTkVOVF9NQU5BR0VSLCBDb21wb25lbnQsIGxheW91dCk7XG4gICAgcmV0dXJuIHRoaXMucmVnaXN0ZXJDb21wb25lbnQobmFtZSwgZGVmaW5pdGlvbik7XG4gIH1cblxuICB0b0NvbmRpdGlvbmFsUmVmZXJlbmNlKHJlZmVyZW5jZTogUmVmZXJlbmNlPGFueT4pOiBSZWZlcmVuY2U8Ym9vbGVhbj4ge1xuICAgIGlmIChpc0NvbnN0KHJlZmVyZW5jZSkpIHtcbiAgICAgIHJldHVybiBQcmltaXRpdmVSZWZlcmVuY2UuY3JlYXRlKGVtYmVyVG9Cb29sKHJlZmVyZW5jZS52YWx1ZSgpKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBFbWJlcmlzaENvbmRpdGlvbmFsUmVmZXJlbmNlKHJlZmVyZW5jZSk7XG4gIH1cblxuICBtYWNyb3MoKTogeyBibG9ja3M6IEJsb2NrTWFjcm9zLCBpbmxpbmVzOiBJbmxpbmVNYWNyb3MgfSB7XG4gICAgbGV0IG1hY3JvcyA9IHN1cGVyLm1hY3JvcygpO1xuICAgIHBvcHVsYXRlQmxvY2tzKG1hY3Jvcy5ibG9ja3MsIG1hY3Jvcy5pbmxpbmVzKTtcbiAgICByZXR1cm4gbWFjcm9zO1xuICB9XG5cbiAgaGFzSGVscGVyKGhlbHBlck5hbWU6IHN0cmluZ1tdKSB7XG4gICAgcmV0dXJuIGhlbHBlck5hbWUubGVuZ3RoID09PSAxICYmICg8c3RyaW5nPmhlbHBlck5hbWVbMF0gaW4gdGhpcy5oZWxwZXJzKTtcbiAgfVxuXG4gIGxvb2t1cEhlbHBlcihoZWxwZXJQYXJ0czogc3RyaW5nW10pIHtcbiAgICBsZXQgaGVscGVyTmFtZSA9IGhlbHBlclBhcnRzWzBdO1xuXG4gICAgbGV0IGhlbHBlciA9IHRoaXMuaGVscGVyc1toZWxwZXJOYW1lXTtcblxuICAgIGlmICghaGVscGVyKSB0aHJvdyBuZXcgRXJyb3IoYEhlbHBlciBmb3IgJHtoZWxwZXJQYXJ0cy5qb2luKCcuJyl9IG5vdCBmb3VuZC5gKTtcblxuICAgIHJldHVybiBoZWxwZXI7XG4gIH1cblxuICBoYXNQYXJ0aWFsKHBhcnRpYWxOYW1lOiBzdHJpbmcpIHtcbiAgICByZXR1cm4gcGFydGlhbE5hbWUgaW4gdGhpcy5wYXJ0aWFscztcbiAgfVxuXG4gIGxvb2t1cFBhcnRpYWwocGFydGlhbE5hbWU6IHN0cmluZykge1xuICAgIGxldCBwYXJ0aWFsID0gdGhpcy5wYXJ0aWFsc1twYXJ0aWFsTmFtZV07XG5cbiAgICByZXR1cm4gcGFydGlhbDtcbiAgfVxuXG4gIGhhc0NvbXBvbmVudERlZmluaXRpb24obmFtZTogc3RyaW5nW10pOiBib29sZWFuIHtcbiAgICByZXR1cm4gISF0aGlzLmNvbXBvbmVudHNbbmFtZVswXV07XG4gIH1cblxuICBnZXRDb21wb25lbnREZWZpbml0aW9uKG5hbWU6IHN0cmluZ1tdLCBibG9ja01ldGE/OiBUZW1wbGF0ZU1ldGEpOiBDb21wb25lbnREZWZpbml0aW9uPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmNvbXBvbmVudHNbbmFtZVswXV07XG4gIH1cblxuICBoYXNNb2RpZmllcihtb2RpZmllck5hbWU6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG1vZGlmaWVyTmFtZS5sZW5ndGggPT09IDEgJiYgKDxzdHJpbmc+bW9kaWZpZXJOYW1lWzBdIGluIHRoaXMubW9kaWZpZXJzKTtcbiAgfVxuXG4gIGxvb2t1cE1vZGlmaWVyKG1vZGlmaWVyTmFtZTogc3RyaW5nW10pOiBNb2RpZmllck1hbmFnZXI8T3BhcXVlPiB7XG4gICAgbGV0IFtuYW1lXSA9IG1vZGlmaWVyTmFtZTtcblxuICAgIGxldCBtb2RpZmllciA9IHRoaXMubW9kaWZpZXJzW25hbWVdO1xuXG4gICAgaWYoIW1vZGlmaWVyKSB0aHJvdyBuZXcgRXJyb3IoYE1vZGlmaWVyIGZvciAke21vZGlmaWVyTmFtZS5qb2luKCcuJyl9IG5vdCBmb3VuZC5gKTtcbiAgICByZXR1cm4gbW9kaWZpZXI7XG4gIH1cblxuICBjb21waWxlKHRlbXBsYXRlOiBzdHJpbmcpOiBUZW1wbGF0ZTx1bmRlZmluZWQ+IHtcbiAgICByZXR1cm4gcmF3Q29tcGlsZTx1bmRlZmluZWQ+KHRlbXBsYXRlLCB7IGVudjogdGhpcyB9KTtcbiAgfVxuXG4gIGNvbXBpbGVMYXlvdXQodGVtcGxhdGU6IHN0cmluZyk6IExheW91dCB7XG4gICAgcmV0dXJuIHJhd0NvbXBpbGVMYXlvdXQodGVtcGxhdGUsIHsgZW52OiB0aGlzIH0pO1xuICB9XG5cbiAgaXRlcmFibGVGb3IocmVmOiBSZWZlcmVuY2U8T3BhcXVlPiwgYXJnczogRXZhbHVhdGVkQXJncyk6IE9wYXF1ZUl0ZXJhYmxlIHtcbiAgICBsZXQga2V5UGF0aCA9IGFyZ3MubmFtZWQuZ2V0KFwia2V5XCIpLnZhbHVlKCkgYXMgRklYTUU8YW55LCBcIlVzZXIgdmFsdWUgdG8gbG9va3VwIGtleVwiPjtcbiAgICBsZXQga2V5Rm9yOiBLZXlGb3I8T3BhcXVlPjtcblxuICAgIGlmICgha2V5UGF0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHNwZWNpZnkgYSBrZXkgZm9yICNlYWNoJyk7XG4gICAgfVxuXG4gICAgc3dpdGNoIChrZXlQYXRoKSB7XG4gICAgICBjYXNlICdAaW5kZXgnOlxuICAgICAgICBrZXlGb3IgPSAoXywgaW5kZXg6IG51bWJlcikgPT4gU3RyaW5nKGluZGV4KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdAcHJpbWl0aXZlJzpcbiAgICAgICAga2V5Rm9yID0gKGl0ZW06IE9wYXF1ZSkgPT4gU3RyaW5nKGl0ZW0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIGtleUZvciA9IChpdGVtOiBPcGFxdWUpID0+IGl0ZW1ba2V5UGF0aF07XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgSXRlcmFibGUocmVmLCBrZXlGb3IpO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUZXN0RHluYW1pY1Njb3BlIGltcGxlbWVudHMgRHluYW1pY1Njb3BlIHtcbiAgcHJpdmF0ZSBidWNrZXQ7XG5cbiAgY29uc3RydWN0b3IoYnVja2V0PW51bGwpIHtcbiAgICBpZiAoYnVja2V0KSB7XG4gICAgICB0aGlzLmJ1Y2tldCA9IGFzc2lnbih7fSwgYnVja2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5idWNrZXQgPSB7fTtcbiAgICB9XG4gIH1cblxuICBnZXQoa2V5OiBzdHJpbmcpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICAgIHJldHVybiB0aGlzLmJ1Y2tldFtrZXldO1xuICB9XG5cbiAgc2V0KGtleTogc3RyaW5nLCByZWZlcmVuY2U6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPikge1xuICAgIHJldHVybiB0aGlzLmJ1Y2tldFtrZXldID0gcmVmZXJlbmNlO1xuICB9XG5cbiAgY2hpbGQoKTogVGVzdER5bmFtaWNTY29wZSB7XG4gICAgcmV0dXJuIG5ldyBUZXN0RHluYW1pY1Njb3BlKHRoaXMuYnVja2V0KTtcbiAgfVxufVxuXG5jbGFzcyBEeW5hbWljQ29tcG9uZW50UmVmZXJlbmNlIGltcGxlbWVudHMgUGF0aFJlZmVyZW5jZTxDb21wb25lbnREZWZpbml0aW9uPE9wYXF1ZT4+IHtcbiAgcHVibGljIHRhZzogUmV2aXNpb25UYWc7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSBuYW1lUmVmOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4sIHByaXZhdGUgZW52OiBFbnZpcm9ubWVudCwgcHJpdmF0ZSBzeW1ib2xUYWJsZTogU3ltYm9sVGFibGUpIHtcbiAgICB0aGlzLnRhZyA9IG5hbWVSZWYudGFnO1xuICB9XG5cbiAgdmFsdWUoKTogQ29tcG9uZW50RGVmaW5pdGlvbjxPcGFxdWU+IHtcbiAgICBsZXQgeyBlbnYsIG5hbWVSZWYgfSA9IHRoaXM7XG5cbiAgICBsZXQgbmFtZU9yRGVmID0gbmFtZVJlZi52YWx1ZSgpO1xuXG4gICAgaWYgKHR5cGVvZiBuYW1lT3JEZWYgPT09ICdzdHJpbmcnKSB7XG4gICAgICByZXR1cm4gZW52LmdldENvbXBvbmVudERlZmluaXRpb24oW25hbWVPckRlZl0sIHRoaXMuc3ltYm9sVGFibGUpO1xuICAgIH0gZWxzZSBpZiAoaXNDb21wb25lbnREZWZpbml0aW9uKG5hbWVPckRlZikpIHtcbiAgICAgIHJldHVybiBuYW1lT3JEZWY7XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBnZXQoKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZnVuY3Rpb24gZHluYW1pY0NvbXBvbmVudEZvcih2bTogVk0sIHN5bWJvbFRhYmxlOiBTeW1ib2xUYWJsZSkge1xuICBsZXQgYXJncyA9IHZtLmdldEFyZ3MoKTtcbiAgbGV0IG5hbWVSZWYgPSBhcmdzLnBvc2l0aW9uYWwuYXQoMCk7XG4gIGxldCBlbnYgPSB2bS5lbnY7XG4gIHJldHVybiBuZXcgRHluYW1pY0NvbXBvbmVudFJlZmVyZW5jZShuYW1lUmVmLCBlbnYsIHN5bWJvbFRhYmxlKTtcbn07XG5cbmV4cG9ydCBpbnRlcmZhY2UgQmFzaWNDb21wb25lbnRGYWN0b3J5IHtcbiAgbmV3KGF0dHJzOiBEaWN0PGFueT4pOiBCYXNpY0NvbXBvbmVudDtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEdlbmVyaWNDb21wb25lbnREZWZpbml0aW9uPFQ+IGV4dGVuZHMgQ29tcG9uZW50RGVmaW5pdGlvbjxUPiB7XG4gIHB1YmxpYyBsYXlvdXRTdHJpbmcgOiBzdHJpbmc7XG5cbiAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nLCBtYW5hZ2VyOiBDb21wb25lbnRNYW5hZ2VyPFQ+LCBDb21wb25lbnRDbGFzczogYW55LCBsYXlvdXQ6IHN0cmluZykge1xuICAgIHN1cGVyKG5hbWUsIG1hbmFnZXIsIENvbXBvbmVudENsYXNzKTtcbiAgICB0aGlzLmxheW91dFN0cmluZyA9IGxheW91dDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQmFzaWNDb21wb25lbnREZWZpbml0aW9uIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudERlZmluaXRpb248QmFzaWNDb21wb25lbnQ+IHtcbiAgcHVibGljIENvbXBvbmVudENsYXNzOiBCYXNpY0NvbXBvbmVudEZhY3Rvcnk7XG59XG5cbmNsYXNzIFN0YXRpY1RhZ2xlc3NDb21wb25lbnREZWZpbml0aW9uIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudERlZmluaXRpb248QmFzaWNDb21wb25lbnQ+IHtcbiAgcHVibGljIENvbXBvbmVudENsYXNzOiBCYXNpY0NvbXBvbmVudEZhY3Rvcnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1iZXJpc2hDdXJseUNvbXBvbmVudEZhY3Rvcnkge1xuICBwb3NpdGlvbmFsUGFyYW1zPzogc3RyaW5nW107XG4gIGNyZWF0ZShvcHRpb25zOiB7IGF0dHJzOiBBdHRycywgdGFyZ2V0T2JqZWN0IH0pOiBFbWJlcmlzaEN1cmx5Q29tcG9uZW50O1xufVxuXG5leHBvcnQgY2xhc3MgRW1iZXJpc2hDdXJseUNvbXBvbmVudERlZmluaXRpb24gZXh0ZW5kcyBHZW5lcmljQ29tcG9uZW50RGVmaW5pdGlvbjxFbWJlcmlzaEN1cmx5Q29tcG9uZW50PiB7XG4gIHB1YmxpYyBDb21wb25lbnRDbGFzczogRW1iZXJpc2hDdXJseUNvbXBvbmVudEZhY3Rvcnk7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50RmFjdG9yeSB7XG4gIGNyZWF0ZShvcHRpb25zOiB7IGF0dHJzOiBBdHRycyB9KTogRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50O1xufVxuXG5leHBvcnQgY2xhc3MgRW1iZXJpc2hHbGltbWVyQ29tcG9uZW50RGVmaW5pdGlvbiBleHRlbmRzIEdlbmVyaWNDb21wb25lbnREZWZpbml0aW9uPEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudD4ge1xuICBwdWJsaWMgQ29tcG9uZW50Q2xhc3M6IEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudEZhY3Rvcnk7XG59XG5cbmFic3RyYWN0IGNsYXNzIEdlbmVyaWNDb21wb25lbnRMYXlvdXRDb21waWxlciBpbXBsZW1lbnRzIENvbXBpbGFibGVMYXlvdXQge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGxheW91dFN0cmluZzogc3RyaW5nKSB7fVxuXG4gIHByb3RlY3RlZCBjb21waWxlTGF5b3V0KGVudjogRW52aXJvbm1lbnQpIHtcbiAgICByZXR1cm4gcmF3Q29tcGlsZUxheW91dCh0aGlzLmxheW91dFN0cmluZywgeyBlbnYgfSk7XG4gIH1cblxuICBhYnN0cmFjdCBjb21waWxlKGJ1aWxkZXI6IENvbXBvbmVudExheW91dEJ1aWxkZXIpO1xufVxuXG5jbGFzcyBCYXNpY0NvbXBvbmVudExheW91dENvbXBpbGVyIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudExheW91dENvbXBpbGVyIHtcbiAgY29tcGlsZShidWlsZGVyOiBDb21wb25lbnRMYXlvdXRCdWlsZGVyKSB7XG4gICAgYnVpbGRlci5mcm9tTGF5b3V0KHRoaXMuY29tcGlsZUxheW91dChidWlsZGVyLmVudikpO1xuICB9XG59XG5cbmNsYXNzIFN0YXRpY1RhZ2xlc3NDb21wb25lbnRMYXlvdXRDb21waWxlciBleHRlbmRzIEdlbmVyaWNDb21wb25lbnRMYXlvdXRDb21waWxlciB7XG4gIGNvbXBpbGUoYnVpbGRlcjogQ29tcG9uZW50TGF5b3V0QnVpbGRlcikge1xuICAgIGJ1aWxkZXIud3JhcExheW91dCh0aGlzLmNvbXBpbGVMYXlvdXQoYnVpbGRlci5lbnYpKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBFbWJlclRhZ05hbWUodm06IFZNKTogUGF0aFJlZmVyZW5jZTxzdHJpbmc+IHtcbiAgbGV0IHNlbGYgPSB2bS5nZXRTZWxmKCkudmFsdWUoKTtcbiAgbGV0IHRhZ05hbWU6IHN0cmluZyA9IHNlbGZbJ3RhZ05hbWUnXTtcbiAgdGFnTmFtZSA9IHRhZ05hbWUgPT09ICcnID8gbnVsbCA6IHNlbGZbJ3RhZ05hbWUnXSB8fCAnZGl2JztcbiAgcmV0dXJuIFByaW1pdGl2ZVJlZmVyZW5jZS5jcmVhdGUodGFnTmFtZSk7XG59XG5cbmZ1bmN0aW9uIEVtYmVySUQodm06IFZNKTogUGF0aFJlZmVyZW5jZTxzdHJpbmc+IHtcbiAgbGV0IHNlbGYgPSB2bS5nZXRTZWxmKCkudmFsdWUoKSBhcyB7IF9ndWlkOiBzdHJpbmcgfTtcbiAgcmV0dXJuIFByaW1pdGl2ZVJlZmVyZW5jZS5jcmVhdGUoYGVtYmVyJHtzZWxmLl9ndWlkfWApO1xufVxuXG5jbGFzcyBFbWJlcmlzaEN1cmx5Q29tcG9uZW50TGF5b3V0Q29tcGlsZXIgZXh0ZW5kcyBHZW5lcmljQ29tcG9uZW50TGF5b3V0Q29tcGlsZXIge1xuICBjb21waWxlKGJ1aWxkZXI6IENvbXBvbmVudExheW91dEJ1aWxkZXIpIHtcbiAgICBidWlsZGVyLndyYXBMYXlvdXQodGhpcy5jb21waWxlTGF5b3V0KGJ1aWxkZXIuZW52KSk7XG4gICAgYnVpbGRlci50YWcuZHluYW1pYyhFbWJlclRhZ05hbWUpO1xuICAgIGJ1aWxkZXIuYXR0cnMuc3RhdGljKCdjbGFzcycsICdlbWJlci12aWV3Jyk7XG4gICAgYnVpbGRlci5hdHRycy5keW5hbWljKCdpZCcsIEVtYmVySUQpO1xuICB9XG59XG5cbmNsYXNzIEVtYmVyaXNoR2xpbW1lckNvbXBvbmVudExheW91dENvbXBpbGVyIGV4dGVuZHMgR2VuZXJpY0NvbXBvbmVudExheW91dENvbXBpbGVyIHtcbiAgY29tcGlsZShidWlsZGVyOiBDb21wb25lbnRMYXlvdXRCdWlsZGVyKSB7XG4gICAgYnVpbGRlci5mcm9tTGF5b3V0KHRoaXMuY29tcGlsZUxheW91dChidWlsZGVyLmVudikpO1xuICAgIGJ1aWxkZXIuYXR0cnMuc3RhdGljKCdjbGFzcycsICdlbWJlci12aWV3Jyk7XG4gICAgYnVpbGRlci5hdHRycy5keW5hbWljKCdpZCcsIEVtYmVySUQpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNwZWN0SG9va3M8VCBleHRlbmRzIENvbXBvbmVudD4oQ29tcG9uZW50Q2xhc3M6IEdsaW1tZXJPYmplY3RGYWN0b3J5PFQ+KTogR2xpbW1lck9iamVjdEZhY3Rvcnk8VD4ge1xuICByZXR1cm4gQ29tcG9uZW50Q2xhc3MuZXh0ZW5kKHtcbiAgICBpbml0KCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3MgPSB7XG4gICAgICAgIGRpZEluaXRBdHRyczogMCxcbiAgICAgICAgZGlkVXBkYXRlQXR0cnM6IDAsXG4gICAgICAgIGRpZFJlY2VpdmVBdHRyczogMCxcbiAgICAgICAgd2lsbEluc2VydEVsZW1lbnQ6IDAsXG4gICAgICAgIHdpbGxVcGRhdGU6IDAsXG4gICAgICAgIHdpbGxSZW5kZXI6IDAsXG4gICAgICAgIGRpZEluc2VydEVsZW1lbnQ6IDAsXG4gICAgICAgIGRpZFVwZGF0ZTogMCxcbiAgICAgICAgZGlkUmVuZGVyOiAwXG4gICAgICB9O1xuICAgIH0sXG5cbiAgICBkaWRJbml0QXR0cnMoKSB7XG4gICAgICB0aGlzLl9zdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgdGhpcy5ob29rc1snZGlkSW5pdEF0dHJzJ10rKztcbiAgICB9LFxuXG4gICAgZGlkVXBkYXRlQXR0cnMoKSB7XG4gICAgICB0aGlzLl9zdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgdGhpcy5ob29rc1snZGlkVXBkYXRlQXR0cnMnXSsrO1xuICAgIH0sXG5cbiAgICBkaWRSZWNlaXZlQXR0cnMoKSB7XG4gICAgICB0aGlzLl9zdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgdGhpcy5ob29rc1snZGlkUmVjZWl2ZUF0dHJzJ10rKztcbiAgICB9LFxuXG4gICAgd2lsbEluc2VydEVsZW1lbnQoKSB7XG4gICAgICB0aGlzLl9zdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgdGhpcy5ob29rc1snd2lsbEluc2VydEVsZW1lbnQnXSsrO1xuICAgIH0sXG5cbiAgICB3aWxsVXBkYXRlKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ3dpbGxVcGRhdGUnXSsrO1xuICAgIH0sXG5cbiAgICB3aWxsUmVuZGVyKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ3dpbGxSZW5kZXInXSsrO1xuICAgIH0sXG5cbiAgICBkaWRJbnNlcnRFbGVtZW50KCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZEluc2VydEVsZW1lbnQnXSsrO1xuICAgIH0sXG5cbiAgICBkaWRVcGRhdGUoKSB7XG4gICAgICB0aGlzLl9zdXBlciguLi5hcmd1bWVudHMpO1xuICAgICAgdGhpcy5ob29rc1snZGlkVXBkYXRlJ10rKztcbiAgICB9LFxuXG4gICAgZGlkUmVuZGVyKCkge1xuICAgICAgdGhpcy5fc3VwZXIoLi4uYXJndW1lbnRzKTtcbiAgICAgIHRoaXMuaG9va3NbJ2RpZFJlbmRlciddKys7XG4gICAgfVxuICB9KTtcbn1cblxuY29uc3QgeyBkZWZhdWx0QmxvY2ssIGludmVyc2VCbG9jaywgcGFyYW1zLCBoYXNoIH0gPSBCYXNlbGluZVN5bnRheC5OZXN0ZWRCbG9jaztcblxuZnVuY3Rpb24gcG9wdWxhdGVCbG9ja3MoYmxvY2tzOiBCbG9ja01hY3JvcywgaW5saW5lczogSW5saW5lTWFjcm9zKTogeyBibG9ja3M6IEJsb2NrTWFjcm9zLCBpbmxpbmVzOiBJbmxpbmVNYWNyb3MgfSB7XG4gIGJsb2Nrcy5hZGQoJ2lkZW50aXR5JywgKHNleHA6IE5lc3RlZEJsb2NrU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyRFNMKSA9PiB7XG4gICAgYnVpbGRlci5ldmFsdWF0ZShzZXhwWzRdKTtcbiAgfSk7XG5cbiAgYmxvY2tzLmFkZCgncmVuZGVyLWludmVyc2UnLCAoc2V4cDogTmVzdGVkQmxvY2tTeW50YXgsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXJEU0wpID0+IHtcbiAgICBidWlsZGVyLmV2YWx1YXRlKHNleHBbNV0pO1xuICB9KTtcblxuICBibG9ja3MuYWRkKCctd2l0aC1keW5hbWljLXZhcnMnLCAoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBibG9jayA9IGRlZmF1bHRCbG9jayhzZXhwKTtcbiAgICBsZXQgYXJncyA9IGNvbXBpbGVBcmdzKHBhcmFtcyhzZXhwKSwgaGFzaChzZXhwKSwgYnVpbGRlcik7XG5cbiAgICBidWlsZGVyLnVuaXQoYiA9PiB7XG4gICAgICBiLnB1dEFyZ3MoYXJncyk7XG4gICAgICBiLnB1c2hEeW5hbWljU2NvcGUoKTtcbiAgICAgIGIuYmluZER5bmFtaWNTY29wZShhcmdzLm5hbWVkLmtleXMgYXMgc3RyaW5nW10pO1xuICAgICAgYi5ldmFsdWF0ZSh1bndyYXAoYmxvY2spKTtcbiAgICAgIGIucG9wRHluYW1pY1Njb3BlKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGJsb2Nrcy5hZGQoJy1pbi1lbGVtZW50JywgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgYmxvY2sgPSBkZWZhdWx0QmxvY2soc2V4cCk7XG4gICAgbGV0IGFyZ3MgPSBjb21waWxlQXJncyhwYXJhbXMoc2V4cCksIGhhc2goc2V4cCksIGJ1aWxkZXIpO1xuXG4gICAgYnVpbGRlci5wdXRBcmdzKGFyZ3MpO1xuICAgIGJ1aWxkZXIudGVzdCgnc2ltcGxlJyk7XG5cbiAgICBidWlsZGVyLmxhYmVsbGVkKG51bGwsIGIgPT4ge1xuICAgICAgYi5qdW1wVW5sZXNzKCdFTkQnKTtcbiAgICAgIGIucHVzaFJlbW90ZUVsZW1lbnQoKTtcbiAgICAgIGIuZXZhbHVhdGUodW53cmFwKGJsb2NrKSk7XG4gICAgICBiLnBvcFJlbW90ZUVsZW1lbnQoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgYmxvY2tzLmFkZCgnY29tcG9uZW50JywgKHNleHAsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgWywgcGF0aCwgcGFyYW1zLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV0gPSBzZXhwO1xuICAgIGxldCBkZWZpbml0aW9uQXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtwYXJhbXMuc2xpY2UoMCwgMSksIG51bGwsIG51bGwsIG51bGxdO1xuICAgIGxldCBhcmdzOiBCYXNlbGluZVN5bnRheC5BcmdzID0gW3BhcmFtcy5zbGljZSgxKSwgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdO1xuICAgIGJ1aWxkZXIuY29tcG9uZW50LmR5bmFtaWMoZGVmaW5pdGlvbkFyZ3MsIGR5bmFtaWNDb21wb25lbnRGb3IsIGFyZ3MsIGJ1aWxkZXIuc3ltYm9sVGFibGUpO1xuICAgIHJldHVybiB0cnVlO1xuICB9KTtcblxuICBibG9ja3MuYWRkTWlzc2luZygoc2V4cCwgYnVpbGRlcikgPT4ge1xuICAgIGxldCBbLCBwYXRoLCBwYXJhbXMsIGhhc2gsIF9kZWZhdWx0LCBpbnZlcnNlXSA9IHNleHA7XG4gICAgbGV0IHRhYmxlID0gYnVpbGRlci5zeW1ib2xUYWJsZTtcblxuICAgIGlmICghcGFyYW1zKSB7XG4gICAgICBwYXJhbXMgPSBbXTtcbiAgICB9XG5cbiAgICBpZiAocGF0aC5sZW5ndGggPiAxKSB7XG4gICAgICBsZXQgZGVmaW5pdGlvbkFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MgPSBbW1snZ2V0JywgcGF0aF1dLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV07XG4gICAgICBsZXQgYXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtwYXJhbXMsIGhhc2gsIF9kZWZhdWx0LCBpbnZlcnNlXTtcbiAgICAgIGJ1aWxkZXIuY29tcG9uZW50LmR5bmFtaWMoZGVmaW5pdGlvbkFyZ3MsIGR5bmFtaWNDb21wb25lbnRGb3IsIGFyZ3MsIHRhYmxlKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIGxldCBkZWZpbml0aW9uID0gYnVpbGRlci5lbnYuZ2V0Q29tcG9uZW50RGVmaW5pdGlvbihwYXRoLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcblxuICAgIGlmIChkZWZpbml0aW9uKSB7XG4gICAgICBidWlsZGVyLmNvbXBvbmVudC5zdGF0aWMoZGVmaW5pdGlvbiwgW3BhcmFtcywgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdLCB0YWJsZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuXG4gIGlubGluZXMuYWRkKCdjb21wb25lbnQnLCAocGF0aCwgcGFyYW1zLCBoYXNoLCBidWlsZGVyKSA9PiB7XG4gICAgbGV0IGRlZmluaXRpb25BcmdzOiBCYXNlbGluZVN5bnRheC5BcmdzID0gW3BhcmFtcy5zbGljZSgwLCAxKSwgbnVsbCwgbnVsbCwgbnVsbF07XG4gICAgbGV0IGFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MgPSBbcGFyYW1zLnNsaWNlKDEpLCBoYXNoLCBudWxsLCBudWxsXTtcbiAgICBidWlsZGVyLmNvbXBvbmVudC5keW5hbWljKGRlZmluaXRpb25BcmdzLCBkeW5hbWljQ29tcG9uZW50Rm9yLCBhcmdzLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSk7XG5cbiAgaW5saW5lcy5hZGRNaXNzaW5nKChwYXRoLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpID0+IHtcbiAgICBsZXQgdGFibGUgPSBidWlsZGVyLnN5bWJvbFRhYmxlO1xuXG4gICAgbGV0IGRlZmluaXRpb24gPSBidWlsZGVyLmVudi5nZXRDb21wb25lbnREZWZpbml0aW9uKHBhdGgsIGJ1aWxkZXIuc3ltYm9sVGFibGUpO1xuXG4gICAgaWYgKHBhdGgubGVuZ3RoID4gMSkge1xuICAgICAgbGV0IGRlZmluaXRpb25BcmdzOiBCYXNlbGluZVN5bnRheC5BcmdzID0gW1tbJ2dldCcsIHBhdGhdXSwgaGFzaCwgbnVsbCwgbnVsbF07XG4gICAgICBsZXQgYXJnczogQmFzZWxpbmVTeW50YXguQXJncyA9IFtwYXJhbXMsIGhhc2gsIG51bGwsIG51bGxdO1xuICAgICAgYnVpbGRlci5jb21wb25lbnQuZHluYW1pYyhkZWZpbml0aW9uQXJncywgZHluYW1pY0NvbXBvbmVudEZvciwgYXJncywgdGFibGUpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGRlZmluaXRpb24pIHtcbiAgICAgIGJ1aWxkZXIuY29tcG9uZW50LnN0YXRpYyhkZWZpbml0aW9uLCBbcGFyYW1zLCBoYXNoLCBudWxsLCBudWxsXSwgdGFibGUpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcblxuICByZXR1cm4geyBibG9ja3MsIGlubGluZXMgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsc0VsZW1lbnQoZWxlbWVudDogRWxlbWVudCwgdGFnTmFtZTogc3RyaW5nLCBhdHRyaWJ1dGVzOiBPYmplY3QsIGNvbnRlbnQ6IHN0cmluZykge1xuICBRVW5pdC5wdXNoKGVsZW1lbnQudGFnTmFtZSA9PT0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpLCBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSwgdGFnTmFtZSwgYGV4cGVjdCB0YWdOYW1lIHRvIGJlICR7dGFnTmFtZX1gKTtcblxuICBsZXQgZXhwZWN0ZWRBdHRyczogRGljdDxNYXRjaGVyPiA9IGRpY3Q8TWF0Y2hlcj4oKTtcblxuICBsZXQgZXhwZWN0ZWRDb3VudCA9IDA7XG4gIGZvciAobGV0IHByb3AgaW4gYXR0cmlidXRlcykge1xuICAgIGV4cGVjdGVkQ291bnQrKztcbiAgICBsZXQgZXhwZWN0ZWQgPSBhdHRyaWJ1dGVzW3Byb3BdO1xuXG4gICAgbGV0IG1hdGNoZXI6IE1hdGNoZXIgPSB0eXBlb2YgZXhwZWN0ZWQgPT09ICdvYmplY3QnICYmIE1BVENIRVIgaW4gZXhwZWN0ZWQgPyBleHBlY3RlZCA6IGVxdWFsc0F0dHIoZXhwZWN0ZWQpO1xuICAgIGV4cGVjdGVkQXR0cnNbcHJvcF0gPSBtYXRjaGVyO1xuXG4gICAgUVVuaXQucHVzaChcbiAgICAgIGV4cGVjdGVkQXR0cnNbcHJvcF0ubWF0Y2goZWxlbWVudC5nZXRBdHRyaWJ1dGUocHJvcCkpLFxuICAgICAgbWF0Y2hlci5mYWlsKGVsZW1lbnQuZ2V0QXR0cmlidXRlKHByb3ApKSxcbiAgICAgIG1hdGNoZXIuZmFpbChlbGVtZW50LmdldEF0dHJpYnV0ZShwcm9wKSksXG4gICAgICBgRXhwZWN0ZWQgZWxlbWVudCdzICR7cHJvcH0gYXR0cmlidXRlICR7bWF0Y2hlci5leHBlY3RlZCgpfWBcbiAgICApO1xuICB9XG5cbiAgbGV0IGFjdHVhbEF0dHJpYnV0ZXMgPSB7fTtcbiAgZm9yIChsZXQgaSA9IDAsIGwgPSBlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgYWN0dWFsQXR0cmlidXRlc1tlbGVtZW50LmF0dHJpYnV0ZXNbaV0ubmFtZV0gPSBlbGVtZW50LmF0dHJpYnV0ZXNbaV0udmFsdWU7XG4gIH1cblxuICBpZiAoIShlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpKSB7XG4gICAgUVVuaXQucHVzaChlbGVtZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQsIG51bGwsIG51bGwsIFwiRWxlbWVudCBtdXN0IGJlIGFuIEhUTUwgRWxlbWVudCwgbm90IGFuIFNWRyBFbGVtZW50XCIpO1xuICB9IGVsc2Uge1xuICAgIFFVbml0LnB1c2goXG4gICAgICBlbGVtZW50LmF0dHJpYnV0ZXMubGVuZ3RoID09PSBleHBlY3RlZENvdW50LFxuICAgICAgZWxlbWVudC5hdHRyaWJ1dGVzLmxlbmd0aCwgZXhwZWN0ZWRDb3VudCxcbiAgICAgIGBFeHBlY3RlZCAke2V4cGVjdGVkQ291bnR9IGF0dHJpYnV0ZXM7IGdvdCAke2VsZW1lbnQub3V0ZXJIVE1MfWBcbiAgICApO1xuXG4gICAgaWYgKGNvbnRlbnQgIT09IG51bGwpIHtcbiAgICAgIFFVbml0LnB1c2goZWxlbWVudC5pbm5lckhUTUwgPT09IGNvbnRlbnQsIGVsZW1lbnQuaW5uZXJIVE1MLCBjb250ZW50LCBgVGhlIGVsZW1lbnQgaGFkICcke2NvbnRlbnR9JyBhcyBpdHMgY29udGVudGApO1xuICAgIH1cbiAgfVxufVxuXG5pbnRlcmZhY2UgTWF0Y2hlciB7XG4gIFwiM2Q0ZWYxOTQtMTNiZS00Y2NmLThkYzctODYyZWVhMDJjOTNlXCI6IGJvb2xlYW47XG4gIG1hdGNoKGFjdHVhbCk6IGJvb2xlYW47XG4gIGZhaWwoYWN0dWFsKTogc3RyaW5nO1xuICBleHBlY3RlZCgpOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBjb25zdCBNQVRDSEVSID0gXCIzZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2VcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGVxdWFsc0F0dHIoZXhwZWN0ZWQpIHtcbiAgcmV0dXJuIHtcbiAgICBcIjNkNGVmMTk0LTEzYmUtNGNjZi04ZGM3LTg2MmVlYTAyYzkzZVwiOiB0cnVlLFxuICAgIG1hdGNoKGFjdHVhbCkge1xuICAgICAgcmV0dXJuIGV4cGVjdGVkID09PSBhY3R1YWw7XG4gICAgfSxcblxuICAgIGV4cGVjdGVkKCkge1xuICAgICAgcmV0dXJuIGB0byBlcXVhbCAke2V4cGVjdGVkfWA7XG4gICAgfSxcblxuICAgIGZhaWwoYWN0dWFsKSB7XG4gICAgICByZXR1cm4gYCR7YWN0dWFsfSBkaWQgbm90IGVxdWFsICR7ZXhwZWN0ZWR9YDtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlcXVhbHMoZXhwZWN0ZWQpIHtcbiAgcmV0dXJuIHtcbiAgICBcIjNkNGVmMTk0LTEzYmUtNGNjZi04ZGM3LTg2MmVlYTAyYzkzZVwiOiB0cnVlLFxuICAgIG1hdGNoKGFjdHVhbCkge1xuICAgICAgcmV0dXJuIGV4cGVjdGVkID09PSBhY3R1YWw7XG4gICAgfSxcblxuICAgIGV4cGVjdGVkKCkge1xuICAgICAgcmV0dXJuIGB0byBlcXVhbCAke2V4cGVjdGVkfWA7XG4gICAgfSxcblxuICAgIGZhaWwoYWN0dWFsKSB7XG4gICAgICByZXR1cm4gYCR7YWN0dWFsfSBkaWQgbm90IGVxdWFsICR7ZXhwZWN0ZWR9YDtcbiAgICB9XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWdleChyKSB7XG4gIHJldHVybiB7XG4gICAgXCIzZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2VcIjogdHJ1ZSxcbiAgICBtYXRjaCh2KSB7XG4gICAgICByZXR1cm4gci50ZXN0KHYpO1xuICAgIH0sXG4gICAgZXhwZWN0ZWQoKSB7XG4gICAgICByZXR1cm4gYHRvIG1hdGNoICR7cn1gO1xuICAgIH0sXG4gICAgZmFpbChhY3R1YWwpIHtcbiAgICAgIHJldHVybiBgJHthY3R1YWx9IGRpZCBub3QgbWF0Y2ggJHtyfWA7XG4gICAgfVxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xhc3NlcyhleHBlY3RlZDogc3RyaW5nKSB7XG4gIHJldHVybiB7XG4gICAgXCIzZDRlZjE5NC0xM2JlLTRjY2YtOGRjNy04NjJlZWEwMmM5M2VcIjogdHJ1ZSxcbiAgICBtYXRjaChhY3R1YWwpIHtcbiAgICAgIHJldHVybiBhY3R1YWwgJiYgKGV4cGVjdGVkLnNwbGl0KCcgJykuc29ydCgpLmpvaW4oJyAnKSA9PT0gYWN0dWFsLnNwbGl0KCcgJykuc29ydCgpLmpvaW4oJyAnKSk7XG4gICAgfSxcbiAgICBleHBlY3RlZCgpIHtcbiAgICAgIHJldHVybiBgdG8gaW5jbHVkZSAnJHtleHBlY3RlZH0nYDtcbiAgICB9LFxuICAgIGZhaWwoYWN0dWFsKSB7XG4gICAgICByZXR1cm4gYCcke2FjdHVhbH0nJyBkaWQgbm90IG1hdGNoICcke2V4cGVjdGVkfSdgO1xuICAgIH1cbiAgfTtcbn1cbiJdfQ==