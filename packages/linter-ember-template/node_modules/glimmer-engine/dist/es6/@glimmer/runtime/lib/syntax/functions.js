import CompiledValue from '../compiled/expressions/value';
import CompiledHasBlock, { CompiledHasBlockParams } from '../compiled/expressions/has-block';
import { LOGGER, dict, assert, unwrap, unreachable } from '@glimmer/util';
import CompiledLookup, { CompiledSelf, CompiledSymbol, CompiledInPartialName } from '../compiled/expressions/lookups';
import CompiledHelper from '../compiled/expressions/helper';
import CompiledConcat from '../compiled/expressions/concat';
import { COMPILED_EMPTY_POSITIONAL_ARGS, COMPILED_EMPTY_NAMED_ARGS, EMPTY_BLOCKS, CompiledArgs, CompiledPositionalArgs, CompiledNamedArgs } from '../compiled/expressions/args';
import { CompiledGetBlockBySymbol, CompiledInPartialGetBlock } from '../compiled/expressions/has-block';
import { CompiledFunctionExpression } from '../compiled/expressions/function';
function debugCallback(context, get) {
    console.info('Use `context`, and `get(<path>)` to debug this template.');
    /* tslint:disable */
    debugger;
    /* tslint:enable */
    return { context, get };
}
function getter(vm, builder) {
    return (path) => {
        let parts = path.split('.');
        if (parts[0] === 'this') {
            parts[0] = null;
        }
        return compileRef(parts, builder).evaluate(vm);
    };
}
let callback = debugCallback;
// For testing purposes
export function setDebuggerCallback(cb) {
    callback = cb;
}
export function resetDebuggerCallback() {
    callback = debugCallback;
}
export class Compilers {
    constructor() {
        this.names = dict();
        this.funcs = [];
    }
    add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    }
    compile(sexp, builder) {
        let name = sexp[0];
        let index = this.names[name];
        let func = this.funcs[index];
        assert(!!func, `expected an implementation for ${sexp[0]}`);
        return func(sexp, builder);
    }
}
export const STATEMENTS = new Compilers();
STATEMENTS.add('text', (sexp, builder) => {
    builder.text(sexp[1]);
});
STATEMENTS.add('comment', (sexp, builder) => {
    builder.comment(sexp[1]);
});
STATEMENTS.add('close-element', (_sexp, builder) => {
    LOGGER.trace('close-element statement');
    builder.closeElement();
});
STATEMENTS.add('flush-element', (_sexp, builder) => {
    builder.flushElement();
});
STATEMENTS.add('modifier', (sexp, builder) => {
    let [, path, params, hash] = sexp;
    let args = compileArgs(params, hash, builder);
    if (builder.env.hasModifier(path, builder.symbolTable)) {
        builder.modifier(path[0], args);
    }
    else {
        throw new Error(`Compile Error ${path.join('.')} is not a modifier: Helpers may not be used in the element form.`);
    }
});
STATEMENTS.add('static-attr', (sexp, builder) => {
    let [, name, value, namespace] = sexp;
    builder.staticAttr(name, namespace, value);
});
STATEMENTS.add('any-dynamic-attr', (sexp, builder) => {
    let [, name, value, namespace, trusting] = sexp;
    builder.putValue(value);
    if (namespace) {
        builder.dynamicAttrNS(name, namespace, trusting);
    }
    else {
        builder.dynamicAttr(name, trusting);
    }
});
STATEMENTS.add('open-element', (sexp, builder) => {
    LOGGER.trace('open-element statement');
    builder.openPrimitiveElement(sexp[1]);
});
STATEMENTS.add('optimized-append', (sexp, builder) => {
    let [, value, trustingMorph] = sexp;
    let { inlines } = builder.env.macros();
    let returned = inlines.compile(sexp, builder) || value;
    if (returned === true)
        return;
    builder.putValue(returned[1]);
    if (trustingMorph) {
        builder.trustingAppend();
    }
    else {
        builder.cautiousAppend();
    }
});
STATEMENTS.add('unoptimized-append', (sexp, builder) => {
    let [, value, trustingMorph] = sexp;
    let { inlines } = builder.env.macros();
    let returned = inlines.compile(sexp, builder) || value;
    if (returned === true)
        return;
    if (trustingMorph) {
        builder.guardedTrustingAppend(returned[1]);
    }
    else {
        builder.guardedCautiousAppend(returned[1]);
    }
});
STATEMENTS.add('nested-block', (sexp, builder) => {
    let { blocks } = builder.env.macros();
    blocks.compile(sexp, builder);
});
STATEMENTS.add('scanned-block', (sexp, builder) => {
    let [, path, params, hash, template, inverse] = sexp;
    let templateBlock = template && template.scan();
    let inverseBlock = inverse && inverse.scan();
    let { blocks } = builder.env.macros();
    blocks.compile(['nested-block', path, params, hash, templateBlock, inverseBlock], builder);
});
STATEMENTS.add('scanned-component', (sexp, builder) => {
    let [, tag, attrs, rawArgs, rawBlock] = sexp;
    let block = rawBlock && rawBlock.scan();
    let args = compileBlockArgs(null, rawArgs, { default: block, inverse: null }, builder);
    let definition = builder.env.getComponentDefinition([tag], builder.symbolTable);
    builder.putComponentDefinition(definition);
    builder.openComponent(args, attrs.scan());
    builder.closeComponent();
});
STATEMENTS.add('static-partial', (sexp, builder) => {
    let [, name] = sexp;
    if (!builder.env.hasPartial(name, builder.symbolTable)) {
        throw new Error(`Compile Error: Could not find a partial named "${name}"`);
    }
    let definition = builder.env.lookupPartial(name, builder.symbolTable);
    builder.putPartialDefinition(definition);
    builder.evaluatePartial();
});
STATEMENTS.add('dynamic-partial', (sexp, builder) => {
    let [, name] = sexp;
    builder.startLabels();
    builder.putValue(name);
    builder.test('simple');
    builder.enter('BEGIN', 'END');
    builder.label('BEGIN');
    builder.jumpUnless('END');
    builder.putDynamicPartialDefinition();
    builder.evaluatePartial();
    builder.label('END');
    builder.exit();
    builder.stopLabels();
});
STATEMENTS.add('yield', function (sexp, builder) {
    let [, to, params] = sexp;
    let args = compileArgs(params, null, builder);
    builder.yield(args, to);
});
STATEMENTS.add('debugger', (sexp, builder) => {
    builder.putValue(['function', (vm) => {
            let context = vm.getSelf().value();
            let get = (path) => {
                return getter(vm, builder)(path).value();
            };
            callback(context, get);
        }]);
    return sexp;
});
let EXPRESSIONS = new Compilers();
export function expr(expression, builder) {
    if (Array.isArray(expression)) {
        return EXPRESSIONS.compile(expression, builder);
    }
    else {
        return new CompiledValue(expression);
    }
}
EXPRESSIONS.add('unknown', (sexp, builder) => {
    let path = sexp[1];
    if (builder.env.hasHelper(path, builder.symbolTable)) {
        return new CompiledHelper(path, builder.env.lookupHelper(path, builder.symbolTable), CompiledArgs.empty(), builder.symbolTable);
    }
    else {
        return compileRef(path, builder);
    }
});
EXPRESSIONS.add('concat', ((sexp, builder) => {
    let params = sexp[1].map(p => expr(p, builder));
    return new CompiledConcat(params);
}));
EXPRESSIONS.add('function', (sexp, builder) => {
    return new CompiledFunctionExpression(sexp[1], builder.symbolTable);
});
EXPRESSIONS.add('helper', (sexp, builder) => {
    let { env, symbolTable } = builder;
    let [, path, params, hash] = sexp;
    if (env.hasHelper(path, symbolTable)) {
        let args = compileArgs(params, hash, builder);
        return new CompiledHelper(path, env.lookupHelper(path, symbolTable), args, symbolTable);
    }
    else {
        throw new Error(`Compile Error: ${path.join('.')} is not a helper`);
    }
});
EXPRESSIONS.add('get', (sexp, builder) => {
    return compileRef(sexp[1], builder);
});
EXPRESSIONS.add('undefined', (_sexp, _builder) => {
    return new CompiledValue(undefined);
});
EXPRESSIONS.add('arg', (sexp, builder) => {
    let [, parts] = sexp;
    let head = parts[0];
    let named, partial;
    if (named = builder.symbolTable.getSymbol('named', head)) {
        let path = parts.slice(1);
        let inner = new CompiledSymbol(named, head);
        return CompiledLookup.create(inner, path);
    }
    else if (partial = builder.symbolTable.getPartialArgs()) {
        let path = parts.slice(1);
        let inner = new CompiledInPartialName(partial, head);
        return CompiledLookup.create(inner, path);
    }
    else {
        throw new Error(`[BUG] @${parts.join('.')} is not a valid lookup path.`);
    }
});
EXPRESSIONS.add('has-block', (sexp, builder) => {
    let blockName = sexp[1];
    let yields, partial;
    if (yields = builder.symbolTable.getSymbol('yields', blockName)) {
        let inner = new CompiledGetBlockBySymbol(yields, blockName);
        return new CompiledHasBlock(inner);
    }
    else if (partial = builder.symbolTable.getPartialArgs()) {
        let inner = new CompiledInPartialGetBlock(partial, blockName);
        return new CompiledHasBlock(inner);
    }
    else {
        throw new Error('[BUG] ${blockName} is not a valid block name.');
    }
});
EXPRESSIONS.add('has-block-params', (sexp, builder) => {
    let blockName = sexp[1];
    let yields, partial;
    if (yields = builder.symbolTable.getSymbol('yields', blockName)) {
        let inner = new CompiledGetBlockBySymbol(yields, blockName);
        return new CompiledHasBlockParams(inner);
    }
    else if (partial = builder.symbolTable.getPartialArgs()) {
        let inner = new CompiledInPartialGetBlock(partial, blockName);
        return new CompiledHasBlockParams(inner);
    }
    else {
        throw new Error('[BUG] ${blockName} is not a valid block name.');
    }
});
export function compileArgs(params, hash, builder) {
    let compiledParams = compileParams(params, builder);
    let compiledHash = compileHash(hash, builder);
    return CompiledArgs.create(compiledParams, compiledHash, EMPTY_BLOCKS);
}
export function compileBlockArgs(params, hash, blocks, builder) {
    let compiledParams = compileParams(params, builder);
    let compiledHash = compileHash(hash, builder);
    return CompiledArgs.create(compiledParams, compiledHash, blocks);
}
export function compileBaselineArgs(args, builder) {
    let [params, hash, _default, inverse] = args;
    return CompiledArgs.create(compileParams(params, builder), compileHash(hash, builder), { default: _default, inverse });
}
function compileParams(params, builder) {
    if (!params || params.length === 0)
        return COMPILED_EMPTY_POSITIONAL_ARGS;
    let compiled = params.map(p => expr(p, builder));
    return CompiledPositionalArgs.create(compiled);
}
function compileHash(hash, builder) {
    if (!hash)
        return COMPILED_EMPTY_NAMED_ARGS;
    let [keys, values] = hash;
    if (keys.length === 0)
        return COMPILED_EMPTY_NAMED_ARGS;
    let compiled = values.map(p => expr(p, builder));
    return new CompiledNamedArgs(keys, compiled);
}
function compileRef(parts, builder) {
    let head = parts[0];
    let local;
    if (head === null) {
        let inner = new CompiledSelf();
        let path = parts.slice(1);
        return CompiledLookup.create(inner, path);
    }
    else if (local = builder.symbolTable.getSymbol('local', head)) {
        let path = parts.slice(1);
        let inner = new CompiledSymbol(local, head);
        return CompiledLookup.create(inner, path);
    }
    else {
        let inner = new CompiledSelf();
        return CompiledLookup.create(inner, parts);
    }
}
export class Blocks {
    constructor() {
        this.names = dict();
        this.funcs = [];
    }
    add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    }
    addMissing(func) {
        this.missing = func;
    }
    compile(sexp, builder) {
        // assert(sexp[1].length === 1, 'paths in blocks are not supported');
        let name = sexp[1][0];
        let index = this.names[name];
        if (index === undefined) {
            assert(!!this.missing, `${name} not found, and no catch-all block handler was registered`);
            let func = this.missing;
            let handled = func(sexp, builder);
            assert(!!handled, `${name} not found, and the catch-all block handler didn't handle it`);
        }
        else {
            let func = this.funcs[index];
            func(sexp, builder);
        }
    }
}
export const BLOCKS = new Blocks();
export class Inlines {
    constructor() {
        this.names = dict();
        this.funcs = [];
    }
    add(name, func) {
        this.funcs.push(func);
        this.names[name] = this.funcs.length - 1;
    }
    addMissing(func) {
        this.missing = func;
    }
    compile(sexp, builder) {
        let value = sexp[1];
        // TODO: Fix this so that expression macros can return
        // things like components, so that {{component foo}}
        // is the same as {{(component foo)}}
        if (!Array.isArray(value))
            return ['expr', value];
        let path;
        let params;
        let hash;
        if (value[0] === 'helper') {
            path = value[1];
            params = value[2];
            hash = value[3];
        }
        else if (value[0] === 'unknown') {
            path = value[1];
            params = hash = null;
        }
        else {
            return ['expr', value];
        }
        if (path.length > 1 && !params && !hash) {
            return ['expr', value];
        }
        let name = path[0];
        let index = this.names[name];
        if (index === undefined && this.missing) {
            let func = this.missing;
            let returned = func(path, params, hash, builder);
            return returned === false ? ['expr', value] : returned;
        }
        else if (index !== undefined) {
            let func = this.funcs[index];
            let returned = func(path, params, hash, builder);
            return returned === false ? ['expr', value] : returned;
        }
        else {
            return ['expr', value];
        }
    }
}
export const INLINES = new Inlines();
populateBuiltins(BLOCKS, INLINES);
export function populateBuiltins(blocks = new Blocks(), inlines = new Inlines()) {
    blocks.add('if', (sexp, builder) => {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        let [, , params, hash, _default, inverse] = sexp;
        let args = compileArgs(params, hash, builder);
        builder.putArgs(args);
        builder.test('environment');
        builder.labelled(null, b => {
            if (_default && inverse) {
                b.jumpUnless('ELSE');
                b.evaluate(_default);
                b.jump('END');
                b.label('ELSE');
                b.evaluate(inverse);
            }
            else if (_default) {
                b.jumpUnless('END');
                b.evaluate(_default);
            }
            else {
                throw unreachable();
            }
        });
    });
    blocks.add('unless', (sexp, builder) => {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        let [, , params, hash, _default, inverse] = sexp;
        let args = compileArgs(params, hash, builder);
        builder.putArgs(args);
        builder.test('environment');
        builder.labelled(null, b => {
            if (_default && inverse) {
                b.jumpIf('ELSE');
                b.evaluate(_default);
                b.jump('END');
                b.label('ELSE');
                b.evaluate(inverse);
            }
            else if (_default) {
                b.jumpIf('END');
                b.evaluate(_default);
            }
            else {
                throw unreachable();
            }
        });
    });
    blocks.add('with', (sexp, builder) => {
        //        PutArgs
        //        Test(Environment)
        //        Enter(BEGIN, END)
        // BEGIN: Noop
        //        JumpUnless(ELSE)
        //        Evaluate(default)
        //        Jump(END)
        // ELSE:  Noop
        //        Evalulate(inverse)
        // END:   Noop
        //        Exit
        let [, , params, hash, _default, inverse] = sexp;
        let args = compileArgs(params, hash, builder);
        builder.putArgs(args);
        builder.test('environment');
        builder.labelled(null, b => {
            if (_default && inverse) {
                b.jumpUnless('ELSE');
                b.evaluate(_default);
                b.jump('END');
                b.label('ELSE');
                b.evaluate(inverse);
            }
            else if (_default) {
                b.jumpUnless('END');
                b.evaluate(_default);
            }
            else {
                throw unreachable();
            }
        });
    });
    blocks.add('each', (sexp, builder) => {
        //         Enter(BEGIN, END)
        // BEGIN:  Noop
        //         PutArgs
        //         PutIterable
        //         JumpUnless(ELSE)
        //         EnterList(BEGIN2, END2)
        // ITER:   Noop
        //         NextIter(BREAK)
        //         EnterWithKey(BEGIN2, END2)
        // BEGIN2: Noop
        //         PushChildScope
        //         Evaluate(default)
        //         PopScope
        // END2:   Noop
        //         Exit
        //         Jump(ITER)
        // BREAK:  Noop
        //         ExitList
        //         Jump(END)
        // ELSE:   Noop
        //         Evalulate(inverse)
        // END:    Noop
        //         Exit
        let [, , params, hash, _default, inverse] = sexp;
        let args = compileArgs(params, hash, builder);
        builder.labelled(args, b => {
            b.putIterator();
            if (inverse) {
                b.jumpUnless('ELSE');
            }
            else {
                b.jumpUnless('END');
            }
            b.iter(b => {
                b.evaluate(unwrap(_default));
            });
            if (inverse) {
                b.jump('END');
                b.label('ELSE');
                b.evaluate(inverse);
            }
        });
    });
    return { blocks, inlines };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25zLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQGdsaW1tZXIvcnVudGltZS9saWIvc3ludGF4L2Z1bmN0aW9ucy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFHQSxPQUFPLGFBQWEsTUFBTSwrQkFBK0IsQ0FBQztBQUMxRCxPQUFPLGdCQUFnQixFQUFFLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxtQ0FBbUMsQ0FBQztBQUU3RixPQUFPLEVBQUUsTUFBTSxFQUFrQixJQUFJLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxXQUFXLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDMUYsT0FBTyxjQUFjLEVBQUUsRUFDckIsWUFBWSxFQUNaLGNBQWMsRUFDZCxxQkFBcUIsRUFDdEIsTUFBTSxpQ0FBaUMsQ0FBQztBQUN6QyxPQUFPLGNBQWMsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM1RCxPQUFPLGNBQWMsTUFBTSxnQ0FBZ0MsQ0FBQztBQUM1RCxPQUFPLEVBQ0wsOEJBQThCLEVBQzlCLHlCQUF5QixFQUN6QixZQUFZLEVBQ1osWUFBWSxFQUNaLHNCQUFzQixFQUN0QixpQkFBaUIsRUFFbEIsTUFBTSw4QkFBOEIsQ0FBQztBQUN0QyxPQUFPLEVBQ0wsd0JBQXdCLEVBQ3hCLHlCQUF5QixFQUMxQixNQUFNLG1DQUFtQyxDQUFDO0FBSTNDLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBZTlFLHVCQUF1QixPQUFlLEVBQUUsR0FBYTtJQUNuRCxPQUFPLENBQUMsSUFBSSxDQUFDLDBEQUEwRCxDQUFDLENBQUM7SUFDekUsb0JBQW9CO0lBQ3BCLFFBQVEsQ0FBQztJQUNULG1CQUFtQjtJQUNuQixNQUFNLENBQUMsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUM7QUFDMUIsQ0FBQztBQUVELGdCQUFnQixFQUFNLEVBQUUsT0FBc0I7SUFDNUMsTUFBTSxDQUFDLENBQUMsSUFBWTtRQUNsQixJQUFJLEtBQUssR0FBRyxJQUFJ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LENBQUM7WUFFRCxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUM7Z0JBQ04sQ0FBQyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztZQUMvQixDQUFDLENBQUMsQ0FBQztZQUVILEVBQUUsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7Z0JBQ1osQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDZCxDQUFDLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUNoQixDQUFDLENBQUMsUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1lBQ3RCLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsTUFBTSxDQUFDLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxDQUFDO0FBQzdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBXaXJlRm9ybWF0IGZyb20gJ0BnbGltbWVyL3dpcmUtZm9ybWF0JztcclxuaW1wb3J0IE9wY29kZUJ1aWxkZXIgZnJvbSAnLi4vY29tcGlsZWQvb3Bjb2Rlcy9idWlsZGVyJztcclxuaW1wb3J0IHsgQ29tcGlsZWRFeHByZXNzaW9uIH0gZnJvbSAnLi4vY29tcGlsZWQvZXhwcmVzc2lvbnMnO1xyXG5pbXBvcnQgQ29tcGlsZWRWYWx1ZSBmcm9tICcuLi9jb21waWxlZC9leHByZXNzaW9ucy92YWx1ZSc7XHJcbmltcG9ydCBDb21waWxlZEhhc0Jsb2NrLCB7IENvbXBpbGVkSGFzQmxvY2tQYXJhbXMgfSBmcm9tICcuLi9jb21waWxlZC9leHByZXNzaW9ucy9oYXMtYmxvY2snO1xyXG5pbXBvcnQgeyBCYXNlbGluZVN5bnRheCB9IGZyb20gJy4uL3NjYW5uZXInO1xyXG5pbXBvcnQgeyBMT0dHRVIsIE9wYXF1ZSwgT3B0aW9uLCBkaWN0LCBhc3NlcnQsIHVud3JhcCwgdW5yZWFjaGFibGUgfSBmcm9tICdAZ2xpbW1lci91dGlsJztcclxuaW1wb3J0IENvbXBpbGVkTG9va3VwLCB7XHJcbiAgQ29tcGlsZWRTZWxmLFxyXG4gIENvbXBpbGVkU3ltYm9sLFxyXG4gIENvbXBpbGVkSW5QYXJ0aWFsTmFtZVxyXG59IGZyb20gJy4uL2NvbXBpbGVkL2V4cHJlc3Npb25zL2xvb2t1cHMnO1xyXG5pbXBvcnQgQ29tcGlsZWRIZWxwZXIgZnJvbSAnLi4vY29tcGlsZWQvZXhwcmVzc2lvbnMvaGVscGVyJztcclxuaW1wb3J0IENvbXBpbGVkQ29uY2F0IGZyb20gJy4uL2NvbXBpbGVkL2V4cHJlc3Npb25zL2NvbmNhdCc7XHJcbmltcG9ydCB7XHJcbiAgQ09NUElMRURfRU1QVFlfUE9TSVRJT05BTF9BUkdTLFxyXG4gIENPTVBJTEVEX0VNUFRZX05BTUVEX0FSR1MsXHJcbiAgRU1QVFlfQkxPQ0tTLFxyXG4gIENvbXBpbGVkQXJncyxcclxuICBDb21waWxlZFBvc2l0aW9uYWxBcmdzLFxyXG4gIENvbXBpbGVkTmFtZWRBcmdzLFxyXG4gIEJsb2NrcyBhcyBCbG9ja3NTeW50YXhcclxufSBmcm9tICcuLi9jb21waWxlZC9leHByZXNzaW9ucy9hcmdzJztcclxuaW1wb3J0IHtcclxuICBDb21waWxlZEdldEJsb2NrQnlTeW1ib2wsXHJcbiAgQ29tcGlsZWRJblBhcnRpYWxHZXRCbG9ja1xyXG59IGZyb20gJy4uL2NvbXBpbGVkL2V4cHJlc3Npb25zL2hhcy1ibG9jayc7XHJcbmltcG9ydCB7IFB1YmxpY1ZNIGFzIFZNIH0gZnJvbSAnLi4vdm0nO1xyXG5pbXBvcnQgQXBwZW5kVk0gZnJvbSAnLi4vdm0vYXBwZW5kJztcclxuXHJcbmltcG9ydCB7IENvbXBpbGVkRnVuY3Rpb25FeHByZXNzaW9uIH0gZnJvbSAnLi4vY29tcGlsZWQvZXhwcmVzc2lvbnMvZnVuY3Rpb24nO1xyXG5cclxuZXhwb3J0IHR5cGUgU2V4cEV4cHJlc3Npb24gPSBCYXNlbGluZVN5bnRheC5BbnlFeHByZXNzaW9uICYgeyAwOiBzdHJpbmcgfTtcclxuZXhwb3J0IHR5cGUgU3ludGF4ID0gU2V4cEV4cHJlc3Npb24gfCBCYXNlbGluZVN5bnRheC5BbnlTdGF0ZW1lbnQ7XHJcbmV4cG9ydCB0eXBlIENvbXBpbGVyRnVuY3Rpb248VCBleHRlbmRzIFN5bnRheCwgVT4gPSAoKHNleHA6IFQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IFUpO1xyXG5leHBvcnQgdHlwZSBOYW1lID0gQmFzZWxpbmVTeW50YXguQW55U3RhdGVtZW50WzBdO1xyXG5leHBvcnQgdHlwZSBkZWJ1Z0dldCA9ICgocGF0aDogc3RyaW5nKSA9PiBhbnkpO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBEZWJ1Z0NvbnRleHQge1xyXG4gIGNvbnRleHQ6IE9wYXF1ZTtcclxuICBnZXQ6IGRlYnVnR2V0O1xyXG59XHJcblxyXG5leHBvcnQgdHlwZSBkZWJ1Z0NhbGxiYWNrID0gKChjb250ZXh0OiBPcGFxdWUsIGdldDogZGVidWdHZXQpID0+IERlYnVnQ29udGV4dCk7XHJcblxyXG5mdW5jdGlvbiBkZWJ1Z0NhbGxiYWNrKGNvbnRleHQ6IE9wYXF1ZSwgZ2V0OiBkZWJ1Z0dldCkge1xyXG4gIGNvbnNvbGUuaW5mbygnVXNlIGBjb250ZXh0YCwgYW5kIGBnZXQoPHBhdGg+KWAgdG8gZGVidWcgdGhpcyB0ZW1wbGF0ZS4nKTtcclxuICAvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xyXG4gIGRlYnVnZ2VyO1xyXG4gIC8qIHRzbGludDplbmFibGUgKi9cclxuICByZXR1cm4geyBjb250ZXh0LCBnZXQgfTtcclxufVxyXG5cclxuZnVuY3Rpb24gZ2V0dGVyKHZtOiBWTSwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikge1xyXG4gIHJldHVybiAocGF0aDogc3RyaW5nKSA9PiB7XHJcbiAgICBsZXQgcGFydHMgPSBwYXRoLnNwbGl0KCcuJykgYXMgYW55O1xyXG5cclxuICAgIGlmIChwYXJ0c1swXSA9PT0gJ3RoaXMnKSB7XHJcbiAgICAgIHBhcnRzWzBdID0gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gY29tcGlsZVJlZihwYXJ0cywgYnVpbGRlcikuZXZhbHVhdGUodm0gYXMgQXBwZW5kVk0pO1xyXG4gIH07XHJcbn1cclxuXHJcbmxldCBjYWxsYmFjayA9IGRlYnVnQ2FsbGJhY2s7XHJcblxyXG4vLyBGb3IgdGVzdGluZyBwdXJwb3Nlc1xyXG5leHBvcnQgZnVuY3Rpb24gc2V0RGVidWdnZXJDYWxsYmFjayhjYjogZGVidWdDYWxsYmFjaykge1xyXG4gIGNhbGxiYWNrID0gY2I7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZXNldERlYnVnZ2VyQ2FsbGJhY2soKSB7XHJcbiAgY2FsbGJhY2sgPSBkZWJ1Z0NhbGxiYWNrO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tcGlsZXJzPFQgZXh0ZW5kcyBTeW50YXgsIENvbXBpbGVUbz4ge1xyXG4gIHByaXZhdGUgbmFtZXMgPSBkaWN0PG51bWJlcj4oKTtcclxuICBwcml2YXRlIGZ1bmNzOiBDb21waWxlckZ1bmN0aW9uPFQsIENvbXBpbGVUbz5bXSA9IFtdO1xyXG5cclxuICBhZGQobmFtZTogc3RyaW5nLCBmdW5jOiBDb21waWxlckZ1bmN0aW9uPFQsIENvbXBpbGVUbz4pOiB2b2lkIHtcclxuICAgIHRoaXMuZnVuY3MucHVzaChmdW5jKTtcclxuICAgIHRoaXMubmFtZXNbbmFtZV0gPSB0aGlzLmZ1bmNzLmxlbmd0aCAtIDE7XHJcbiAgfVxyXG5cclxuICBjb21waWxlKHNleHA6IFQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpOiBDb21waWxlVG8ge1xyXG4gICAgbGV0IG5hbWU6IHN0cmluZyA9IHNleHBbMF07XHJcbiAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzW25hbWVdO1xyXG4gICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcclxuICAgIGFzc2VydCghIWZ1bmMsIGBleHBlY3RlZCBhbiBpbXBsZW1lbnRhdGlvbiBmb3IgJHtzZXhwWzBdfWApO1xyXG4gICAgcmV0dXJuIGZ1bmMoc2V4cCwgYnVpbGRlcik7XHJcbiAgfVxyXG59XHJcblxyXG5pbXBvcnQgUyA9IFdpcmVGb3JtYXQuU3RhdGVtZW50cztcclxuXHJcbmV4cG9ydCBjb25zdCBTVEFURU1FTlRTID0gbmV3IENvbXBpbGVyczxCYXNlbGluZVN5bnRheC5BbnlTdGF0ZW1lbnQsIHZvaWQ+KCk7XHJcblxyXG5TVEFURU1FTlRTLmFkZCgndGV4dCcsIChzZXhwOiBTLlRleHQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICBidWlsZGVyLnRleHQoc2V4cFsxXSk7XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ2NvbW1lbnQnLCAoc2V4cDogUy5Db21tZW50LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgYnVpbGRlci5jb21tZW50KHNleHBbMV0pO1xyXG59KTtcclxuXHJcblNUQVRFTUVOVFMuYWRkKCdjbG9zZS1lbGVtZW50JywgKF9zZXhwLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgTE9HR0VSLnRyYWNlKCdjbG9zZS1lbGVtZW50IHN0YXRlbWVudCcpO1xyXG4gIGJ1aWxkZXIuY2xvc2VFbGVtZW50KCk7XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ2ZsdXNoLWVsZW1lbnQnLCAoX3NleHAsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICBidWlsZGVyLmZsdXNoRWxlbWVudCgpO1xyXG59KTtcclxuXHJcblNUQVRFTUVOVFMuYWRkKCdtb2RpZmllcicsIChzZXhwOiBTLk1vZGlmaWVyLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgbGV0IFssIHBhdGgsIHBhcmFtcywgaGFzaF0gPSBzZXhwO1xyXG5cclxuICBsZXQgYXJncyA9IGNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgYnVpbGRlcik7XHJcblxyXG4gIGlmIChidWlsZGVyLmVudi5oYXNNb2RpZmllcihwYXRoLCBidWlsZGVyLnN5bWJvbFRhYmxlKSkge1xyXG4gICAgYnVpbGRlci5tb2RpZmllcihwYXRoWzBdLCBhcmdzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yICR7cGF0aC5qb2luKCcuJyl9IGlzIG5vdCBhIG1vZGlmaWVyOiBIZWxwZXJzIG1heSBub3QgYmUgdXNlZCBpbiB0aGUgZWxlbWVudCBmb3JtLmApO1xyXG4gIH1cclxufSk7XHJcblxyXG5TVEFURU1FTlRTLmFkZCgnc3RhdGljLWF0dHInLCAoc2V4cDogUy5TdGF0aWNBdHRyLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgbGV0IFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2VdID0gc2V4cDtcclxuICBidWlsZGVyLnN0YXRpY0F0dHIobmFtZSwgbmFtZXNwYWNlLCB2YWx1ZSBhcyBzdHJpbmcpO1xyXG59KTtcclxuXHJcblNUQVRFTUVOVFMuYWRkKCdhbnktZHluYW1pYy1hdHRyJywgKHNleHA6IEJhc2VsaW5lU3ludGF4LkFueUR5bmFtaWNBdHRyLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgbGV0IFssIG5hbWUsIHZhbHVlLCBuYW1lc3BhY2UsIHRydXN0aW5nXSA9IHNleHA7XHJcblxyXG4gIGJ1aWxkZXIucHV0VmFsdWUodmFsdWUpO1xyXG5cclxuICBpZiAobmFtZXNwYWNlKSB7XHJcbiAgICBidWlsZGVyLmR5bmFtaWNBdHRyTlMobmFtZSwgbmFtZXNwYWNlLCB0cnVzdGluZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1aWxkZXIuZHluYW1pY0F0dHIobmFtZSwgdHJ1c3RpbmcpO1xyXG4gIH1cclxufSk7XHJcblxyXG5TVEFURU1FTlRTLmFkZCgnb3Blbi1lbGVtZW50JywgKHNleHA6IEJhc2VsaW5lU3ludGF4Lk9wZW5QcmltaXRpdmVFbGVtZW50LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgTE9HR0VSLnRyYWNlKCdvcGVuLWVsZW1lbnQgc3RhdGVtZW50Jyk7XHJcbiAgYnVpbGRlci5vcGVuUHJpbWl0aXZlRWxlbWVudChzZXhwWzFdKTtcclxufSk7XHJcblxyXG5TVEFURU1FTlRTLmFkZCgnb3B0aW1pemVkLWFwcGVuZCcsIChzZXhwOiBCYXNlbGluZVN5bnRheC5PcHRpbWl6ZWRBcHBlbmQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICBsZXQgWywgdmFsdWUsIHRydXN0aW5nTW9ycGhdID0gc2V4cDtcclxuXHJcbiAgbGV0IHsgaW5saW5lcyB9ID0gYnVpbGRlci5lbnYubWFjcm9zKCk7XHJcbiAgbGV0IHJldHVybmVkID0gaW5saW5lcy5jb21waWxlKHNleHAsIGJ1aWxkZXIpIHx8IHZhbHVlO1xyXG5cclxuICBpZiAocmV0dXJuZWQgPT09IHRydWUpIHJldHVybjtcclxuXHJcbiAgYnVpbGRlci5wdXRWYWx1ZShyZXR1cm5lZFsxXSk7XHJcblxyXG4gIGlmICh0cnVzdGluZ01vcnBoKSB7XHJcbiAgICBidWlsZGVyLnRydXN0aW5nQXBwZW5kKCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1aWxkZXIuY2F1dGlvdXNBcHBlbmQoKTtcclxuICB9XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ3Vub3B0aW1pemVkLWFwcGVuZCcsIChzZXhwOiBCYXNlbGluZVN5bnRheC5Vbm9wdGltaXplZEFwcGVuZCwgYnVpbGRlcikgPT4ge1xyXG4gIGxldCBbLCB2YWx1ZSwgdHJ1c3RpbmdNb3JwaF0gPSBzZXhwO1xyXG4gIGxldCB7IGlubGluZXMgfSA9IGJ1aWxkZXIuZW52Lm1hY3JvcygpO1xyXG4gIGxldCByZXR1cm5lZCA9IGlubGluZXMuY29tcGlsZShzZXhwLCBidWlsZGVyKSB8fCB2YWx1ZTtcclxuXHJcbiAgaWYgKHJldHVybmVkID09PSB0cnVlKSByZXR1cm47XHJcblxyXG4gIGlmICh0cnVzdGluZ01vcnBoKSB7XHJcbiAgICBidWlsZGVyLmd1YXJkZWRUcnVzdGluZ0FwcGVuZChyZXR1cm5lZFsxXSk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1aWxkZXIuZ3VhcmRlZENhdXRpb3VzQXBwZW5kKHJldHVybmVkWzFdKTtcclxuICB9XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ25lc3RlZC1ibG9jaycsIChzZXhwOiBCYXNlbGluZVN5bnRheC5OZXN0ZWRCbG9jaywgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gIGxldCB7IGJsb2NrcyB9ID0gYnVpbGRlci5lbnYubWFjcm9zKCk7XHJcbiAgYmxvY2tzLmNvbXBpbGUoc2V4cCwgYnVpbGRlcik7XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ3NjYW5uZWQtYmxvY2snLCAoc2V4cDogQmFzZWxpbmVTeW50YXguU2Nhbm5lZEJsb2NrLCBidWlsZGVyKSA9PiB7XHJcbiAgbGV0IFssIHBhdGgsIHBhcmFtcywgaGFzaCwgdGVtcGxhdGUsIGludmVyc2VdID0gc2V4cDtcclxuXHJcbiAgbGV0IHRlbXBsYXRlQmxvY2sgPSB0ZW1wbGF0ZSAmJiB0ZW1wbGF0ZS5zY2FuKCk7XHJcbiAgbGV0IGludmVyc2VCbG9jayA9IGludmVyc2UgJiYgaW52ZXJzZS5zY2FuKCk7XHJcblxyXG4gIGxldCB7IGJsb2NrcyB9ID0gYnVpbGRlci5lbnYubWFjcm9zKCk7XHJcbiAgYmxvY2tzLmNvbXBpbGUoWyduZXN0ZWQtYmxvY2snLCBwYXRoLCBwYXJhbXMsIGhhc2gsIHRlbXBsYXRlQmxvY2ssIGludmVyc2VCbG9ja10sIGJ1aWxkZXIpO1xyXG59KTtcclxuXHJcblNUQVRFTUVOVFMuYWRkKCdzY2FubmVkLWNvbXBvbmVudCcsIChzZXhwOiBCYXNlbGluZVN5bnRheC5TY2FubmVkQ29tcG9uZW50LCBidWlsZGVyKSA9PiB7XHJcbiAgbGV0IFssIHRhZywgYXR0cnMsIHJhd0FyZ3MsIHJhd0Jsb2NrXSA9IHNleHA7XHJcbiAgbGV0IGJsb2NrID0gcmF3QmxvY2sgJiYgcmF3QmxvY2suc2NhbigpO1xyXG5cclxuICBsZXQgYXJncyA9IGNvbXBpbGVCbG9ja0FyZ3MobnVsbCwgcmF3QXJncywgeyBkZWZhdWx0OiBibG9jaywgaW52ZXJzZTogbnVsbCB9LCBidWlsZGVyKTtcclxuXHJcbiAgbGV0IGRlZmluaXRpb24gPSBidWlsZGVyLmVudi5nZXRDb21wb25lbnREZWZpbml0aW9uKFt0YWddLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcclxuXHJcbiAgYnVpbGRlci5wdXRDb21wb25lbnREZWZpbml0aW9uKGRlZmluaXRpb24pO1xyXG4gIGJ1aWxkZXIub3BlbkNvbXBvbmVudChhcmdzLCBhdHRycy5zY2FuKCkpO1xyXG4gIGJ1aWxkZXIuY2xvc2VDb21wb25lbnQoKTtcclxufSk7XHJcblxyXG5TVEFURU1FTlRTLmFkZCgnc3RhdGljLXBhcnRpYWwnLCAoc2V4cDogQmFzZWxpbmVTeW50YXguU3RhdGljUGFydGlhbCwgYnVpbGRlcikgPT4ge1xyXG4gIGxldCBbLCBuYW1lXSA9IHNleHA7XHJcblxyXG4gIGlmICghYnVpbGRlci5lbnYuaGFzUGFydGlhbChuYW1lLCBidWlsZGVyLnN5bWJvbFRhYmxlKSkge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yOiBDb3VsZCBub3QgZmluZCBhIHBhcnRpYWwgbmFtZWQgXCIke25hbWV9XCJgKTtcclxuICB9XHJcblxyXG4gIGxldCBkZWZpbml0aW9uID0gYnVpbGRlci5lbnYubG9va3VwUGFydGlhbChuYW1lLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcclxuXHJcbiAgYnVpbGRlci5wdXRQYXJ0aWFsRGVmaW5pdGlvbihkZWZpbml0aW9uKTtcclxuICBidWlsZGVyLmV2YWx1YXRlUGFydGlhbCgpO1xyXG59KTtcclxuXHJcblNUQVRFTUVOVFMuYWRkKCdkeW5hbWljLXBhcnRpYWwnLCAoc2V4cDogQmFzZWxpbmVTeW50YXguRHluYW1pY1BhcnRpYWwsIGJ1aWxkZXIpID0+IHtcclxuICBsZXQgWywgbmFtZV0gPSBzZXhwO1xyXG5cclxuICAgIGJ1aWxkZXIuc3RhcnRMYWJlbHMoKTtcclxuXHJcbiAgICBidWlsZGVyLnB1dFZhbHVlKG5hbWUpO1xyXG4gICAgYnVpbGRlci50ZXN0KCdzaW1wbGUnKTtcclxuICAgIGJ1aWxkZXIuZW50ZXIoJ0JFR0lOJywgJ0VORCcpO1xyXG4gICAgYnVpbGRlci5sYWJlbCgnQkVHSU4nKTtcclxuICAgIGJ1aWxkZXIuanVtcFVubGVzcygnRU5EJyk7XHJcbiAgICBidWlsZGVyLnB1dER5bmFtaWNQYXJ0aWFsRGVmaW5pdGlvbigpO1xyXG4gICAgYnVpbGRlci5ldmFsdWF0ZVBhcnRpYWwoKTtcclxuICAgIGJ1aWxkZXIubGFiZWwoJ0VORCcpO1xyXG4gICAgYnVpbGRlci5leGl0KCk7XHJcblxyXG4gICAgYnVpbGRlci5zdG9wTGFiZWxzKCk7XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ3lpZWxkJywgZnVuY3Rpb24odGhpczogdW5kZWZpbmVkLCBzZXhwOiBXaXJlRm9ybWF0LlN0YXRlbWVudHMuWWllbGQsIGJ1aWxkZXIpIHtcclxuICBsZXQgWywgdG8sIHBhcmFtc10gPSBzZXhwO1xyXG5cclxuICBsZXQgYXJncyA9IGNvbXBpbGVBcmdzKHBhcmFtcywgbnVsbCwgYnVpbGRlcik7XHJcbiAgYnVpbGRlci55aWVsZChhcmdzLCB0byk7XHJcbn0pO1xyXG5cclxuU1RBVEVNRU5UUy5hZGQoJ2RlYnVnZ2VyJywgKHNleHA6IEJhc2VsaW5lU3ludGF4LkRlYnVnZ2VyLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcblxyXG4gIGJ1aWxkZXIucHV0VmFsdWUoWydmdW5jdGlvbicsICh2bTogVk0pID0+IHtcclxuICAgIGxldCBjb250ZXh0ID0gdm0uZ2V0U2VsZigpLnZhbHVlKCk7XHJcbiAgICBsZXQgZ2V0ID0gKHBhdGg6IHN0cmluZykgPT4ge1xyXG4gICAgICByZXR1cm4gZ2V0dGVyKHZtLCBidWlsZGVyKShwYXRoKS52YWx1ZSgpO1xyXG4gICAgfTtcclxuICAgIGNhbGxiYWNrKGNvbnRleHQsIGdldCk7XHJcbiAgfV0pO1xyXG5cclxuICByZXR1cm4gc2V4cDtcclxufSk7XHJcblxyXG5sZXQgRVhQUkVTU0lPTlMgPSBuZXcgQ29tcGlsZXJzPFNleHBFeHByZXNzaW9uLCBDb21waWxlZEV4cHJlc3Npb248T3BhcXVlPj4oKTtcclxuXHJcbmltcG9ydCBFID0gV2lyZUZvcm1hdC5FeHByZXNzaW9ucztcclxuaW1wb3J0IEMgPSBXaXJlRm9ybWF0LkNvcmU7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZXhwcihleHByZXNzaW9uOiBCYXNlbGluZVN5bnRheC5BbnlFeHByZXNzaW9uLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKTogQ29tcGlsZWRFeHByZXNzaW9uPE9wYXF1ZT4ge1xyXG4gIGlmIChBcnJheS5pc0FycmF5KGV4cHJlc3Npb24pKSB7XHJcbiAgICByZXR1cm4gRVhQUkVTU0lPTlMuY29tcGlsZShleHByZXNzaW9uLCBidWlsZGVyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIG5ldyBDb21waWxlZFZhbHVlKGV4cHJlc3Npb24pO1xyXG4gIH1cclxufVxyXG5cclxuRVhQUkVTU0lPTlMuYWRkKCd1bmtub3duJywgKHNleHA6IEUuVW5rbm93biwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gIGxldCBwYXRoID0gc2V4cFsxXTtcclxuXHJcbiAgaWYgKGJ1aWxkZXIuZW52Lmhhc0hlbHBlcihwYXRoLCBidWlsZGVyLnN5bWJvbFRhYmxlKSkge1xyXG4gICAgcmV0dXJuIG5ldyBDb21waWxlZEhlbHBlcihwYXRoLCBidWlsZGVyLmVudi5sb29rdXBIZWxwZXIocGF0aCwgYnVpbGRlci5zeW1ib2xUYWJsZSksIENvbXBpbGVkQXJncy5lbXB0eSgpLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgcmV0dXJuIGNvbXBpbGVSZWYocGF0aCwgYnVpbGRlcik7XHJcbiAgfVxyXG59KTtcclxuXHJcbkVYUFJFU1NJT05TLmFkZCgnY29uY2F0JywgKChzZXhwOiBFLkNvbmNhdCwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gIGxldCBwYXJhbXMgPSBzZXhwWzFdLm1hcChwID0+IGV4cHIocCwgYnVpbGRlcikpO1xyXG4gIHJldHVybiBuZXcgQ29tcGlsZWRDb25jYXQocGFyYW1zKTtcclxufSkgYXMgYW55KTtcclxuXHJcbkVYUFJFU1NJT05TLmFkZCgnZnVuY3Rpb24nLCAoc2V4cDogQmFzZWxpbmVTeW50YXguRnVuY3Rpb25FeHByZXNzaW9uLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgcmV0dXJuIG5ldyBDb21waWxlZEZ1bmN0aW9uRXhwcmVzc2lvbihzZXhwWzFdLCBidWlsZGVyLnN5bWJvbFRhYmxlKTtcclxufSk7XHJcblxyXG5FWFBSRVNTSU9OUy5hZGQoJ2hlbHBlcicsIChzZXhwOiBFLkhlbHBlciwgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gIGxldCB7IGVudiwgc3ltYm9sVGFibGUgfSA9IGJ1aWxkZXI7XHJcbiAgbGV0IFssIHBhdGgsIHBhcmFtcywgaGFzaF0gPSBzZXhwO1xyXG5cclxuICBpZiAoZW52Lmhhc0hlbHBlcihwYXRoLCBzeW1ib2xUYWJsZSkpIHtcclxuICAgIGxldCBhcmdzID0gY29tcGlsZUFyZ3MocGFyYW1zLCBoYXNoLCBidWlsZGVyKTtcclxuICAgIHJldHVybiBuZXcgQ29tcGlsZWRIZWxwZXIocGF0aCwgZW52Lmxvb2t1cEhlbHBlcihwYXRoLCBzeW1ib2xUYWJsZSksIGFyZ3MsIHN5bWJvbFRhYmxlKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBDb21waWxlIEVycm9yOiAke3BhdGguam9pbignLicpfSBpcyBub3QgYSBoZWxwZXJgKTtcclxuICB9XHJcbn0pO1xyXG5cclxuRVhQUkVTU0lPTlMuYWRkKCdnZXQnLCAoc2V4cDogRS5HZXQsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICByZXR1cm4gY29tcGlsZVJlZihzZXhwWzFdLCBidWlsZGVyKTtcclxufSk7XHJcblxyXG5FWFBSRVNTSU9OUy5hZGQoJ3VuZGVmaW5lZCcsIChfc2V4cCwgX2J1aWxkZXIpID0+IHtcclxuICByZXR1cm4gbmV3IENvbXBpbGVkVmFsdWUodW5kZWZpbmVkKTtcclxufSk7XHJcblxyXG5FWFBSRVNTSU9OUy5hZGQoJ2FyZycsIChzZXhwOiBFLkFyZywgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gIGxldCBbLCBwYXJ0c10gPSBzZXhwO1xyXG4gIGxldCBoZWFkID0gcGFydHNbMF07XHJcbiAgbGV0IG5hbWVkOiBPcHRpb248bnVtYmVyPiwgcGFydGlhbDogT3B0aW9uPG51bWJlcj47XHJcblxyXG4gIGlmIChuYW1lZCA9IGJ1aWxkZXIuc3ltYm9sVGFibGUuZ2V0U3ltYm9sKCduYW1lZCcsIGhlYWQpKSB7XHJcbiAgICBsZXQgcGF0aCA9IHBhcnRzLnNsaWNlKDEpO1xyXG4gICAgbGV0IGlubmVyID0gbmV3IENvbXBpbGVkU3ltYm9sKG5hbWVkLCBoZWFkKTtcclxuICAgIHJldHVybiBDb21waWxlZExvb2t1cC5jcmVhdGUoaW5uZXIsIHBhdGgpO1xyXG4gIH0gZWxzZSBpZiAocGFydGlhbCA9IGJ1aWxkZXIuc3ltYm9sVGFibGUuZ2V0UGFydGlhbEFyZ3MoKSkge1xyXG4gICAgbGV0IHBhdGggPSBwYXJ0cy5zbGljZSgxKTtcclxuICAgIGxldCBpbm5lciA9IG5ldyBDb21waWxlZEluUGFydGlhbE5hbWUocGFydGlhbCwgaGVhZCk7XHJcbiAgICByZXR1cm4gQ29tcGlsZWRMb29rdXAuY3JlYXRlKGlubmVyLCBwYXRoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKGBbQlVHXSBAJHtwYXJ0cy5qb2luKCcuJyl9IGlzIG5vdCBhIHZhbGlkIGxvb2t1cCBwYXRoLmApO1xyXG4gIH1cclxufSk7XHJcblxyXG5FWFBSRVNTSU9OUy5hZGQoJ2hhcy1ibG9jaycsIChzZXhwOiBFLkhhc0Jsb2NrLCBidWlsZGVyKSA9PiB7XHJcbiAgbGV0IGJsb2NrTmFtZSA9IHNleHBbMV07XHJcblxyXG4gIGxldCB5aWVsZHM6IE9wdGlvbjxudW1iZXI+LCBwYXJ0aWFsOiBPcHRpb248bnVtYmVyPjtcclxuXHJcbiAgaWYgKHlpZWxkcyA9IGJ1aWxkZXIuc3ltYm9sVGFibGUuZ2V0U3ltYm9sKCd5aWVsZHMnLCBibG9ja05hbWUpKSB7XHJcbiAgICBsZXQgaW5uZXIgPSBuZXcgQ29tcGlsZWRHZXRCbG9ja0J5U3ltYm9sKHlpZWxkcywgYmxvY2tOYW1lKTtcclxuICAgIHJldHVybiBuZXcgQ29tcGlsZWRIYXNCbG9jayhpbm5lcik7XHJcbiAgfSBlbHNlIGlmIChwYXJ0aWFsID0gYnVpbGRlci5zeW1ib2xUYWJsZS5nZXRQYXJ0aWFsQXJncygpKSB7XHJcbiAgICBsZXQgaW5uZXIgPSBuZXcgQ29tcGlsZWRJblBhcnRpYWxHZXRCbG9jayhwYXJ0aWFsLCBibG9ja05hbWUpO1xyXG4gICAgcmV0dXJuIG5ldyBDb21waWxlZEhhc0Jsb2NrKGlubmVyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhyb3cgbmV3IEVycm9yKCdbQlVHXSAke2Jsb2NrTmFtZX0gaXMgbm90IGEgdmFsaWQgYmxvY2sgbmFtZS4nKTtcclxuICB9XHJcbn0pO1xyXG5cclxuRVhQUkVTU0lPTlMuYWRkKCdoYXMtYmxvY2stcGFyYW1zJywgKHNleHA6IEUuSGFzQmxvY2tQYXJhbXMsIGJ1aWxkZXIpID0+IHtcclxuICBsZXQgYmxvY2tOYW1lID0gc2V4cFsxXTtcclxuICBsZXQgeWllbGRzOiBPcHRpb248bnVtYmVyPiwgcGFydGlhbDogT3B0aW9uPG51bWJlcj47XHJcblxyXG4gIGlmICh5aWVsZHMgPSBidWlsZGVyLnN5bWJvbFRhYmxlLmdldFN5bWJvbCgneWllbGRzJywgYmxvY2tOYW1lKSkge1xyXG4gICAgbGV0IGlubmVyID0gbmV3IENvbXBpbGVkR2V0QmxvY2tCeVN5bWJvbCh5aWVsZHMsIGJsb2NrTmFtZSk7XHJcbiAgICByZXR1cm4gbmV3IENvbXBpbGVkSGFzQmxvY2tQYXJhbXMoaW5uZXIpO1xyXG4gIH0gZWxzZSBpZiAocGFydGlhbCA9IGJ1aWxkZXIuc3ltYm9sVGFibGUuZ2V0UGFydGlhbEFyZ3MoKSkge1xyXG4gICAgbGV0IGlubmVyID0gbmV3IENvbXBpbGVkSW5QYXJ0aWFsR2V0QmxvY2socGFydGlhbCwgYmxvY2tOYW1lKTtcclxuICAgIHJldHVybiBuZXcgQ29tcGlsZWRIYXNCbG9ja1BhcmFtcyhpbm5lcik7XHJcbiAgfSBlbHNlIHtcclxuICAgIHRocm93IG5ldyBFcnJvcignW0JVR10gJHtibG9ja05hbWV9IGlzIG5vdCBhIHZhbGlkIGJsb2NrIG5hbWUuJyk7XHJcbiAgfVxyXG5cclxufSk7XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gY29tcGlsZUFyZ3MocGFyYW1zOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLlBhcmFtcz4sIGhhc2g6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuSGFzaD4sIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpOiBDb21waWxlZEFyZ3Mge1xyXG4gIGxldCBjb21waWxlZFBhcmFtcyA9IGNvbXBpbGVQYXJhbXMocGFyYW1zLCBidWlsZGVyKTtcclxuICBsZXQgY29tcGlsZWRIYXNoID0gY29tcGlsZUhhc2goaGFzaCwgYnVpbGRlcik7XHJcbiAgcmV0dXJuIENvbXBpbGVkQXJncy5jcmVhdGUoY29tcGlsZWRQYXJhbXMsIGNvbXBpbGVkSGFzaCwgRU1QVFlfQkxPQ0tTKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBpbGVCbG9ja0FyZ3MocGFyYW1zOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLlBhcmFtcz4sIGhhc2g6IE9wdGlvbjxXaXJlRm9ybWF0LkNvcmUuSGFzaD4sIGJsb2NrczogQmxvY2tzU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKTogQ29tcGlsZWRBcmdzIHtcclxuICBsZXQgY29tcGlsZWRQYXJhbXMgPSBjb21waWxlUGFyYW1zKHBhcmFtcywgYnVpbGRlcik7XHJcbiAgbGV0IGNvbXBpbGVkSGFzaCA9IGNvbXBpbGVIYXNoKGhhc2gsIGJ1aWxkZXIpO1xyXG4gIHJldHVybiBDb21waWxlZEFyZ3MuY3JlYXRlKGNvbXBpbGVkUGFyYW1zLCBjb21waWxlZEhhc2gsIGJsb2Nrcyk7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBjb21waWxlQmFzZWxpbmVBcmdzKGFyZ3M6IEJhc2VsaW5lU3ludGF4LkFyZ3MsIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpOiBDb21waWxlZEFyZ3Mge1xyXG4gIGxldCBbcGFyYW1zLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV0gPSBhcmdzO1xyXG4gIHJldHVybiBDb21waWxlZEFyZ3MuY3JlYXRlKGNvbXBpbGVQYXJhbXMocGFyYW1zLCBidWlsZGVyKSwgY29tcGlsZUhhc2goaGFzaCwgYnVpbGRlciksIHsgZGVmYXVsdDogX2RlZmF1bHQsIGludmVyc2UgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbXBpbGVQYXJhbXMocGFyYW1zOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLlBhcmFtcz4sIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpOiBDb21waWxlZFBvc2l0aW9uYWxBcmdzIHtcclxuICBpZiAoIXBhcmFtcyB8fCBwYXJhbXMubGVuZ3RoID09PSAwKSByZXR1cm4gQ09NUElMRURfRU1QVFlfUE9TSVRJT05BTF9BUkdTO1xyXG4gIGxldCBjb21waWxlZCA9IHBhcmFtcy5tYXAocCA9PiBleHByKHAsIGJ1aWxkZXIpKTtcclxuICByZXR1cm4gQ29tcGlsZWRQb3NpdGlvbmFsQXJncy5jcmVhdGUoY29tcGlsZWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjb21waWxlSGFzaChoYXNoOiBPcHRpb248V2lyZUZvcm1hdC5Db3JlLkhhc2g+LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKTogQ29tcGlsZWROYW1lZEFyZ3Mge1xyXG4gIGlmICghaGFzaCkgcmV0dXJuIENPTVBJTEVEX0VNUFRZX05BTUVEX0FSR1M7XHJcbiAgbGV0IFtrZXlzLCB2YWx1ZXNdID0gaGFzaDtcclxuICBpZiAoa2V5cy5sZW5ndGggPT09IDApIHJldHVybiBDT01QSUxFRF9FTVBUWV9OQU1FRF9BUkdTO1xyXG5cclxuICBsZXQgY29tcGlsZWQgPSB2YWx1ZXMubWFwKHAgPT4gZXhwcihwLCBidWlsZGVyKSk7XHJcbiAgcmV0dXJuIG5ldyBDb21waWxlZE5hbWVkQXJncyhrZXlzLCBjb21waWxlZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNvbXBpbGVSZWYocGFydHM6IHN0cmluZ1tdLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSB7XHJcbiAgbGV0IGhlYWQgPSBwYXJ0c1swXTtcclxuICBsZXQgbG9jYWw6IE9wdGlvbjxudW1iZXI+O1xyXG5cclxuICBpZiAoaGVhZCA9PT0gbnVsbCkgeyAvLyB7e3RoaXMuZm9vfX1cclxuICAgIGxldCBpbm5lciA9IG5ldyBDb21waWxlZFNlbGYoKTtcclxuICAgIGxldCBwYXRoID0gcGFydHMuc2xpY2UoMSkgYXMgc3RyaW5nW107XHJcbiAgICByZXR1cm4gQ29tcGlsZWRMb29rdXAuY3JlYXRlKGlubmVyLCBwYXRoKTtcclxuICB9IGVsc2UgaWYgKGxvY2FsID0gYnVpbGRlci5zeW1ib2xUYWJsZS5nZXRTeW1ib2woJ2xvY2FsJywgaGVhZCkpIHtcclxuICAgIGxldCBwYXRoID0gcGFydHMuc2xpY2UoMSkgYXMgc3RyaW5nW107XHJcbiAgICBsZXQgaW5uZXIgPSBuZXcgQ29tcGlsZWRTeW1ib2wobG9jYWwsIGhlYWQpO1xyXG4gICAgcmV0dXJuIENvbXBpbGVkTG9va3VwLmNyZWF0ZShpbm5lciwgcGF0aCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGxldCBpbm5lciA9IG5ldyBDb21waWxlZFNlbGYoKTtcclxuICAgIHJldHVybiBDb21waWxlZExvb2t1cC5jcmVhdGUoaW5uZXIsIHBhcnRzIGFzIHN0cmluZ1tdKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCB0eXBlIE5lc3RlZEJsb2NrU3ludGF4ID0gQmFzZWxpbmVTeW50YXguTmVzdGVkQmxvY2s7XHJcbmV4cG9ydCB0eXBlIENvbXBpbGVCbG9ja01hY3JvID0gKHNleHA6IE5lc3RlZEJsb2NrU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGNsYXNzIEJsb2NrcyB7XHJcbiAgcHJpdmF0ZSBuYW1lcyA9IGRpY3Q8bnVtYmVyPigpO1xyXG4gIHByaXZhdGUgZnVuY3M6IENvbXBpbGVCbG9ja01hY3JvW10gPSBbXTtcclxuICBwcml2YXRlIG1pc3Npbmc6IENvbXBpbGVCbG9ja01hY3JvO1xyXG5cclxuICBhZGQobmFtZTogc3RyaW5nLCBmdW5jOiBDb21waWxlQmxvY2tNYWNybykge1xyXG4gICAgdGhpcy5mdW5jcy5wdXNoKGZ1bmMpO1xyXG4gICAgdGhpcy5uYW1lc1tuYW1lXSA9IHRoaXMuZnVuY3MubGVuZ3RoIC0gMTtcclxuICB9XHJcblxyXG4gIGFkZE1pc3NpbmcoZnVuYzogQ29tcGlsZUJsb2NrTWFjcm8pIHtcclxuICAgIHRoaXMubWlzc2luZyA9IGZ1bmM7XHJcbiAgfVxyXG5cclxuICBjb21waWxlKHNleHA6IEJhc2VsaW5lU3ludGF4Lk5lc3RlZEJsb2NrLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKTogdm9pZCB7XHJcbiAgICAvLyBhc3NlcnQoc2V4cFsxXS5sZW5ndGggPT09IDEsICdwYXRocyBpbiBibG9ja3MgYXJlIG5vdCBzdXBwb3J0ZWQnKTtcclxuXHJcbiAgICBsZXQgbmFtZTogc3RyaW5nID0gc2V4cFsxXVswXTtcclxuICAgIGxldCBpbmRleCA9IHRoaXMubmFtZXNbbmFtZV07XHJcblxyXG4gICAgaWYgKGluZGV4ID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgYXNzZXJ0KCEhdGhpcy5taXNzaW5nLCBgJHtuYW1lfSBub3QgZm91bmQsIGFuZCBubyBjYXRjaC1hbGwgYmxvY2sgaGFuZGxlciB3YXMgcmVnaXN0ZXJlZGApO1xyXG4gICAgICBsZXQgZnVuYyA9IHRoaXMubWlzc2luZztcclxuICAgICAgbGV0IGhhbmRsZWQgPSBmdW5jKHNleHAsIGJ1aWxkZXIpO1xyXG4gICAgICBhc3NlcnQoISFoYW5kbGVkLCBgJHtuYW1lfSBub3QgZm91bmQsIGFuZCB0aGUgY2F0Y2gtYWxsIGJsb2NrIGhhbmRsZXIgZGlkbid0IGhhbmRsZSBpdGApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcclxuICAgICAgZnVuYyhzZXhwLCBidWlsZGVyKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBCTE9DS1MgPSBuZXcgQmxvY2tzKCk7XHJcblxyXG5leHBvcnQgdHlwZSBBcHBlbmRTeW50YXggPSBCYXNlbGluZVN5bnRheC5PcHRpbWl6ZWRBcHBlbmQgfCBCYXNlbGluZVN5bnRheC5Vbm9wdGltaXplZEFwcGVuZDtcclxuZXhwb3J0IHR5cGUgQXBwZW5kTWFjcm8gPSAocGF0aDogQy5QYXRoLCBwYXJhbXM6IE9wdGlvbjxDLlBhcmFtcz4sIGhhc2g6IE9wdGlvbjxDLkhhc2g+LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiBbJ2V4cHInLCBCYXNlbGluZVN5bnRheC5BbnlFeHByZXNzaW9uXSB8IHRydWUgfCBmYWxzZTtcclxuXHJcbmV4cG9ydCBjbGFzcyBJbmxpbmVzIHtcclxuICBwcml2YXRlIG5hbWVzID0gZGljdDxudW1iZXI+KCk7XHJcbiAgcHJpdmF0ZSBmdW5jczogQXBwZW5kTWFjcm9bXSA9IFtdO1xyXG4gIHByaXZhdGUgbWlzc2luZzogQXBwZW5kTWFjcm87XHJcblxyXG4gIGFkZChuYW1lOiBzdHJpbmcsIGZ1bmM6IEFwcGVuZE1hY3JvKSB7XHJcbiAgICB0aGlzLmZ1bmNzLnB1c2goZnVuYyk7XHJcbiAgICB0aGlzLm5hbWVzW25hbWVdID0gdGhpcy5mdW5jcy5sZW5ndGggLSAxO1xyXG4gIH1cclxuXHJcbiAgYWRkTWlzc2luZyhmdW5jOiBBcHBlbmRNYWNybykge1xyXG4gICAgdGhpcy5taXNzaW5nID0gZnVuYztcclxuICB9XHJcblxyXG4gIGNvbXBpbGUoc2V4cDogQXBwZW5kU3ludGF4LCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKTogWydleHByJywgQmFzZWxpbmVTeW50YXguQW55RXhwcmVzc2lvbl0gfCB0cnVlIHtcclxuICAgIGxldCB2YWx1ZSA9IHNleHBbMV07XHJcblxyXG4gICAgLy8gVE9ETzogRml4IHRoaXMgc28gdGhhdCBleHByZXNzaW9uIG1hY3JvcyBjYW4gcmV0dXJuXHJcbiAgICAvLyB0aGluZ3MgbGlrZSBjb21wb25lbnRzLCBzbyB0aGF0IHt7Y29tcG9uZW50IGZvb319XHJcbiAgICAvLyBpcyB0aGUgc2FtZSBhcyB7eyhjb21wb25lbnQgZm9vKX19XHJcblxyXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcclxuXHJcbiAgICBsZXQgcGF0aDogQy5QYXRoO1xyXG4gICAgbGV0IHBhcmFtczogT3B0aW9uPEMuUGFyYW1zPjtcclxuICAgIGxldCBoYXNoOiBPcHRpb248Qy5IYXNoPjtcclxuXHJcbiAgICBpZiAodmFsdWVbMF0gPT09ICdoZWxwZXInKSB7XHJcbiAgICAgIHBhdGggPSB2YWx1ZVsxXTtcclxuICAgICAgcGFyYW1zID0gdmFsdWVbMl07XHJcbiAgICAgIGhhc2ggPSB2YWx1ZVszXTtcclxuICAgIH0gZWxzZSBpZiAodmFsdWVbMF0gPT09ICd1bmtub3duJykge1xyXG4gICAgICBwYXRoID0gdmFsdWVbMV07XHJcbiAgICAgIHBhcmFtcyA9IGhhc2ggPSBudWxsO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAocGF0aC5sZW5ndGggPiAxICYmICFwYXJhbXMgJiYgIWhhc2gpIHtcclxuICAgICAgcmV0dXJuIFsnZXhwcicsIHZhbHVlXTtcclxuICAgIH1cclxuXHJcbiAgICBsZXQgbmFtZSA9IHBhdGhbMF07XHJcbiAgICBsZXQgaW5kZXggPSB0aGlzLm5hbWVzW25hbWVdO1xyXG5cclxuICAgIGlmIChpbmRleCA9PT0gdW5kZWZpbmVkICYmIHRoaXMubWlzc2luZykge1xyXG4gICAgICBsZXQgZnVuYyA9IHRoaXMubWlzc2luZztcclxuICAgICAgbGV0IHJldHVybmVkID0gZnVuYyhwYXRoLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xyXG4gICAgICByZXR1cm4gcmV0dXJuZWQgPT09IGZhbHNlID8gWydleHByJywgdmFsdWVdIDogcmV0dXJuZWQ7XHJcbiAgICB9IGVsc2UgaWYgKGluZGV4ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgbGV0IGZ1bmMgPSB0aGlzLmZ1bmNzW2luZGV4XTtcclxuICAgICAgbGV0IHJldHVybmVkID0gZnVuYyhwYXRoLCBwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xyXG4gICAgICByZXR1cm4gcmV0dXJuZWQgPT09IGZhbHNlID8gWydleHByJywgdmFsdWVdIDogcmV0dXJuZWQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gWydleHByJywgdmFsdWVdO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IElOTElORVMgPSBuZXcgSW5saW5lcygpO1xyXG5cclxucG9wdWxhdGVCdWlsdGlucyhCTE9DS1MsIElOTElORVMpO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBvcHVsYXRlQnVpbHRpbnMoYmxvY2tzOiBCbG9ja3MgPSBuZXcgQmxvY2tzKCksIGlubGluZXM6IElubGluZXMgPSBuZXcgSW5saW5lcygpKTogeyBibG9ja3M6IEJsb2NrcywgaW5saW5lczogSW5saW5lcyB9IHtcclxuICBibG9ja3MuYWRkKCdpZicsIChzZXhwOiBCYXNlbGluZVN5bnRheC5OZXN0ZWRCbG9jaywgYnVpbGRlcjogT3Bjb2RlQnVpbGRlcikgPT4ge1xyXG4gICAgLy8gICAgICAgIFB1dEFyZ3NcclxuICAgIC8vICAgICAgICBUZXN0KEVudmlyb25tZW50KVxyXG4gICAgLy8gICAgICAgIEVudGVyKEJFR0lOLCBFTkQpXHJcbiAgICAvLyBCRUdJTjogTm9vcFxyXG4gICAgLy8gICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcclxuICAgIC8vICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxyXG4gICAgLy8gICAgICAgIEp1bXAoRU5EKVxyXG4gICAgLy8gRUxTRTogIE5vb3BcclxuICAgIC8vICAgICAgICBFdmFsdWxhdGUoaW52ZXJzZSlcclxuICAgIC8vIEVORDogICBOb29wXHJcbiAgICAvLyAgICAgICAgRXhpdFxyXG5cclxuICAgIGxldCBbLCwgcGFyYW1zLCBoYXNoLCBfZGVmYXVsdCwgaW52ZXJzZV0gPSBzZXhwO1xyXG4gICAgbGV0IGFyZ3MgPSBjb21waWxlQXJncyhwYXJhbXMsIGhhc2gsIGJ1aWxkZXIpO1xyXG5cclxuICAgIGJ1aWxkZXIucHV0QXJncyhhcmdzKTtcclxuICAgIGJ1aWxkZXIudGVzdCgnZW52aXJvbm1lbnQnKTtcclxuXHJcbiAgICBidWlsZGVyLmxhYmVsbGVkKG51bGwsIGIgPT4ge1xyXG4gICAgICBpZiAoX2RlZmF1bHQgJiYgaW52ZXJzZSkge1xyXG4gICAgICAgIGIuanVtcFVubGVzcygnRUxTRScpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoX2RlZmF1bHQpO1xyXG4gICAgICAgIGIuanVtcCgnRU5EJyk7XHJcbiAgICAgICAgYi5sYWJlbCgnRUxTRScpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoaW52ZXJzZSk7XHJcbiAgICAgIH0gZWxzZSBpZiAoX2RlZmF1bHQpIHtcclxuICAgICAgICBiLmp1bXBVbmxlc3MoJ0VORCcpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoX2RlZmF1bHQpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IHVucmVhY2hhYmxlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBibG9ja3MuYWRkKCd1bmxlc3MnLCAoc2V4cDogQmFzZWxpbmVTeW50YXguTmVzdGVkQmxvY2ssIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICAgIC8vICAgICAgICBQdXRBcmdzXHJcbiAgICAvLyAgICAgICAgVGVzdChFbnZpcm9ubWVudClcclxuICAgIC8vICAgICAgICBFbnRlcihCRUdJTiwgRU5EKVxyXG4gICAgLy8gQkVHSU46IE5vb3BcclxuICAgIC8vICAgICAgICBKdW1wVW5sZXNzKEVMU0UpXHJcbiAgICAvLyAgICAgICAgRXZhbHVhdGUoZGVmYXVsdClcclxuICAgIC8vICAgICAgICBKdW1wKEVORClcclxuICAgIC8vIEVMU0U6ICBOb29wXHJcbiAgICAvLyAgICAgICAgRXZhbHVsYXRlKGludmVyc2UpXHJcbiAgICAvLyBFTkQ6ICAgTm9vcFxyXG4gICAgLy8gICAgICAgIEV4aXRcclxuXHJcbiAgICBsZXQgWywsIHBhcmFtcywgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdID0gc2V4cDtcclxuICAgIGxldCBhcmdzID0gY29tcGlsZUFyZ3MocGFyYW1zLCBoYXNoLCBidWlsZGVyKTtcclxuXHJcbiAgICBidWlsZGVyLnB1dEFyZ3MoYXJncyk7XHJcbiAgICBidWlsZGVyLnRlc3QoJ2Vudmlyb25tZW50Jyk7XHJcblxyXG4gICAgYnVpbGRlci5sYWJlbGxlZChudWxsLCBiID0+IHtcclxuICAgICAgaWYgKF9kZWZhdWx0ICYmIGludmVyc2UpIHtcclxuICAgICAgICBiLmp1bXBJZignRUxTRScpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoX2RlZmF1bHQpO1xyXG4gICAgICAgIGIuanVtcCgnRU5EJyk7XHJcbiAgICAgICAgYi5sYWJlbCgnRUxTRScpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoIGludmVyc2UpO1xyXG4gICAgICB9IGVsc2UgaWYgKF9kZWZhdWx0KSB7XHJcbiAgICAgICAgYi5qdW1wSWYoJ0VORCcpO1xyXG4gICAgICAgIGIuZXZhbHVhdGUoX2RlZmF1bHQpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRocm93IHVucmVhY2hhYmxlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBibG9ja3MuYWRkKCd3aXRoJywgKHNleHA6IEJhc2VsaW5lU3ludGF4Lk5lc3RlZEJsb2NrLCBidWlsZGVyOiBPcGNvZGVCdWlsZGVyKSA9PiB7XHJcbiAgICAvLyAgICAgICAgUHV0QXJnc1xyXG4gICAgLy8gICAgICAgIFRlc3QoRW52aXJvbm1lbnQpXHJcbiAgICAvLyAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcclxuICAgIC8vIEJFR0lOOiBOb29wXHJcbiAgICAvLyAgICAgICAgSnVtcFVubGVzcyhFTFNFKVxyXG4gICAgLy8gICAgICAgIEV2YWx1YXRlKGRlZmF1bHQpXHJcbiAgICAvLyAgICAgICAgSnVtcChFTkQpXHJcbiAgICAvLyBFTFNFOiAgTm9vcFxyXG4gICAgLy8gICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxyXG4gICAgLy8gRU5EOiAgIE5vb3BcclxuICAgIC8vICAgICAgICBFeGl0XHJcblxyXG4gICAgbGV0IFssLCBwYXJhbXMsIGhhc2gsIF9kZWZhdWx0LCBpbnZlcnNlXSA9IHNleHA7XHJcbiAgICBsZXQgYXJncyA9IGNvbXBpbGVBcmdzKHBhcmFtcywgaGFzaCwgYnVpbGRlcik7XHJcblxyXG4gICAgYnVpbGRlci5wdXRBcmdzKGFyZ3MpO1xyXG4gICAgYnVpbGRlci50ZXN0KCdlbnZpcm9ubWVudCcpO1xyXG5cclxuICAgIGJ1aWxkZXIubGFiZWxsZWQobnVsbCwgYiA9PiB7XHJcbiAgICAgIGlmIChfZGVmYXVsdCAmJiBpbnZlcnNlKSB7XHJcbiAgICAgICAgYi5qdW1wVW5sZXNzKCdFTFNFJyk7XHJcbiAgICAgICAgYi5ldmFsdWF0ZShfZGVmYXVsdCk7XHJcbiAgICAgICAgYi5qdW1wKCdFTkQnKTtcclxuICAgICAgICBiLmxhYmVsKCdFTFNFJyk7XHJcbiAgICAgICAgYi5ldmFsdWF0ZShpbnZlcnNlKTtcclxuICAgICAgfSBlbHNlIGlmIChfZGVmYXVsdCkge1xyXG4gICAgICAgIGIuanVtcFVubGVzcygnRU5EJyk7XHJcbiAgICAgICAgYi5ldmFsdWF0ZShfZGVmYXVsdCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhyb3cgdW5yZWFjaGFibGUoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGJsb2Nrcy5hZGQoJ2VhY2gnLCAoc2V4cDogQmFzZWxpbmVTeW50YXguTmVzdGVkQmxvY2ssIGJ1aWxkZXI6IE9wY29kZUJ1aWxkZXIpID0+IHtcclxuICAgIC8vICAgICAgICAgRW50ZXIoQkVHSU4sIEVORClcclxuICAgIC8vIEJFR0lOOiAgTm9vcFxyXG4gICAgLy8gICAgICAgICBQdXRBcmdzXHJcbiAgICAvLyAgICAgICAgIFB1dEl0ZXJhYmxlXHJcbiAgICAvLyAgICAgICAgIEp1bXBVbmxlc3MoRUxTRSlcclxuICAgIC8vICAgICAgICAgRW50ZXJMaXN0KEJFR0lOMiwgRU5EMilcclxuICAgIC8vIElURVI6ICAgTm9vcFxyXG4gICAgLy8gICAgICAgICBOZXh0SXRlcihCUkVBSylcclxuICAgIC8vICAgICAgICAgRW50ZXJXaXRoS2V5KEJFR0lOMiwgRU5EMilcclxuICAgIC8vIEJFR0lOMjogTm9vcFxyXG4gICAgLy8gICAgICAgICBQdXNoQ2hpbGRTY29wZVxyXG4gICAgLy8gICAgICAgICBFdmFsdWF0ZShkZWZhdWx0KVxyXG4gICAgLy8gICAgICAgICBQb3BTY29wZVxyXG4gICAgLy8gRU5EMjogICBOb29wXHJcbiAgICAvLyAgICAgICAgIEV4aXRcclxuICAgIC8vICAgICAgICAgSnVtcChJVEVSKVxyXG4gICAgLy8gQlJFQUs6ICBOb29wXHJcbiAgICAvLyAgICAgICAgIEV4aXRMaXN0XHJcbiAgICAvLyAgICAgICAgIEp1bXAoRU5EKVxyXG4gICAgLy8gRUxTRTogICBOb29wXHJcbiAgICAvLyAgICAgICAgIEV2YWx1bGF0ZShpbnZlcnNlKVxyXG4gICAgLy8gRU5EOiAgICBOb29wXHJcbiAgICAvLyAgICAgICAgIEV4aXRcclxuXHJcbiAgICBsZXQgWywsIHBhcmFtcywgaGFzaCwgX2RlZmF1bHQsIGludmVyc2VdID0gc2V4cDtcclxuICAgIGxldCBhcmdzID0gY29tcGlsZUFyZ3MocGFyYW1zLCBoYXNoLCBidWlsZGVyKTtcclxuXHJcbiAgICBidWlsZGVyLmxhYmVsbGVkKGFyZ3MsIGIgPT4ge1xyXG4gICAgICBiLnB1dEl0ZXJhdG9yKCk7XHJcblxyXG4gICAgICBpZiAoaW52ZXJzZSkge1xyXG4gICAgICAgIGIuanVtcFVubGVzcygnRUxTRScpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGIuanVtcFVubGVzcygnRU5EJyk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGIuaXRlcihiID0+IHtcclxuICAgICAgICBiLmV2YWx1YXRlKHVud3JhcChfZGVmYXVsdCkpO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGlmIChpbnZlcnNlKSB7XHJcbiAgICAgICAgYi5qdW1wKCdFTkQnKTtcclxuICAgICAgICBiLmxhYmVsKCdFTFNFJyk7XHJcbiAgICAgICAgYi5ldmFsdWF0ZShpbnZlcnNlKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIHJldHVybiB7IGJsb2NrcywgaW5saW5lcyB9O1xyXG59XHJcbiJdfQ==