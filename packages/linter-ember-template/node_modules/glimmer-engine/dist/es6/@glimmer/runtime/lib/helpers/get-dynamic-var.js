import { CONSTANT_TAG, UpdatableTag, combine } from '@glimmer/reference';
class DynamicVarReference {
    constructor(scope, nameRef) {
        this.scope = scope;
        this.nameRef = nameRef;
        let varTag = this.varTag = new UpdatableTag(CONSTANT_TAG);
        this.tag = combine([nameRef.tag, varTag]);
    }
    value() {
        return this.getVar().value();
    }
    get(key) {
        return this.getVar().get(key);
    }
    getVar() {
        let name = String(this.nameRef.value());
        let ref = this.scope.get(name);
        this.varTag.update(ref.tag);
        return ref;
    }
}
function getDynamicVar(vm, args, _symbolTable) {
    let scope = vm.dynamicScope();
    let nameRef = args.positional.at(0);
    return new DynamicVarReference(scope, nameRef);
}
export default getDynamicVar;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2V0LWR5bmFtaWMtdmFyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiQGdsaW1tZXIvcnVudGltZS9saWIvaGVscGVycy9nZXQtZHluYW1pYy12YXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUEsT0FBTyxFQUFFLFlBQVksRUFBOEIsWUFBWSxFQUFFLE9BQU8sRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBR3JHO0lBSUUsWUFBb0IsS0FBbUIsRUFBVSxPQUE4QjtRQUEzRCxVQUFLLEdBQUwsS0FBSyxDQUFjO1FBQVUsWUFBTyxHQUFQLE9BQU8sQ0FBdUI7UUFDN0UsSUFBSSxNQUFNLEdBQUcsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLFlBQVksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMxRCxJQUFJLENBQUMsR0FBRyxHQUFHLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQztJQUM1QyxDQUFDO0lBRUQsS0FBSztRQUNILE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDL0IsQ0FBQztJQUVELEdBQUcsQ0FBQyxHQUFXO1FBQ2IsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVPLE1BQU07UUFDWixJQUFJLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBQ3hDLElBQUksR0FBRyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBRS9CLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUU1QixNQUFNLENBQUMsR0FBRyxDQUFDO0lBQ2IsQ0FBQztDQUNGO0FBRUQsdUJBQXVCLEVBQVksRUFBRSxJQUFtQixFQUFFLFlBQXlCO0lBQ2pGLElBQUksS0FBSyxHQUFHLEVBQUUsQ0FBQyxZQUFZLEVBQUUsQ0FBQztJQUM5QixJQUFJLE9BQU8sR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVwQyxNQUFNLENBQUMsSUFBSSxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVELGVBQWdCLGFBQXdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIZWxwZXIsIER5bmFtaWNTY29wZSB9IGZyb20gJy4uL2Vudmlyb25tZW50JztcbmltcG9ydCB7IFB1YmxpY1ZNIH0gZnJvbSAnLi4vdm0vYXBwZW5kJztcbmltcG9ydCB7IFN5bWJvbFRhYmxlIH0gZnJvbSAnQGdsaW1tZXIvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBFdmFsdWF0ZWRBcmdzIH0gZnJvbSAnLi4vY29tcGlsZWQvZXhwcmVzc2lvbnMvYXJncyc7XG5pbXBvcnQgeyBDT05TVEFOVF9UQUcsIFJldmlzaW9uVGFnLCBQYXRoUmVmZXJlbmNlLCBVcGRhdGFibGVUYWcsIGNvbWJpbmUgfSBmcm9tICdAZ2xpbW1lci9yZWZlcmVuY2UnO1xuaW1wb3J0IHsgT3BhcXVlIH0gZnJvbSAnQGdsaW1tZXIvdXRpbCc7XG5cbmNsYXNzIER5bmFtaWNWYXJSZWZlcmVuY2UgaW1wbGVtZW50cyBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICBwdWJsaWMgdGFnOiBSZXZpc2lvblRhZztcbiAgcHJpdmF0ZSB2YXJUYWc6IFVwZGF0YWJsZVRhZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNjb3BlOiBEeW5hbWljU2NvcGUsIHByaXZhdGUgbmFtZVJlZjogUGF0aFJlZmVyZW5jZTxPcGFxdWU+KSB7XG4gICAgbGV0IHZhclRhZyA9IHRoaXMudmFyVGFnID0gbmV3IFVwZGF0YWJsZVRhZyhDT05TVEFOVF9UQUcpO1xuICAgIHRoaXMudGFnID0gY29tYmluZShbbmFtZVJlZi50YWcsIHZhclRhZ10pO1xuICB9XG5cbiAgdmFsdWUoKTogT3BhcXVlIHtcbiAgICByZXR1cm4gdGhpcy5nZXRWYXIoKS52YWx1ZSgpO1xuICB9XG5cbiAgZ2V0KGtleTogc3RyaW5nKTogUGF0aFJlZmVyZW5jZTxPcGFxdWU+IHtcbiAgICByZXR1cm4gdGhpcy5nZXRWYXIoKS5nZXQoa2V5KTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0VmFyKCk6IFBhdGhSZWZlcmVuY2U8T3BhcXVlPiB7XG4gICAgbGV0IG5hbWUgPSBTdHJpbmcodGhpcy5uYW1lUmVmLnZhbHVlKCkpO1xuICAgIGxldCByZWYgPSB0aGlzLnNjb3BlLmdldChuYW1lKTtcblxuICAgIHRoaXMudmFyVGFnLnVwZGF0ZShyZWYudGFnKTtcblxuICAgIHJldHVybiByZWY7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RHluYW1pY1Zhcih2bTogUHVibGljVk0sIGFyZ3M6IEV2YWx1YXRlZEFyZ3MsIF9zeW1ib2xUYWJsZTogU3ltYm9sVGFibGUpOiBQYXRoUmVmZXJlbmNlPE9wYXF1ZT4ge1xuICBsZXQgc2NvcGUgPSB2bS5keW5hbWljU2NvcGUoKTtcbiAgbGV0IG5hbWVSZWYgPSBhcmdzLnBvc2l0aW9uYWwuYXQoMCk7XG5cbiAgcmV0dXJuIG5ldyBEeW5hbWljVmFyUmVmZXJlbmNlKHNjb3BlLCBuYW1lUmVmKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgKGdldER5bmFtaWNWYXIgYXMgSGVscGVyKTtcbiJdfQ==